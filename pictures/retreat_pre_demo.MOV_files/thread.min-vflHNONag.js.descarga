define(["require","exports","tslib","react","classnames","spectrum/checkbox","spectrum/tertiary_link","spectrum_comments/comment","spectrum_comments/thread/thread_editor"],function(e,t,n,r,o,s,i,a,c){"use strict";function d(e){var t=e.count,n=t>1?t+" comments":t+" comment";return r.createElement("div",{className:"sc-thread-comment-number"},n)}function m(e,t){return{onDeleted:function(){return t.onCommentDeleted(e.id)},onEdited:function(n){return t.onCommentEdited(e.id,n)},onMentionsQueryUpdated:t.onMentionsQueryUpdated}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){},u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isEditorEmpty:!0},t.onEditorCancel=function(){t.props.onEndEdit()},t.onEditorContentChange=function(e){t.setState({isEditorEmpty:e.isEmpty})},t.onEditorPost=t.props.actions.onReply,t.onMentionsQueryUpdated=t.props.actions.onMentionsQueryUpdated,t}return n.__extends(t,e),Object.defineProperty(t.prototype,"active",{get:function(){return this.props.active||!this.state.isEditorEmpty},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){var e=this.props,t=e.className,n=void 0===t?"":t,r=e.thread;return o(n,{"sc-thread":!0,"sc-thread-active":this.active===!0,"sc-thread-read":r.read,"sc-thread-unread":!r.read,"sc-thread-resolved":r.resolved,"sc-thread-unresolved":!r.resolved})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filteredReplies",{get:function(){var e=this.props.thread.comments;e[0];return e.slice(1).filter(function(e){return!e.deleted})},enumerable:!0,configurable:!0}),t.prototype.renderComment=function(e,t,n,o){void 0===n&&(n=a.Comment);var s=this.props,i=s.actions,c=s.editedComment,d=s.mentionsMatches,l=(s.onStartEdit,s.onEndEdit,!!c&&e.id===c.id);return r.createElement(n,{actions:m(e,i),active:t,annotation:o,comment:e,key:e.id,isEditing:l,onStartEdit:this.props.onStartEdit,onEndEdit:this.props.onEndEdit,mentionsMatches:d})},t.prototype.renderResolveControl=function(){var e=this.props,t=e.actions,n=e.thread,o=n.resolved?"Resolved":"Resolve",i=n.resolved?r.createElement(s.Checkbox,{checked:"checked",onChange:function(){return t.onUnresolve()}}):r.createElement(s.Checkbox,{checked:"unchecked",onChange:function(){return t.onResolve()}});return r.createElement("label",{className:"sc-thread-controls-resolve"},i,o)},t.prototype.renderReadToggle=function(){var e=this.props,t=e.actions,n=e.thread,o=n.read?t.onMarkAsUnread:t.onMarkAsRead,s=n.read?"Mark as unread":"Mark as read";return r.createElement(i.TertiaryLink,{className:"sc-thread-read-toggle",onClick:o},s)},t.prototype.renderActive=function(){var e=this,t=this.props,n=(t.actions,t.commentComponent),o=t.mentionsMatches,s=t.thread,i=t.user,d=this.filteredReplies;return r.createElement("li",{className:this.className},r.createElement("div",{className:"sc-thread-controls"},this.renderResolveControl(),this.renderReadToggle()),r.createElement("ul",{className:"sc-thread-comments"},this.renderComment(s.comments[0],this.active,n,s.annotation),d.map(function(t){return e.renderComment(t,!0,a.Comment)})),r.createElement(c.ThreadEditor,{author:i,mentionsMatches:o,onCancel:this.onEditorCancel,onContentChange:this.onEditorContentChange,onMentionsQueryUpdated:this.onMentionsQueryUpdated,onPost:this.onEditorPost}))},t.prototype.renderInactive=function(){var e=this.props,t=e.active,n=e.commentComponent,o=void 0===n?a.Comment:n,s=e.mentionsMatches,i=e.onActivated,c=e.thread,m=this.filteredReplies;return r.createElement("li",{className:this.className,tabIndex:0,onClick:i},r.createElement("ul",{className:"sc-thread-comments"},this.renderComment(c.comments[0],t,o,c.annotation),m.length>1&&r.createElement(d,{count:m.length-1}),m.length>0&&r.createElement(a.Comment,{active:!1,comment:m[m.length-1],actions:{onDeleted:l,onEdited:l,onMentionsQueryUpdated:l},mentionsMatches:s,onEndEdit:l,onStartEdit:l,isEditing:!1})))},t.prototype.render=function(){return this.props.thread.comments.every(function(e){return!!e.deleted})?null:this.active?this.renderActive():this.renderInactive()},t})(r.PureComponent);t.Thread=u});
//# sourceMappingURL=thread.min.js-vflS1k9M9.map