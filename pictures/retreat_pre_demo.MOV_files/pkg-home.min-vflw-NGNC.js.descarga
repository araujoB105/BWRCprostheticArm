define("modules/clean/react/home/actions",["require","exports","tslib","modules/constants/env","modules/core/browser","modules/core/uri","modules/core/i18n","modules/core/notify","modules/clean/flux/dispatcher","modules/clean/react/home/post_tti/api","modules/clean/react/home/constants","modules/clean/react/home/constants"],function(e,t,n,r,o,i,a,c,s,l,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(){function e(){}return e.setSectionVisibility=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var o,i,u,m;return n.__generator(this,function(n){switch(n.label){case 0:return o=t[".tag"],s.Dispatcher.dispatch({type:d.HomeActionTypes.SET_SECTION_VISIBILITY,payload:{section:o,visible:r}}),[4,l.waitForHomeTTI()];case 1:i=n.sent().setSectionVisibility,n.label=2;case 2:return n.trys.push([2,4,,5]),[4,i(e,t,r)];case 3:return n.sent(),[3,5];case 4:throw u=n.sent(),m=r?a._("Unable to show section."):a._("Unable to hide section."),c.Notify.error(m),s.Dispatcher.dispatch({type:d.HomeActionTypes.SET_SECTION_VISIBILITY,payload:{section:o,visible:!r}}),u;case 5:return[2]}})})},e.createPaperDocInNewTab=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,s,d,u,m,h;return n.__generator(this,function(n){switch(n.label){case 0:t=a._("Could not create paper document."),s=window.open("about:blank"),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,l.waitForHomeTTI()];case 2:return d=n.sent().createPaperDoc,[4,d(e)];case 3:return u=n.sent(),s&&!s.closed?(m=new i.URI({scheme:"https",authority:r.NOTES_WEBSERVER,path:"/doc/"+u.doc_id}).toString(),o.redirect(m,s)):c.Notify.error(t),[3,5];case 4:return h=n.sent(),c.Notify.error(t),s&&!s.closed?[2,s.close()]:[3,5];case 5:return[2]}})})},e.createPaperDocFromTemplateInNewTab=function(e){void 0===e&&(e="");var t=window.open("about:blank"),n="";switch(e){case u.PaperTemplateTypes.BRAINSTORM:n="/pad/open-or-create-sample/brainstorm-template";break;case u.PaperTemplateTypes.MEETING_NOTES:n="/pad/open-or-create-sample/meeting-notes-template";break;case u.PaperTemplateTypes.PROJECT_PLAN:n="/pad/open-or-create-sample/project-plan";break;default:return c.Notify.error(a._("Invalid document type")),void(t&&!t.closed&&t.close())}var s=new i.URI({scheme:"https",authority:r.NOTES_WEBSERVER,path:n}).toString();t?o.redirect(s,t):c.Notify.error(a._("Could not create paper document."))},e})();t.HomeActions=m}),define("modules/clean/react/home/api",["require","exports","tslib","modules/clean/ajax","external/lodash","modules/core/exception","modules/clean/web_timing_logger","modules/core/browser"],function(e,t,n,r,o,i,a,c){"use strict";function s(e){return n.__awaiter(this,void 0,void 0,function(){var r,o;return n.__generator(this,function(n){switch(n.label){case 0:return r=m,m=t.now(),e||m-r<40?(u++,o=~~(90*Math.random())+10,[4,new Promise(function(e){return setTimeout(e,o)})]):[3,2];case 1:return n.sent(),u--,[2,o];case 2:return[2,0]}})})}var l=this;Object.defineProperty(t,"__esModule",{value:!0});t.now=function(){return Date.now()};var d=0,u=0,m=t.now();t.makeRequest=function(e,o){var a=void 0===o?{}:o,c=a.delayRequest,m=a.isBackground;a.shouldAssertResponse;d++;var h=new Promise(function(o,a){return n.__awaiter(l,void 0,void 0,function(){var l,h,p;return n.__generator(this,function(_){switch(_.label){case 0:return[4,s(c)];case 1:return l=_.sent(),h=t.now(),p=m?r.SilentBackgroundRequest:r.WebRequest,p(n.__assign({dataType:"json",success:o,error:function(n,r,o){if("abort"!==r){var s=e&&e.url||"no url",p=o?": '"+o+"'":"",_="makeRequest to '"+s+"' failed - "+r+p;i.reportStack(_,{severity:i.SEVERITY.NONCRITICAL,exc_extra:{errorThrown:o,textStatus:r,requestParams:e,delayRequest:c,isBackground:m,requestDelay:l,openRequests:d,delayedRequests:u,requestDuration:t.now()-h,status:n.status,"exclog.exc_group":"homeapi:"+r+":"+o+":"+s}}),a(Error(o+" ("+s+")"))}}},e)),[2]}})})});return h.finally(function(){return d--}),h};var h={},p=o.throttle(function(){o.size(h)>1&&i.reportStack("Multiple role activities",{severity:i.SEVERITY.NONCRITICAL,exc_extra:h}),Object.keys(h).forEach(function(e){var n=h[e];t.makeRequest({url:"/home_feed/log_activities",type:"POST",data:{role:e,activities_json:JSON.stringify(o.map(n,"json")),send_ts:t.now(),page_start_ts:window.performance&&window.performance.timing?window.performance.timing.navigationStart||window.performance.timing.fetchStart:void 0}},{isBackground:!0,delayRequest:!0,shouldAssertResponse:!0}).then(function(){return n.forEach(function(e){return e.resolve()})},function(){return n.forEach(function(e){return e.reject()})})}),h={}},1e3,{leading:!0,trailing:!0});t.logHomeActivity=function(e){var r=e.role,i=e.eventName,c=e.extra;return new Promise(function(e,s){return n.__awaiter(l,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return h[r]=h[r]||[],h[r].push({json:{event_name:i,event_time:t.now(),extra:o.mapValues(c||{},function(e){return String(e)})},resolve:e,reject:s}),[4,a.waitForTTI()];case 1:return n.sent(),p(),[2]}})})})}}),define("modules/clean/react/home/banner/constants",["require","exports","modules/core/i18n"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HOME_ACCESS_BANNER_ON_VARIANTS=["ON"],t.HOME_ACCESS_BANNER_TEXT={ON:{title:n._("Create and edit docs without leaving Dropbox"),subtitle:n._("Capture ideas, ask for feedback, and link to shared files."),buttonText:n._("Create Paper doc")}}}),define("modules/clean/react/home/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.DO_NOT_LOAD=1]="DO_NOT_LOAD",e[e.IMMEDIATE=2]="IMMEDIATE",e[e.POST_TTI=3]="POST_TTI"})(t.ConditionalSectionLoadingPreference||(t.ConditionalSectionLoadingPreference={}));(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SYNCHRONOUS=1]="SYNCHRONOUS",e[e.ASYNCHRONOUS_PRE_TTI=2]="ASYNCHRONOUS_PRE_TTI",e[e.POST_TTI=3]="POST_TTI"})(t.ConditionalSectionLoadingMode||(t.ConditionalSectionLoadingMode={})),t.HomeActionTypes={INITIALIZE_STORE:"HOME_INITIALIZE_STORE",SET_PRE_TTI_PROPS:"HOME_SET_PRE_TTI_PROPS",SET_SECTION_VISIBILITY:"HOME_SET_SECTION_VISIBILITY",LOADED_ASYNC_CONDITIONAL_SECTION:"HOME_STORE_LOADED_ASYNC_CONDITIONAL_SECTION",DECLARE_CONDITIONAL_SECTION:"HOME_STORE_DECLARE_CONDITIONAL_SECTION"},t.HomeResourceStoreActionTypes={RECEIVED_RESOURCE_ID_TO_FILE:"HOME_RESOURCE_STORE_RECEIVED_RESOURCE_ID_TO_FILE",REQUEST_PREVIEW:"HOME_RESOURCE_STORE_REQUEST_PREVIEW"},t.HomeSections={MAIN:"main",UNREAD:"unread",STARRED:"starred",RECENTS:"recents",SUGGEST:"suggest"},t.DEFAULT_PRE_TTI_PROPS={isPaperEnabledForUser:!1,paperLinksVariant:"OFF",uploaderExperiments:{},showDismissSuggestModal:!1,enableHideSuggestSection:!1,showParentFolder:!1,activeVariants:{},shouldMarkRecentsTtiIfOffScreen:!1},t.ConditionalSections={PAPER_RECENTS:"paper_recents"},t.LoggingTypes={CLICK_SHOW_ALL:"click_show_all",HOME_PAGE_SHOWN:"home_page_shown",UNREAD_SHOWN:"unread_shown",STARRED_SHOWN:"starred_shown",RECENTS_SHOWN:"recents_shown",HIDE_SECTION:"hide_section",UNHIDE_SECTION:"unhide_section",RECENTS_ITEM_ACTION:"recents_item_action",OPEN_UNREAD_ITEM:"open_unread_document",MARK_AS_READ:"mark_as_read",OPEN_STARRED_ITEM:"open_starred_item",UNSTAR_ITEM:"unstar_item",UNDO_UNSTAR_ITEM:"undo_unstar_item",CLICK_STAR_OVERFLOW_MENU:"click_star_overflow_menu",CLICK_STAR_OVERFLOW_SHARE:"click_star_overflow_share",CLICK_STAR_OVERFLOW_UPLOAD:"click_star_overflow_upload",CLICK_INCOMING_ACTION:"click_incoming_action",CLICK_RIGHT_NAV_ITEM:"click_right_nav_item",CLICK_INCOMING_SHOW_READ:"click_incoming_show_read",CLICK_RECENT_ITEMS:"click_recent_item",OPEN_INCOMING:"open_incoming",OPEN_INCOMING_DOCUMENT:"open_incoming_document",OPEN_STARRED_DOCUMENT:"open_starred_item",OPEN_DOCUMENT:"open_document",CLICK_UPLOAD_FILES:"upload_files",CLICK_CREATE_PAPER_DOC:"create_paper_doc",CLICK_CREATE_BRAINSTORM_DOC:"create_brainstorm_doc",CLICK_CREATE_MEETING_NOTES_DOC:"create_meeting_notes_doc",CLICK_CREATE_PROJECT_PLAN_DOC:"create_project_plan_doc",CLICK_NEW_SHARED_FOLDER:"new_shared_folder",VIEW_UPLOADED_FILES:"view_uploaded_files"},t.HomePrefetchTypes={RETRIEVE_STARRED:"retrieve_starred",RECENTS_JSON:"recents_json",RETRIEVE_PAPER_RECENTS:"retrieve_paper_recents",RETRIEVE_UNREAD:"retrieve_unread",PRE_TTI_PROPS:"pre_tti_props",GET_SUGGESTED:"get_suggested"},t.LoadingStates={LOADING:"LOADING",SUCCESS:"SUCCESS",FAILURE:"FAILURE"},t.FILE_RESOURCE_TYPE="FILE",t.FOLDER_RESOURCE_TYPE="FOLDER",t.PAPER_DOCUMENT_RESOURCE_TYPE="PAPER_DOCUMENT",t.PAPER_FOLDER_RESOURCE_TYPE="PAPER_FOLDER",t.EXTERNAL_RESOURCE_TYPE="EXTERNAL",t.DisplayTypeToResourceType={DOC:t.FILE_RESOURCE_TYPE,MSDOC:t.FILE_RESOURCE_TYPE,PDF:t.FILE_RESOURCE_TYPE,SPREADSHEET:t.FILE_RESOURCE_TYPE,FILE:t.FILE_RESOURCE_TYPE,FOLDER:t.FOLDER_RESOURCE_TYPE,SHARED_FOLDER:t.FOLDER_RESOURCE_TYPE,TEAM_FOLDER:t.FOLDER_RESOURCE_TYPE,PAPER_DOCUMENT:t.PAPER_DOCUMENT_RESOURCE_TYPE,PAPER_FOLDER:t.PAPER_FOLDER_RESOURCE_TYPE,PAPER_PUBLIC_FOLDER:t.PAPER_FOLDER_RESOURCE_TYPE,PAPER_PROJECT:t.PAPER_FOLDER_RESOURCE_TYPE,EXTERNAL:t.EXTERNAL_RESOURCE_TYPE},t.ExceptionTags={UNREAD:"home_unread"},t.DisplayTypes={AGGREGATION:"AGGREGATION",DOC:"DOC",MSDOC:"DOC",PDF:"PDF",SPREADSHEET:"SPREADSHEET",FILE:"FILE",FOLDER:"FOLDER",SHARED_FOLDER:"SHARED_FOLDER",TEAM_FOLDER:"TEAM_FOLDER",PAPER_DOCUMENT:"PAPER_DOCUMENT",PAPER_FOLDER:"PAPER_FOLDER",PAPER_PUBLIC_FOLDER:"PAPER_PUBLIC_FOLDER",PAPER_PROJECT:"PAPER_PROJECT"},t.DisplayTypeToIconName={AGGREGATION:"image",FOLDER:"folder",SHARED_FOLDER:"folder_shared",TEAM_FOLDER:"folder_team",CDM_TEAM_MEMBER_FOLDER:"folder_team_member",PAPER_DOCUMENT:"paper",PAPER_FOLDER:"folder",PAPER_PUBLIC_FOLDER:"folder_team",PAPER_PROJECT:"folder_project"},t.PaperTemplateTypes={PROJECT_PLAN:"project_plan",MEETING_NOTES:"meeting_notes",BRAINSTORM:"brainstorm"},t.PaperSidebarLinkVariants={OFF:"OFF",CONTROL:"CONTROL",V0:"V0",V1:"V1",V2:"V2"}}),define("modules/clean/react/home/post_tti/api",["require","exports","tslib","external/react","modules/clean/web_timing_logger","modules/clean/react/async/loadable"],function(e,t,n,r,o,i){"use strict";function a(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,o.waitForTTI()];case 1:return t.sent(),[4,new Promise(function(t,n){e(["modules/clean/react/home/post_tti/interface"],t,n)})];case 2:return[2,t.sent()]}})})}function c(e){var t=this,r=e.getPostTTIRenderer,o=e.preTTIRenderer;return i.Loadable({loader:function(){return n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return e=r,[4,a()];case 1:return[2,e.apply(void 0,[t.sent()])]}})})},loading:o})}function s(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,a()];case 1:return e=n.sent(),t={imports:e},[4,e.getPostTTIProps()];case 2:return[2,(t.props=n.sent(),t)]}})})}function l(e){var t=this,o=e.getPostTTIRenderer,a=e.preTTIRenderer;return i.Loadable({loader:function(){return n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,s()];case 1:return e=t.sent(),[4,o(e)];case 2:return[2,t.sent()||function(){return r.createElement(d,null)}]}})})},loading:a})}Object.defineProperty(t,"__esModule",{value:!0}),t.waitForHomeTTI=a,t.PostHomeTTIComponent=c,t.waitForHomeTTIWithProps=s;var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return null},t})(r.PureComponent);t.PostHomeTTIComponentWithProps=l}),define("modules/clean/react/home/recents/actions/error_actions",["require","exports","external/lodash","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_dispatcher","modules/core/exception","modules/core/i18n","modules/core/notify"],function(e,t,n,r,o,i,a,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){var t=this;this._flushQueues=function(){t._rafId=null;var e=t._recentActivityQueue;t._recentActivityQueue=[],e.length&&t._dispatcher.dispatch({type:r.RAW_RECENT_ACTIVITY_PARSE_ERROR,errors:e});var n=t._relatedActivityQueue;t._relatedActivityQueue=[],n.length&&t._dispatcher.dispatch({type:r.RAW_RELATED_ACTIVITY_PARSE_ERROR,errors:n})},this._notify=n.throttle(function(){var e=a._("Sorry, we were unable to show some recent items. The team has been notified");c.Notify.error(e)},500,{trailing:!1}),this._dispatcher=e,this._recentActivityQueue=[],this._relatedActivityQueue=[],this._rafId=null}return e.prototype.recentActivityParseError=function(e,t){i.reportException({err:t}),this._notify(),this._enqueueError(this._recentActivityQueue,e,t)},e.prototype.relatedActivityParseError=function(e,t){i.reportException({err:t}),this._notify(),this._enqueueError(this._relatedActivityQueue,e,t)},e.prototype._enqueueError=function(e,t,n){e.push({activityKey:t,error:n}),this._rafId||(this._rafId=window.requestAnimationFrame(this._flushQueues))},e})();t.ErrorActions=s,t.errorActions=new s(o.recentActivityDispatcher)}),define("modules/clean/react/home/recents/actions/federated_recent_activity_actions",["require","exports","tslib","modules/core/i18n","modules/core/browser","modules/clean/react/modal","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/recent_activity_federated_model","modules/clean/react/home/recents/stores/recent_activity_store","modules/core/exception","modules/core/notify","modules/clean/react/home/recents/utils/events","modules/clean/react/home/post_tti/api"],function(e,t,n,r,o,i,a,c,s,l,d,u,m,h){"use strict";function p(e,t,n){e?o.open_tab(e):d.reportStack("Cannot open tab to preform the action "+t,{severity:d.SEVERITY.NONCRITICAL,exc_extra:{paperRecentItem:n.paperRecentItem}})}function _(e,t,n){m.logEvent(e,n.cellView,[t.getFqPath()],1,1)}function E(e,t){_(a.ActionType.PAPER_SHARE,e,t),p(s.getPaperShareUrl(e),a.ActionType.PAPER_SHARE,e)}function T(e,t){_(a.ActionType.PAPER_OPEN,e,t),p(e.getUrl(),a.ActionType.PAPER_OPEN,e)}function f(e,t){c.recentActivityDispatcher.dispatch({type:e,activityKey:t})}function I(e,t,o){var c=this,d=e.getActivityKey();if(l.getRecentActivityStore().canArchiveActivityKey(d)){var m=e.getActivityKey();i.SimpleModal.show({title_text:r._("Archive document?"),body_html:r._("Do you want to archive this document?"),confirm_text:r._("Archive"),cancel_text:r._("Cancel"),autoclose:!0,confirm_callback:function(){return n.__awaiter(c,void 0,void 0,function(){var i,c;return n.__generator(this,function(n){switch(n.label){case 0:_(a.ActionType.PAPER_ARCHIVE,e,o),f(a.ARCHIVE_PAPER_DOCUMENT_PENDING,m),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,h.waitForHomeTTI()];case 2:return[4,n.sent().archivePaperResources(t,[e.paperRecentItem])];case 3:return i=n.sent(),i.some(function(t){return s.equalsPaperRecentItem(e,t)})?(f(a.ARCHIVE_PAPER_DOCUMENT_COMMIT,m),u.Notify.success(r._("The document was archived."))):f(a.ARCHIVE_PAPER_DOCUMENT_ROLLBACK,m),[3,5];case 4:return c=n.sent(),f(a.ARCHIVE_PAPER_DOCUMENT_ROLLBACK,m),[3,5];case 5:return[2]}})})}})}}Object.defineProperty(t,"__esModule",{value:!0}),t.shareItem=E,t.previewItem=T,t.promptAndArchiveItem=I}),define("modules/clean/react/home/recents/actions/recent_activity_action_permissions",["require","exports","modules/clean/react/home/recents/models/utils"],function(e,t,n){"use strict";function r(e,t){return n.isShareLinkRecentItem(e)?o(!!t.canOpen):{open:!!t.canOpen,delete:!t.isReadOnly,download:!0,comment:!t.isDir,versions:!t.isDir,archive:!1,share:!1}}function o(e){return{archive:!1,comment:!1,delete:!1,download:!1,open:e,share:!1,versions:!1}}function i(e,t){if(e.federatedRecentItem)return{archive:e.federatedRecentItem.isArchiveable(),comment:!1,delete:!1,download:!1,open:!1,share:e.federatedRecentItem.isShareable(),versions:!1};var r=t[0],i=1===t.length;if(n.isShareLinkRecentItem(e))return o(!(!i||!r.canOpen));var a=i&&!r.isDir;return{archive:!1,comment:a,delete:t.every(function(e){return!e.isReadOnly}),download:i,open:!(!i||!r.canOpen),share:i,versions:a}}function a(e){for(var t in e)if("share"!==t&&e[t])return!0;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.getDocAttachmentViewPermissions=r,t.getRecentActivityItemViewPermissions=i,t.shouldRenderActionsMenu=a}),define("modules/clean/react/home/recents/actions/recent_activity_actions",["require","exports","tslib","external/lodash","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/stores/recent_activity_store","modules/clean/react/home/util/navigation","modules/clean/react/home/post_tti/api","modules/clean/react/home/recents/actions/federated_recent_activity_actions","modules/core/exception"],function(e,t,n,r,o,i,a,c,s,l,d){"use strict";function u(e,t,r,o){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return e.federatedRecentItem?(l.shareItem(e.federatedRecentItem,r),[3,4]):[3,1];case 1:return[4,s.waitForHomeTTI()];case 2:return[4,n.sent().shareFile(t[0].id,r,o)];case 3:n.sent(),n.label=4;case 4:return[2]}})})}function m(e,t,n){if(e.federatedRecentItem)l.previewItem(e.federatedRecentItem,n);else if(1===e.attachmentIds.length){var r=c.isMetaKeyPressed(t.event);s.waitForHomeTTI().then(function(o){return(0,o.previewFileSyncRecentItem)(e,r,t,n)})}else{var o=t.shouldFocusCommentInput,i=t.index,a=t.shouldUseEntityUri;d.reportStack("To preview, file sync items must have 1 attachment id",{severity:d.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e,shouldFocusCommentInput:o,index:i,shouldUseEntityUri:a}})}}function h(e,t,r){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return s.waitForHomeTTIWithProps().then(function(n){var o=n.imports,i=n.props;o.deleteRecentItem(e,t,r,i)}),[2]})})}function p(e,t){e.federatedRecentItem?l.promptAndArchiveItem(e.federatedRecentItem,e.viewingUserId,t):d.reportStack("Archiving is not supported",{severity:d.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e}})}function _(){var e=a.getRecentActivityStore().getFileSyncCursor();return e&&s.waitForHomeTTI().then(function(t){return(0,t.loadRecentItems)(e)}),!!e}function E(){return!!a.getRecentActivityStore().getFileSyncCursor()}function T(e,t,o){return void 0===o&&(o=r.noop),n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,s.waitForHomeTTI()];case 1:return[4,n.sent().openFile(e,t)];case 2:return n.sent(),o(),[2]}})})}function f(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,s.waitForHomeTTI()];case 1:return n.sent().downloadFiles(e,t),[2]}})})}function I(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return o=c.getNavigationMethod(t),[4,s.waitForHomeTTI()];case 1:return n.sent().openVersions(o,e,r),[2]}})})}function g(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r;return n.__generator(this,function(n){switch(n.label){case 0:return a.getRecentActivityStore().didReceiveItemsFromAllStreams()?(i.recentActivityDispatcher.dispatch({type:o.REFRESH_RECENT_ACTIVITIES}),[4,s.waitForHomeTTI()]):[3,3];case 1:return e=n.sent(),t=e.loadRecentItems,r=e.loadPaperRecentItems,[4,Promise.all([t(),r(!1)])];case 2:n.sent(),n.label=3;case 3:return[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.shareRecentItem=u,t.previewRecentItem=m,t.deleteRecentItem=h,t.archiveRecentItem=p,t.loadNextPage=_,t.hasCursor=E,t.openFile=T,t.downloadFiles=f,t.openVersions=I,t.refreshRecentItems=g}),define("modules/clean/react/home/recents/components/pending_attachment_list_view",["require","exports","tslib","external/classnames","external/react","external/lodash"],function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.count,t=i.times(Math.min(e,4),function(){return o.createElement("li",{className:"attachment-item attachment-item--placeholder"})}),n={"attachment-list":!0,"attachment-list--is-pending":!0,"attachment-list--standalone":1===e};return o.createElement("div",{className:"recents-item__attachments"},o.createElement("ul",{className:r(n)},t))},t})(o.Component);t.PendingAttachmentListView=a}),define("modules/clean/react/home/recents/components/recent_activity_container",["require","exports","tslib","external/react","external/classnames","modules/core/i18n","modules/clean/react/home/recents/actions/recent_activity_actions","modules/clean/react/home/util/show_hide_link","modules/clean/react/home/recents/stores/recent_activity_store","modules/clean/react/home/store","modules/clean/react/home/util/logging/timing_component","modules/clean/react/home/util/logging/timing_logger","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/recents/components/recent_activity_item_container","modules/clean/react/home/constants","modules/clean/react/home/post_tti/api"],function(e,t,n,r,o,i,a,c,s,l,d,u,m,h,p,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){function t(t){var r=e.call(this,t)||this;return r.onShouldLoadMore=function(){var e=s.getRecentActivityStore();if(!r.state.isPending&&r.state.showAll&&!e.didTruncateRecentItems()&&e.didReceiveItemsFromAllStreams()){var t=e.getRecentItems();t.length>r.state.items.length?r.setState({items:t}):a.loadNextPage()&&r.setState({isPending:!0})}},r.handleVisibilityChange=function(){"visible"===document.visibilityState&&a.refreshRecentItems()},r.onUpdateFromStore=function(){return r.setState(r.getStateFromStore())},r.onShowAll=function(){r.setState({showAll:!0})},r.removeStoreListeners=s.getRecentActivityStore().addListener(r.onUpdateFromStore),r.state=n.__assign({},r.getStateFromStore(),{isUnityAvailable:!1,showAll:!1}),r}return n.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;_.waitForHomeTTI().then(function(t){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return t.recentActivityContainerComponentDidMount(this.onShouldLoadMore),[4,t.getUnityFeatures()];case 1:return e.sent()&&this.setState({isUnityAvailable:!0}),[2]}})})}),!this.state.items.length&&s.getRecentActivityStore().didReceiveItemsFromAllStreams()&&this.setState({isPending:!1}),document.addEventListener("visibilitychange",this.handleVisibilityChange,!1)},t.prototype.componentWillUnmount=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.removeStoreListeners()},t.prototype.getStateFromStore=function(){var e=s.getRecentActivityStore(),t=!e.didReceiveItemsFromAllStreams(),n=e.getRecentItems();if(!t){if(u.homeTimingLogger.logTTData(p.HomeSections.RECENTS)){var r=n.length;r&&m.homeActivityLogger.logRecentsShown(r,!l.getHomeStore().getSectionVisibility()[p.HomeSections.RECENTS])}}return{isPending:t,items:n}},t.prototype.renderLoadingView=function(){return r.createElement("div",{className:"recents-loading-view",key:"loading"},r.createElement("div",{className:"maestro-loading-spinner recents-loading-indicator"}))},t.prototype.renderItems=function(){var e=this.props.now,t=this.state,n=t.items,i=t.showAll,a=t.isPending,c=t.isUnityAvailable,s={isUnityAvailable:c,now:e,user:l.getUser()},d=i?n:n.slice(0,10);return r.createElement("ul",{className:"recents-view__sections",key:"sections"},r.createElement("li",{className:"recents-section"},r.createElement("ul",{className:o({"recents-list":!0,"recents-list--is-pending":a&&0===d.length})},d.map(function(e){return r.createElement(h.RecentActivityItemContainer,{key:e.id,recentItem:e,renderingInfo:s})}))))},t.prototype.renderShowMoreLink=function(){var e=this.state,t=e.items,n=e.showAll,o=Math.max(t.length-10,0);return n||!a.hasCursor()&&o<=0?null:r.createElement(c.ShowHideLink,{key:"show_more",onClick:this.onShowAll,isExpanded:!1,hiddenItemCount:o,canLoadMore:!0})},t.prototype.renderContent=function(){var e=this.state,t=e.isPending;return e.items.length?[this.renderItems(),t?this.renderLoadingView():null,this.renderShowMoreLink()]:t?[this.renderLoadingView(),this.renderItems()]:r.createElement("div",{className:"recents-empty_state",key:"empty_state"},r.createElement("div",{className:"recents-empty_state_image"}),r.createElement("div",{className:"recents-empty_state_heading"},i._("Items you recently viewed will show up here.")))},t.prototype.render=function(){var e=this.state,t=e.isPending,n=e.items,i=o({"recents-view":!0,"recents-view--is-pending":t&&0===n.length});return r.createElement("div",{className:i},this.renderContent())},t.displayName="RecentActivityContainer",t})(r.PureComponent);t.RecentActivityContainerInner=E,t.RecentActivityContainer=d.timingComponent(E,p.HomeSections.RECENTS)}),define("modules/clean/react/home/recents/components/recent_activity_item_actions_view",["require","exports","tslib","external/classnames","external/react","modules/core/i18n","external/lodash","modules/clean/react/home/recents/recent_activity_rendering_models","modules/clean/react/home/recents/actions/recent_activity_action_permissions","modules/clean/react/home/recents/models/utils","spectrum/overflow_button","spectrum/popover"],function(e,t,n,r,o,i,a,c,s,l,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){e.stopPropagation(),e.preventDefault()},h=function(e,t){e(t)},p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onOpen=function(e){t.getHandler(e).handleOpen()},t.onDelete=function(e){t.getHandler(e).handleDelete()},t.onArchive=function(e){t.getHandler(e).handleArchive()},t.onShareLink=function(e){t.getHandler(e).handleShare(!0)},t.onDownload=function(e){t.getHandler(e).handleDownload()},t.onComment=function(e){t.getHandler(e).handleComment(e)},t.onVersions=function(e){t.getHandler(e).handleVersions(e)},t}return n.__extends(t,e),t.prototype.getHandler=function(e){return e.preventDefault(),this.props.handler},t.prototype.createMenuItem=function(e,t,n,r){return e?o.createElement(u.PopoverContentItem,{className:"recents-actions-list__item recents-actions-list__item--"+t,key:t,value:r},n):null},t.prototype.renderMoreActionsList=function(){var e=this.props,t=e.permissions,n=e.renderingInfo,r=e.attachmentCount,o=t.open,c=t.share,s=t.download,l=t.comment,d=t.archive,u=t.versions,m=n.isUnityAvailable;return a.compact([this.createMenuItem(o&&m,"open",i._("Open"),this.onOpen),this.createMenuItem(c,"share-link",i._("Share link"),this.onShareLink),this.createMenuItem(s,"download",i._("Download"),this.onDownload),this.createMenuItem(l,"comment",i._("Comment"),this.onComment),this.createMenuItem(t.delete,"delete",r>1?i._("Delete all…"):i._("Delete…"),this.onDelete),this.createMenuItem(d,"archive",i._("Archive"),this.onArchive),this.createMenuItem(u,"versions",i._("Version history"),this.onVersions)])},t.prototype.renderMoreActionsInnerButton=function(){var e=r({"recents-item__actions-button":!0,"button-secondary":!0,disabled:this.props.disableActions});return o.createElement(d.OverflowButton,{tagName:"span",className:e,"aria-label":i._("More Actions")})},t.prototype.renderMoreActionsButton=function(){return this.props.disableActions?this.renderMoreActionsInnerButton():o.createElement("div",{onClick:m},o.createElement(u.Popover,{onSelection:h},o.createElement(u.PopoverTrigger,null,this.renderMoreActionsInnerButton()),o.createElement(u.PopoverContent,{attachment:"right"},this.renderMoreActionsList())))},t.prototype.render=function(){var e=this.props.permissions;if(s.shouldRenderActionsMenu(e)){var t=this.props,n=t.disableActions,i=t.type,a=r((c={},c["recents-item__more-actions"]=!0,c["recents-item__more-actions--disabled"]=n,c));return l.isShareLinkEventType(i)?o.createElement("div",{className:a}):o.createElement("div",{className:a},o.createElement("div",{className:"recents-item__more-actions-button recents-item__action-button",tabIndex:-1},this.renderMoreActionsButton()))}return null;var c},t.defaultProps={handler:c.getStubRecentActivityItemContainerHandler(),tooltipHandler:c.getStubRecentActivityTooltipHandler(),attachmentCount:1,disableActions:!1},t})(o.PureComponent);t.RecentActivityItemActionsView=p}),define("modules/clean/react/home/recents/components/recent_activity_item_container",["require","exports","tslib","external/lodash","external/react","modules/core/exception","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/actions/recent_activity_actions","modules/clean/react/home/recents/components/recent_activity_item_view","modules/clean/react/home/recents/models/utils","modules/clean/react/home/recents/utils/events","modules/clean/react/home/recents/stores/attachment_store","modules/clean/react/home/post_tti/api"],function(e,t,n,r,o,i,a,c,s,l,d,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){function t(t){var n=e.call(this,t)||this;return n.onAttachmentStoreChange=function(){n.setState({attachments:u.getAttachmentStore().getByIds(n.getRecentItem().attachmentIds)})},n.handleArchive=function(){return c.archiveRecentItem(n.getRecentItem(),n.getLogData())},n.handleComment=function(e){var t=n.getSingleAttachment("handleComment only supports a single attachment"),r=Math.max(0,n.state.attachments.indexOf(t));n.previewOrOpenFiles({event:e,index:r,shouldFocusCommentInput:!0})},n.handleDelete=function(){c.deleteRecentItem(n.getRecentItem(),n.state.attachments,n.getLogData())},n.handleDownload=function(){var e=n.getSingleAttachment("handleDownload only supports a single attachment");c.downloadFiles([e.id],n.getLogData())},n.handleHeaderClick=function(){var e=n.state,t=e.isCollapsed,r=e.attachments;if(n.getRecentItem().uniqueFilterTypes.length>1){var o=t?a.ActionType.UNCOLLAPSE:a.ActionType.COLLAPSE;d.logEvent(o,n,n.getAttachmentFqPaths(),r.length)}n.setState({isCollapsed:!t})},n.handleOpen=function(){var e=n.getSingleAttachment("handleOpen only supports a single attachment");c.openFile(e.id,n.getLogData())},n.handlePathClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.getAttachmentFqPaths(),r=n.props.recentItem,o=r.attachmentIds,i=r.viewingUserId,c=e.currentTarget.href;m.waitForHomeTTI().then(function(e){var r=e.logOpenPathUrl,s=e.openUrl;r(i,t,o.length,n),s(c,a.ActionType.OPEN_PATH,o,n.getLogData())})},n.handlePreview=function(e){n.previewOrOpenFiles({event:e,shouldFocusCommentInput:!1})},n.handleShare=function(e){c.shareRecentItem(n.getRecentItem(),n.state.attachments,n.getLogData(),e)},n.handleVersions=function(e){var t=n.getSingleAttachment("handleVersions only supports a single attachment");c.openVersions(t.id,e,n.getLogData())},n.removeStoreListeners=null,n.state={attachments:[],isCollapsed:!0},n}return n.__extends(t,e),t.prototype.getRecentItem=function(){return this.props.recentItem},t.prototype.getLogData=function(){return{totalCount:this.props.recentItem.attachmentIds.length,cellView:this}},t.prototype.getAttachmentFqPaths=function(){return r.compact(r.map(this.state.attachments,"fqPath"))},t.prototype.getSingleAttachment=function(e){return e&&i.assert(1===this.state.attachments.length,e),this.state.attachments[0]},t.prototype.previewOrOpenFiles=function(e){var t=this.props.recentItem;c.previewRecentItem(t,n.__assign({},e,{shouldUseEntityUri:l.isShareLinkRecentItem(t)}),this.getLogData())},t.prototype.componentWillMount=function(){this.removeStoreListeners=u.getAttachmentStore().addListener(this.onAttachmentStoreChange),this.onAttachmentStoreChange()},t.prototype.componentWillUnmount=function(){this.removeStoreListeners&&this.removeStoreListeners()
},t.prototype.render=function(){return o.createElement(s.RecentActivityItemView,{recentItem:this.getRecentItem(),attachments:this.state.attachments,handler:this,isCollapsed:this.state.isCollapsed,renderingInfo:this.props.renderingInfo})},t.displayName="RecentActivityItemContainer",t})(o.PureComponent);t.RecentActivityItemContainer=h}),define("modules/clean/react/home/recents/components/recent_activity_item_header_view",["require","exports","tslib","external/classnames","external/react","spectrum/icon_arrow","modules/clean/accessibility/utils","modules/clean/react/helpers","modules/clean/react/home/constants","modules/clean/react/home/util/resource_icon","modules/clean/react/home/recents/models/utils","modules/clean/react/home/recents/recent_activity_view_helper"],function(e,t,n,r,o,i,a,c,s,l,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.stopPropagation(),e.preventDefault(),t.props.handleClick(e)},t}return n.__extends(t,e),t.prototype.getHeaderProps=function(){return this.props.header},t.prototype.renderIcon=function(){var e=this.getHeaderProps(),t=e.isAggregation,n=e.displayType,r=e.fileName;return o.createElement("div",{className:"recents-item__icon"},o.createElement("span",{className:"file-icon file-icon--sprite file-icon--spectrum"},o.createElement(l.HomeResourceIcon,{className:"file-icon__img",displayType:t?s.DisplayTypes.AGGREGATION:n||s.DisplayTypes.FILE,variant:"small",fileName:r||""})))},t.prototype.renderHeading=function(){return o.createElement("a",n.__assign({ref:"heading",className:"recents-item__heading"},a.accessibleTriggerProps(this.props.handleClick)),this.getHeaderProps().heading)},t.prototype.renderSubheading=function(){var e=this.getHeaderProps().subheading;return e?o.createElement("div",{ref:"subheading",className:"recents-item__subheading"},e):null},t.prototype.renderDetails=function(){return o.createElement("div",{ref:"recentsItemDetails",className:"recents-item__details"},o.createElement("div",{className:"recents-item__heading-group"},this.renderHeading(),this.renderStar()),this.renderSubheading())},t.prototype.renderStar=function(){var e=this.getHeaderProps().star;return e?o.createElement("div",{className:"item__star"},e):null},t.prototype.renderActions=function(){var e=this.props,t=e.recentActivityType,n=e.children,i=e.tooltipShown;if(t&&d.isShareLinkEventType(t)||0===o.Children.count(n))return null;var a=r((c={},c["recents-item__actions-inner"]=!0,c["recents-item__actions-inner--tooltip-shown"]=i,c));return o.createElement("div",{ref:"actions",className:"recents-item__actions"},o.createElement("div",{className:a},n));var c},t.prototype.renderCarat=function(){var e=this.getHeaderProps(),t=e.isAggregation,n=e.isCollapsed;if(!t)return null;var a=r({"recents-item__carat":!0,"recents-item__carat--expanded":!n});return o.createElement("div",{className:a},o.createElement(i.IconArrow,{name:"right"}))},t.prototype.shouldComponentUpdate=function(e,t){return c.compareStateAndProps(e,t)},t.prototype.render=function(){return o.createElement("div",{className:"recents-item__wrapper",onClick:u.ensureUserIntentToClick(this.onClick)},this.renderCarat(),this.renderIcon(),this.renderDetails(),this.renderActions())},t.defaultProps={handleClick:function(e){return null},tooltipShown:!1},t})(o.PureComponent);t.RecentActivityItemHeaderView=m}),define("modules/clean/react/home/recents/components/recent_activity_item_view",["require","exports","tslib","external/classnames","external/react","external/lodash","modules/core/exception","modules/core/i18n","modules/clean/em_string","modules/clean/datetime","modules/clean/react/helpers","modules/clean/react/home/recents/actions/recent_activity_action_permissions","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/models/utils","modules/clean/react/home/recents/recent_activity_rendering_models","modules/clean/react/home/recents/recent_activity_view_helper","modules/clean/react/home/recents/recent_activity_text_helper","modules/clean/react/home/recents/components/pending_attachment_list_view","modules/clean/react/home/recents/components/recent_activity_item_header_view","modules/clean/react/home/util/conditional_api","modules/clean/react/title_bubble","modules/clean/react/starred/constants","modules/clean/react/home/recents/components/recent_activity_item_actions_view","modules/clean/react/home/util/post_tti_components"],function(e,t,n,r,o,i,a,c,s,l,d,u,m,h,p,_,E,T,f,I,g,y,R,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleMouseEnter=function(){n.setState({isHovered:!0})},n.handleMouseLeave=function(){n.setState({isHovered:!1})},n.onShare=function(e){e.preventDefault(),n.props.handler.handleShare()},n.onShowTooltip=function(){n.setState({tooltipShown:!0})},n.onHideTooltip=function(){n.setState({tooltipShown:!1})},n.state={tooltipShown:!1,isHovered:!1},n}return n.__extends(t,e),t.prototype.shouldDisableActions=function(){var e=this.props.recentItem.federatedRecentItem;return e?!e.hasMenuActions():!this.hasLoadedAttachments()},t.prototype.isAggregation=function(){return this.props.recentItem.attachmentIds.length>1},t.prototype.shouldShowThumbnails=function(){var e=this.props.recentItem;return!h.isShareLinkRecentItem(e)&&h.shouldShowThumbnailsForRecentItem(e)},t.prototype.getLoadedAttachmentsCount=function(){return this.props.attachments.filter(function(e){return e.isLoaded}).length},t.prototype.canRenderAttachmentView=function(){var e=this.getLoadedAttachmentsCount();return e===this.props.recentItem.attachmentIds.length||e>=m.MAX_INITIAL_THUMBNAIL_ATTACHMENTS},t.prototype.hasLoadedAttachments=function(){return!(!this.props.attachments.length||!this.getLoadedAttachmentsCount())},t.prototype.getHeading=function(){var e=this.props,t=e.attachments,n=e.recentItem;if(t.length<2)return s.Emstring.em_snippet(n.displayName||"",30);for(var r=n.attachmentIds.length,o=n.uniqueFilterTypes,i=[],a=0,l=t;a<l.length;a++){var d=l[a];d.isLoaded&&d.displayName&&i.push(d.displayName)}switch(o.length){case 1:switch(o[0]){case m.RECENT_EVENT_FILTER_TYPE.PHOTOS:return c.ungettext("%(count)s image","%(count)s images",r).format({count:r});case m.RECENT_EVENT_FILTER_TYPE.VIDEOS:return c.ungettext("%(count)s video","%(count)s videos",r).format({count:r});case m.RECENT_EVENT_FILTER_TYPE.VISUAL_NOTES:return c.ungettext("%(count)s visual note","%(count)s visual notes",r).format({count:r})}break;case 2:if(o.indexOf(m.RECENT_EVENT_FILTER_TYPE.PHOTOS)>=0&&o.indexOf(m.RECENT_EVENT_FILTER_TYPE.VIDEOS)>=0)return c._("%(count)s images and videos").format({count:r})}return i.length?E.snippetList(i,30,{totalCount:r}):c.ungettext("%(count)s file","%(count)s files",r).format({count:r})},t.prototype.getParentPathComponent=function(){var e=this.props.recentItem,t=e.type,n=e.paths;if(h.isShareLinkRecentItem(e)&&t===m.RECENT_EVENT_TYPES.FILE_SHARED_ADD)return{name:c._("Your links"),url:"/links/your_links"};if(n.length){var r=i.last(n);if(r.url)return r}return null},t.prototype.renderAction=function(){switch(this.props.recentItem.type){case m.RECENT_EVENT_TYPES.FILE_PRIVATE_VIEW:case m.RECENT_EVENT_TYPES.FILE_SHARED_VIEW:case m.RECENT_EVENT_TYPES.PAPER_VIEW:return m.I18N.OPENED;case m.RECENT_EVENT_TYPES.FILE_EDIT:case m.RECENT_EVENT_TYPES.PAPER_EDIT:return m.I18N.EDITED;case m.RECENT_EVENT_TYPES.PAPER_ADD:return m.I18N.CREATED;default:return m.I18N.ADDED}},t.prototype.getSubheading=function(){var e=this.getParentPathComponent(),t=this.props,n=t.renderingInfo,r=t.recentItem,i=t.handler,a=new Date(r.when);return o.createElement("div",{className:"recents-item__subheading"},this.renderAction()+" ",o.createElement(g.TitleBubble,{position:g.TitleBubble.POSITIONS.TOP,content:o.createElement("div",{className:"recents-item__subheading-time-tooltip"},l.format_date(a,"MMM d, yyyy")+"\n"+l.format_date(a,l.localized_time_format))},o.createElement("div",{className:"recents-item__subheading-time"},l.agoFromDate(a,n.now,!1,!0))),e?" · ":"",e?o.createElement("a",{className:"recents-item__subheading-parent",href:e.url,onClick:i.handlePathClick},e.name):null)},t.prototype.renderShareButton=function(){var e=this.props.recentItem,t=e.federatedRecentItem;return(t?t.isShareable():this.hasLoadedAttachments())?o.createElement("a",{ref:"shareLink",className:"button-secondary recents-item__share-link",href:"#share",onClick:this.onShare},c._("Share")):null},t.prototype.renderAttachments=function(){var e=this.props,t=e.recentItem,n=e.attachments;if(this.shouldShowThumbnails()){if(this.props.isCollapsed)return null;var r=t.attachmentIds.length;return this.canRenderAttachmentView()?o.createElement(v.PostTTIRecentActivityImageAttachments,{key:"pendingAttachments",attachments:n,count:r}):o.createElement(T.PendingAttachmentListView,{key:"attachments",count:r})}return this.isAggregation()&&a.reportStack("Tried to render non-photo aggregation but failed",{severity:a.SEVERITY.NONCRITICAL,exc_extra:{recent_item:t,attachments:n}}),null},t.prototype.renderButton=function(e){return e.share?o.createElement("div",{className:"recents-item__sharing recents-item__action-button"},this.renderShareButton()):null},t.prototype.renderStar=function(){var e=this.props,t=e.recentItem,n=e.renderingInfo;return I.waitForStarred(function(e){var r=e.Star,i=e.getIdTypePairFromRecentItem,a=i(t);return a?o.createElement(r,{id:a.id,idType:a.type,user:n.user,source:y.StarredSource.HOME_RECENTS}):null},!1)},t.prototype.getHeaderProps=function(){var e=this.props,t=e.recentItem,n=e.isCollapsed,r=e.attachments,o=t.displayName,i=t.displayType;return{heading:this.getHeading(),subheading:this.getSubheading(),thumbnailUrl:1===r.length&&r[0].thumbnailUrl||void 0,star:this.renderStar(),fileName:o,isAggregation:this.isAggregation(),displayType:i,isCollapsed:n}},t.prototype.renderHeader=function(){var e=this.props,t=e.recentItem,n=e.attachments,r=e.handler,i=e.renderingInfo,a=u.getRecentActivityItemViewPermissions(t,n);return o.createElement(f.RecentActivityItemHeaderView,{ref:"header",key:"header",header:this.getHeaderProps(),handleClick:this.isAggregation()?r.handleHeaderClick:r.handlePreview,tooltipShown:this.state.tooltipShown,recentActivityType:t.type},this.renderButton(a),o.createElement(R.RecentActivityItemActionsView,{ref:"recentsItemActionsView",handler:r,tooltipHandler:this,type:t.type,permissions:a,attachmentCount:t.attachmentIds.length,disableActions:this.shouldDisableActions(),rowIsHovered:this.state.isHovered,renderingInfo:i}))},t.prototype.shouldComponentUpdate=function(e,t){return d.compareStateAndProps(e,t)},t.prototype.render=function(){var e=this.props,t=e.recentItem,n=e.handler,i=r((c={},c["recents-item"]=!0,c["recents-item--loaded"]=this.hasLoadedAttachments(),c)),a=h.isShareLinkRecentItem(t)&&this.isAggregation()?void 0:_.ensureUserIntentToClick(n.handlePreview);return o.createElement("li",{"data-item-id":t.id,"data-item-type":t.type,"data-item-date":t.when,className:i,onClick:a,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},o.createElement(v.PrototypePostTTICalendarRecentActivityDragHandler,{recentItem:t},this.renderHeader(),this.renderAttachments()));var c},t.displayName="RecentActivityItemView",t.defaultProps={handler:p.getStubRecentActivityItemContainerHandler(),isCollapsed:!0,attachments:[]},t})(o.PureComponent);t.RecentActivityItemView=S}),define("modules/clean/react/home/recents/models/attachment",["require","exports","modules/core/exception"],function(e,t,n){"use strict";function r(e){var t=e.preview_jsinfo||null,r=null,o=null;if(t&&(t.thumbnail_url_tmpl&&(r=t.thumbnail_url_tmpl),t.thumbnail_dimensions)){var i=t.thumbnail_dimensions,a=i[0];o={height:i[1],width:a}}var c=e.comment||{},s=c.commenter_dict||{};return c.raw_comment_text&&n.reportStack("Received a comment attachment",{severity:n.SEVERITY.NONCRITICAL,exc_extra:{activity:e}}),{id:e.activity_key,isLoaded:!0,viewingUserId:e.viewing_user.id,displayName:e.name||null,displayType:e.activity_data&&e.activity_data.home_display_type||null,entityUri:e.entity_uri||null,previewInfo:e.preview_jsinfo||null,fqPath:e.fq_path||null,nsPath:e.ns_path||null,nsId:e.ns_id||null,thumbnailUrl:r||null,thumbnailDimensions:o||null,canOpen:!1,inRootCollection:!1,isReadOnly:!!e.is_read_only,isDir:!!e.is_dir,commentRawText:c.raw_comment_text||null,commenterId:s.id||null,commenterDisplayName:s.display_name||null,commenterPhotoUrl:s.photo_circle_url||null}}function o(e){return(e.related_activity_keys||[]).map(function(t){return{id:t,viewingUserId:e.viewing_user.id,displayName:null,displayType:null,isLoaded:!1,canOpen:!1,inRootCollection:!1,isReadOnly:!1,isDir:!1,entityUri:null,previewInfo:null,fqPath:null,nsPath:null,nsId:null,thumbnailUrl:null,thumbnailDimensions:null,commentRawText:null,commenterId:null,commenterDisplayName:null,commenterPhotoUrl:null}})}Object.defineProperty(t,"__esModule",{value:!0}),t.convertFileActivityToAttachmentItem=r,t.createPartialAttachmentsFromRecentActivity=o}),define("modules/clean/react/home/recents/models/federated_recent_item",["require","exports","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_federated_model"],function(e,t,n,r){"use strict";function o(e){switch(e.action||n.PaperRecentItemAction.OPENED){case n.PaperRecentItemAction.CREATED:return n.RECENT_EVENT_TYPES.PAPER_ADD;case n.PaperRecentItemAction.EDITED:return n.RECENT_EVENT_TYPES.PAPER_EDIT;default:return n.RECENT_EVENT_TYPES.PAPER_VIEW}}function i(e,t,i){var a=new r.FederatedRecentItem(e),c=a.getActivityKey();return{federatedRecentItem:a,id:c,idType:e.id_type,resourceId:e.resource_id,type:o(e),icon:a.getIcon(),displayType:e.display_type,when:e.time,viewingUserId:t.id,displayName:e.name,accountDisplayName:t.display_name,contextDisplayName:a.getFolderPath()||t.display_name,attachmentIds:[c],paths:e.path,order:i,uniqueFilterTypes:[n.RECENT_EVENT_FILTER_TYPE.DOCUMENTS]}}Object.defineProperty(t,"__esModule",{value:!0}),t.createRecentItemFromPaperRecentItem=i}),define("modules/clean/react/home/recents/models/recent_item",["require","exports","external/lodash","modules/clean/react/home/recents/actions/error_actions","modules/clean/react/home/recents/models/utils"],function(e,t,n,r,o){"use strict";function i(e){try{var t=e.skeleton_data;return{id:e.activity_key,type:e.recent_event_type||null,icon:t&&t.icon||null,displayType:e.activity_data&&e.activity_data.home_display_type||null,when:e.when_milli||null,viewingUserId:e.viewing_user.id,displayName:t&&t.display_name||null,accountDisplayName:t&&t.account_display_name||null,contextDisplayName:t&&t.context_display_name||null,uniqueFilterTypes:t?n.uniq(n.values(t.filter_types_by_key)):[],attachmentIds:e.related_activity_keys||[],paths:o.getPathsByFqPath(t&&t.context_display_path||"",e.viewing_user.id,!0),order:c(e.activity_key),idType:e.id_type,resourceId:e.resource_id}}catch(t){return n.defer(function(){return r.errorActions.recentActivityParseError(e.activity_key,t)}),null}}Object.defineProperty(t,"__esModule",{value:!0});var a=0,c=n.memoize(function(e){return a+=1});t.convertRecentActivityToRecentItem=i}),define("modules/clean/react/home/recents/models/utils",["require","exports","external/lodash","modules/clean/browse_uri_interface","modules/clean/react/home/recents/recent_activity_constants","modules/clean/viewer"],function(e,t,n,r,o,i){"use strict";function a(e){var t=n.values(e.filter_types_by_key);return s(t.length,n.uniq(t))}function c(e){return s(e.attachmentIds.length,e.uniqueFilterTypes)}function s(e,t){return!!(e>1&&t.every(function(e){return T.indexOf(e)>=0}))}function l(e){return n.map(e,"id")}function d(e){return e in f}function u(e){return null!==e.type&&d(e.type)}function m(e,t,o){void 0===o&&(o=!1);var a=i.Viewer.get_viewer().get_user_by_id(t);"/"===e&&(e="");var c=[],s=e.split("/");for(o||s.pop();s.length;){var l=n.last(s),d=s.join("/");1===s.length&&""===l&&(l=i.Viewer.get_root_name(a),d="");var u=r.browse_uri_for_fq_path(a,d).toString();c.push({name:l||"",url:u}),s.pop()}return c.reverse()}function h(e,t){return t.when-e.when||e.order-t.order||t.type-e.type}Object.defineProperty(t,"__esModule",{value:!0});var p=o.RECENT_EVENT_FILTER_TYPE.PHOTOS,_=o.RECENT_EVENT_FILTER_TYPE.VIDEOS,E=o.RECENT_EVENT_FILTER_TYPE.VISUAL_NOTES,T=[p,_,E];t.shouldShowThumbnailsForSkeletonData=a,t.shouldShowThumbnailsForRecentItem=c,t.extractAttachmentIds=l;var f=(I={},I[o.RECENT_EVENT_TYPES.FILE_SHARED_ADD]=!0,I[o.RECENT_EVENT_TYPES.FILE_SHARED_VIEW]=!0,I);t.isShareLinkEventType=d,t.isShareLinkRecentItem=u,t.getPathsByFqPath=m,t.compareRecentItems=h;var I}),define("modules/clean/react/home/recents/recent_activity_client_utils",["require","exports"],function(e,t){"use strict";function n(e){if("ok"===e.status)return e.payload;throw new Error("Payload not okay: "+JSON.stringify(e))}Object.defineProperty(t,"__esModule",{value:!0}),t.getPayload=n}),define("modules/clean/react/home/recents/recent_activity_constants",["require","exports","modules/constants/python","modules/core/i18n"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RECENT_EVENT_TYPES=n.RECENT_EVENT_TYPES,t.RECENT_EVENT_FILTER_TYPE=n.RECENT_EVENT_FILTER_TYPE,t.ARCHIVE_PAPER_DOCUMENT_COMMIT="ARCHIVE_PAPER_DOCUMENT_COMMIT",t.ARCHIVE_PAPER_DOCUMENT_PENDING="ARCHIVE_PAPER_DOCUMENT_PENDING",t.ARCHIVE_PAPER_DOCUMENT_ROLLBACK="ARCHIVE_PAPER_DOCUMENT_ROLLBACK",t.DELETE_FILES_COMMIT="DELETE_FILES_COMMIT",t.DELETE_FILES_PENDING="DELETE_FILES_PENDING",t.DELETE_FILES_ROLLBACK="DELETE_FILES_ROLLBACK",t.RAW_RECENT_ACTIVITY_PARSE_ERROR="RAW_RECENT_ACTIVITY_PARSE_ERROR",t.RAW_RELATED_ACTIVITY_PARSE_ERROR="RAW_RELATED_ACTIVITY_PARSE_ERROR",t.RECEIVE_CAN_OPEN_INFO="RECEIVE_CAN_OPEN_INFO",t.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO="RECEIVE_FILE_IN_ROOT_COLLECTION_INFO",t.RECEIVE_PAPER_RECENT_ITEMS="RECEIVE_PAPER_RECENT_ITEMS",t.RECEIVE_RAW_RECENT_ACTIVITIES="RECEIVE_RAW_RECENT_ACTIVITIES",t.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY="RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY",t.REFRESH_RECENT_ACTIVITIES="REFRESH_RECENT_ACTIVITIES",t.ADD_PENDING_ACTIVITY_KEYS="ADD_PENDING_ACTIVITY_KEYS",t.REMOVE_PENDING_ACTIVITY_KEYS="REMOVE_PENDING_ACTIVITY_KEYS",t.MAX_INITIAL_DOC_ATTACHMENTS=3,t.SHOW_MORE_DOC_ATTACHMENT_INCREMENT=10,t.MAX_INITIAL_THUMBNAIL_ATTACHMENTS=8,t.SHOW_MORE_THUMBNAIL_ROW_INCREMENT=4;(function(e){e.CREATED="CREATE",e.OPENED="VIEW",e.EDITED="EDIT"})(t.PaperRecentItemAction||(t.PaperRecentItemAction={})),t.PaperRecentItemTypes={DOCUMENT:"DOCUMENT",FOLDER:"FOLDER",PROJECT:"PROJECT"},t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_PRE_TTI=10,t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_POST_TTI=100,t.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS=1,t.I18N={CREATED:r._("Created"),EDITED:r._("Edited"),OPENED:r._("Opened"),ADDED:r._("Added")};(function(e){e.VIEW_FILE="view",e.OPEN="open",e.SHARE="share",e.SHARE_COLLECTION="share_collection",e.DELETE="delete",e.HIDE="hide",e.UNITY_OPEN="unity_open",e.OPEN_DIR="open_dir",e.OPEN_PATH="open_path",e.REPORT_JUNK="report_junk",e.COMMENT="comment",e.DOWNLOAD="download",e.VERSIONS="versions",e.VIEW_SHARED_LINK="view_shared_link",e.PAPER_ARCHIVE="paper_archive",e.PAPER_OPEN="paper_open",e.PAPER_SHARE="paper_share",e.COLLAPSE="collapse",e.UNCOLLAPSE="uncollapse",e.ONBOARDING_DISMISSED="onboarding_dismissed",e.FULL_ONBOARDING_OPENED="full_onboarding_opened",e.FULL_ONBOARDING_DISMISSED="full_onboarding_dismissed"})(t.ActionType||(t.ActionType={}));(function(e){e.SINGLE="single",e.SUBSET="subset",e.AGGREGATION="aggregation"})(t.ActionScope||(t.ActionScope={}))}),define("modules/clean/react/home/recents/recent_activity_dispatcher",["require","exports","external/flux"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recentActivityDispatcher=new n.Dispatcher}),define("modules/clean/react/home/recents/recent_activity_federated_model",["require","exports","modules/clean/react/home/recents/recent_activity_constants"],function(e,t,n){"use strict";function r(e){return e.paperRecentItem.type===n.PaperRecentItemTypes.DOCUMENT}function o(e){return e.paperRecentItem.type===n.PaperRecentItemTypes.PROJECT}function i(e){return r(e)?e.paperRecentItem.shareUrl||"":""}function a(e,t){return e.paperRecentItem.id===t.id&&e.paperRecentItem.type===t.type}Object.defineProperty(t,"__esModule",{value:!0}),t.isPaperDocument=r,t.isPaperProject=o,t.getPaperShareUrl=i,t.equalsPaperRecentItem=a;var c=(function(){function e(e){this.paperRecentItem=e}return e.prototype.isShareable=function(){return r(this)&&!!i(this)},e.prototype.isArchiveable=function(){return r(this)&&!!this.paperRecentItem.isEditable},e.prototype.hasMenuActions=function(){return this.isArchiveable()},e.prototype.getIdTypePair=function(){return{id:this.paperRecentItem.resource_id,type:this.paperRecentItem.id_type}},e.prototype.getStarredStatus=function(){return{starred:this.paperRecentItem.isFavorite,idTypePair:this.getIdTypePair()}},e.prototype.getIcon=function(){switch(this.paperRecentItem.display_type){case"PAPER_DOCUMENT":return"paper_doc";case"PAPER_FOLDER":return"folder";case"PAPER_PUBLIC_FOLDER":return"folder_team";case"PAPER_PROJECT":return"paper_project";default:return"file"}},e.prototype.getFolderPath=function(){return[""].concat(this.paperRecentItem.path.map(function(e){return e.name})).join("/")},e.prototype.getFqPath=function(){return this.getFolderPath()+"/"+this.paperRecentItem.name},e.prototype.getActivityKey=function(){return"paper_id_"+this.paperRecentItem.id},e.prototype.getUrl=function(){return this.paperRecentItem.url},e})();t.FederatedRecentItem=c}),define("modules/clean/react/home/recents/recent_activity_logger_utils",["require","exports","modules/clean/web_timing_logger"],function(e,t,n){"use strict";function r(){if(!s){var e=n.start_time();if(e)return s=!0,{isFullPage:!0,startTime:e}}return{isFullPage:!1,startTime:Date.now()}}function o(){s=!1,c=!1}function i(){return!c}function a(){c=!0}Object.defineProperty(t,"__esModule",{value:!0});var c=!1,s=!1;t.getRecentsLoggingData=r,t.reset=o,t.canLogFirstAction=i,t.onLogFirstAction=a}),define("modules/clean/react/home/recents/recent_activity_rendering_models",["require","exports"],function(e,t){"use strict";function n(){return{handleArchive:function(){},handleComment:function(e){},handleDelete:function(){},handleDownload:function(){},handleHeaderClick:function(){},handleOpen:function(){},handlePathClick:function(){},handlePreview:function(e){},handleShare:function(){},handleVersions:function(e){}}}function r(){return{onShowTooltip:function(){},onHideTooltip:function(){}}}Object.defineProperty(t,"__esModule",{value:!0}),t.getStubRecentActivityItemContainerHandler=n,t.getStubRecentActivityTooltipHandler=r}),define("modules/clean/react/home/recents/recent_activity_stream",["require","exports","external/lodash","modules/clean/react/home/recents/models/utils"],function(e,t,n,r){"use strict";function o(e){var t=e.filter(Boolean),o=n.max(t.map(function(e){return e.oldestTimeForOtherStream}));return(i=[]).concat.apply(i,t.map(function(e){return e.getItemsAfter(o)})).sort(r.compareRecentItems);var i}Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){var n=this;this.sortedRecentItems=e,this.hasMore=t,this.activityKeyToRecentItem={},e.forEach(function(e){n.activityKeyToRecentItem[e.id]=e}),this.oldestTimeForOtherStream=this.getOldestItemTimeForOtherStreams()}return e.prototype.getOldestItemTimeForOtherStreams=function(){return this.hasMore&&this.sortedRecentItems.length?this.sortedRecentItems[this.sortedRecentItems.length-1].when||0:0},e.prototype.getRecentItems=function(){return this.sortedRecentItems.slice()},e.prototype.getRecentItemByActivityKey=function(e){return this.activityKeyToRecentItem[e]||null},e.prototype.getStreamWithoutActivityKey=function(t){return new e(this.sortedRecentItems.filter(function(e){return e.id!==t}),this.hasMore)},e.prototype.getItemsAfter=function(e){if(this.oldestTimeForOtherStream<e){for(var t=[],n=0,r=this.sortedRecentItems;n<r.length;n++){var o=r[n];if(o.when<e)break;t.push(o)}return t}return this.sortedRecentItems},e})();t.RecentActivityStream=i,t.getMergedRecentItems=o}),define("modules/clean/react/home/recents/recent_activity_text_helper",["require","exports","modules/clean/em_string","modules/core/i18n"],function(e,t,n,r){"use strict";function o(e,t){return r.ungettext("%(name)s and %(num)s other","%(name)s and %(num)s others",t).format({name:e,num:t})}function i(e,t,i){void 0===i&&(i={});var a=Math.max(Math.floor(i.totalCount||0),e.length);if(1===a)return n.Emstring.em_snippet(e[0],t);var c=e[0],s=a-1,l=o(c,s);if(new n.Emstring(l).length>t){var d=Math.floor(t-new n.Emstring(o("",s)).length)-1;l=d<3?r.ungettext("%(num)s other","%(num)s others",a).format({num:a}):o(n.Emstring.em_snippet(c,d),s)}for(var u="",m=1;m<e.length&&(m+=1,u=e.slice(0,m).join(", "),m<a&&(u=o(u,a-m)),new n.Emstring(u).length<t);)l=u;return l}Object.defineProperty(t,"__esModule",{value:!0}),t.snippetList=i}),define("modules/clean/react/home/recents/recent_activity_view_helper",["require","exports"],function(e,t){"use strict";function n(e){return function(t){if(!window.getSelection().toString()){for(var n=t.target;n&&n.parentNode&&n!==t.currentTarget;){if(["a","button"].indexOf(n.nodeName.toLowerCase())>=0)return;n=n.parentNode}e.apply(this,arguments)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.ensureUserIntentToClick=n}),define("modules/clean/react/home/recents/section",["require","exports","tslib","external/react","modules/clean/react/home/actions","modules/clean/react/home/constants","modules/clean/react/home/recents/components/recent_activity_container","modules/clean/react/home/section_header","modules/clean/react/home/util/logging/timing_logger","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/store","modules/core/i18n"],function(e,t,n,r,o,i,a,c,s,l,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChangeRecentsVisibility=function(){var e=!t.props.isHiddenByUser;o.HomeActions.setSectionVisibility(d.getUserId(),{".tag":"recents"},!e),l.homeActivityLogger.logShowHideSection(i.HomeSections.RECENTS,e)},t.renderHiddenText=function(){return r.createElement("div",{className:"home-access__recents-hidden-text"},u._("Your recently viewed files are hidden")," · ",r.createElement("button",{className:"button-as-link",onClick:t.onChangeRecentsVisibility},u._("Show")))},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.props.isHiddenByUser&&s.homeTimingLogger.logSkippedSection(i.HomeSections.RECENTS)},t.prototype.render=function(){var e=this.props.now,t=null,n="home-recents-section__container",o=null;return this.props.isHiddenByUser?(t=u._("Show"),n="home-recents-section__container-hidden",o=this.renderHiddenText()):t=u._("Hide"),r.createElement("li",{className:"home-access-section"},r.createElement("span",{className:"home-recents-section"},r.createElement(c.SectionHeader,{title:u._("Recent"),ueName:"recents",buttonText:t,buttonAction:this.onChangeRecentsVisibility}),r.createElement("div",{className:"home-access-section__content"},o,r.createElement("div",{className:n},r.createElement(a.RecentActivityContainer,{now:e})))))},t.displayName="HomeRecentsSection",t})(r.PureComponent);t.HomeRecentsSection=m}),define("modules/clean/react/home/recents/store_utils",["require","exports","tslib","modules/clean/react/home/store","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/recent_activity_logger_utils","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/models/utils","modules/clean/react/home/recents/recent_activity_client_utils"],function(e,t,n,r,o,i,a,c,s){"use strict";function l(e,t,l){var u=this;void 0===l&&(l=!0);try{var m=i.getRecentsLoggingData(),h=s.getPayload(t),p=h.recent_activities,_=h.cursor,E=h.encrypted,T=r.getUserId();return o.recentActivityDispatcher.dispatch({type:a.RECEIVE_RAW_RECENT_ACTIVITIES,rawRecentActivities:p,cursor:_||"",encrypted:E||"",userId:T}),d(e,function(){return n.__awaiter(u,void 0,void 0,function(){var t,r,o;return n.__generator(this,function(n){switch(n.label){case 0:return t=[],p.forEach(function(e){if(e.skeleton_data&&e.related_activity_keys){var n=c.shouldShowThumbnailsForSkeletonData(e.skeleton_data)?a.MAX_INITIAL_THUMBNAIL_ATTACHMENTS:a.MAX_INITIAL_DOC_ATTACHMENTS;t=t.concat.apply(t,e.related_activity_keys.slice(0,n))}}),[4,e()];case 1:return[4,n.sent().ensureAttachments(t,"handleAndLogRecentsJsonPromise")];case 2:return n.sent(),r=!1,o=0,p.forEach(function(e){var t=e.skeleton_data;t&&(o+=t.num_related_activities||0,(t.num_related_activities||0)>1&&(r=!0))}),e().then(function(e){return(0,e.logRecentsLoaded)(T,m,{is_paginated:!l,contains_aggregation:r,item_count:o})}),[2]}})})})}catch(t){throw e().then(function(e){return(0,e.logRequestFailed)(r.getUserId(),t)}),t}}function d(e,t){return n.__awaiter(this,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t()];case 1:return[2,n.sent()];case 2:throw o=n.sent(),e().then(function(e){return(0,e.logRequestFailed)(r.getUserId(),o)}),o;case 3:return[2]}})})}function u(e,t,n){void 0===n&&(n=!0);var i=r.getUserId(),c=s.getPayload(t),l=n&&c.has_more;o.recentActivityDispatcher.dispatch({type:a.RECEIVE_PAPER_RECENT_ITEMS,items:c.items,hasMore:l,userId:i}),l&&e().then(function(e){return(0,e.loadPaperRecentItems)(!1)})}Object.defineProperty(t,"__esModule",{value:!0}),t.handleAndLogRecentsJsonPromise=l,t.logErrorAndRethrowAsync=d,t.handleRetrievePaperRecentsPromise=u}),define("modules/clean/react/home/recents/stores/attachment_store",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/constants","external/lodash","modules/clean/flux/flux_store","modules/clean/react/home/recents/actions/error_actions","modules/clean/react/home/recents/stores/flux_utils","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/models/attachment","modules/core/exception"],function(e,t,n,r,o,i,a,c,s,l,d,u,m){"use strict";function h(){return null===_&&(_=new p(d.recentActivityDispatcher)),_}Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;return r.onCommit=function(e){delete r.transactionHistory[e.transactionId]},r._onDeleteFilesPending=function(e){for(var t=[],n=0,o=e.attachmentIds;n<o.length;n++){var i=o[n];i in r.attachmentIdToAttachment&&(t.push(r.attachmentIdToAttachment[i]),delete r.attachmentIdToAttachment[i])}r.transactionHistory[e.transactionId]={deletedAttachments:t},s.emitChangeIfNeeded(r,!!t.length)},r._onDeleteFilesRollback=function(e){var t=r.transactionHistory[e.transactionId];m.assert(!!t,"Unable to find data for transaction with id: "+e.transactionId),t.deletedAttachments.forEach(function(e){return r.attachmentIdToAttachment[e.id]=e}),s.emitChangeIfNeeded(r,!!t.deletedAttachments.length)},r.pendingActivityKeys=[],r.attachmentIdToEncryptedToken={},r.attachmentIdToAttachment={},(n.attachments||[]).forEach(function(e){r.attachmentIdToAttachment[e.id]=e,n.encryptedToken&&(r.attachmentIdToEncryptedToken[e.id]=n.encryptedToken)}),r.transactionHistory={},r}return n.__extends(t,e),t.prototype.areSomeActivityKeysPending=function(e){return!!i.intersection(this.pendingActivityKeys,e).length},t.prototype.getById=function(e){return this.attachmentIdToAttachment[e]||null},t.prototype.getByIds=function(e){return i.values(i.pick(this.attachmentIdToAttachment,e))},t.prototype.getByFqPath=function(e){return this.getAll().find(function(t){return t.fqPath===e})||null},t.prototype.getAll=function(){
return i.values(this.attachmentIdToAttachment)},t.prototype.groupIdsByEncryptedToken=function(e){var t=this;return i.groupBy(e.filter(function(e){return e in t.attachmentIdToEncryptedToken}),function(e){return t.attachmentIdToEncryptedToken[e]})},t.prototype.__onDispatch=function(e){switch(e.type){case l.ADD_PENDING_ACTIVITY_KEYS:this.onAddPendingActivityKeys(e);break;case l.REMOVE_PENDING_ACTIVITY_KEYS:this.onRemovePendingActivityKeys(e);break;case l.DELETE_FILES_COMMIT:this.onCommit(e);break;case l.DELETE_FILES_PENDING:this._onDeleteFilesPending(e);break;case l.DELETE_FILES_ROLLBACK:this._onDeleteFilesRollback(e);break;case l.RECEIVE_RAW_RECENT_ACTIVITIES:this.onReceiveRawRecentActivities(e);break;case l.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY:this.onReceiveRawRelatedActivitiesByKey(e);break;case l.RECEIVE_CAN_OPEN_INFO:this.onReceiveCanOpenInfo(e);break;case l.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO:this._onReceiveFileInRootCollectionInfo(e)}},t.prototype.mutateAttachmentInNsIdPath=function(e,t){if(e&&e.indexOf(":")>=0){var n=e.split(":"),r=n[0],o=n[1],i=this.getAll().find(function(e){return e.nsId===Number(r)&&e.nsPath===o})||null;if(i){var a=s.getMutatedOrOriginal(i,t);if(a!==i)return this.attachmentIdToAttachment[i.id]=a,!0}}return!1},t.prototype.updatePendingActivityKeys=function(e,t){var n=this.pendingActivityKeys.length;if(t){var r=(o=this.pendingActivityKeys).concat.apply(o,e);this.pendingActivityKeys=i.uniq(r)}else this.pendingActivityKeys=i.without.apply(i,[this.pendingActivityKeys].concat(e));s.emitChangeIfNeeded(this,n!==this.pendingActivityKeys.length);var o},t.prototype.onAddPendingActivityKeys=function(e){this.updatePendingActivityKeys(e.activityKeys,!0)},t.prototype.onRemovePendingActivityKeys=function(e){this.updatePendingActivityKeys(e.activityKeys,!1)},t.prototype.onReceiveRawRecentActivities=function(e){var t=this,n=e.rawRecentActivities.map(u.createPartialAttachmentsFromRecentActivity),r=(o=[]).concat.apply(o,n).filter(function(e){var n=t.getById(e.id);return!n||!n.isLoaded});r.forEach(function(n){t.attachmentIdToAttachment[n.id]=n,t.attachmentIdToEncryptedToken[n.id]=e.encrypted}),s.emitChangeIfNeeded(this,!!r.length);var o},t.prototype.onReceiveRawRelatedActivitiesByKey=function(e){var t=this;if(e.rawRelatedActivitiesByKey){var n=Object.keys(e.rawRelatedActivitiesByKey);this.updatePendingActivityKeys(n,!1);var a={};s.iterateAndEmitChangesIfNeeded(this,e.rawRelatedActivitiesByKey,function(e,n){try{var r=u.convertFileActivityToAttachmentItem(e);return r.previewInfo&&!r.previewInfo.is_dir&&(a[r.id]=r.previewInfo),t.attachmentIdToAttachment[r.id]=r,!0}catch(e){return i.defer(function(){return c.errorActions.relatedActivityParseError(n,e)}),!1}}),setTimeout(function(){return r.Dispatcher.dispatch({type:o.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:a})})}},t.prototype.onReceiveCanOpenInfo=function(e){var t=this;s.iterateAndEmitChangesIfNeeded(this,e.canOpenInfo,function(e,n){return t.mutateAttachmentInNsIdPath(n,{canOpen:e.is_locally_available})})},t.prototype._onReceiveFileInRootCollectionInfo=function(e){var t=this;s.iterateAndEmitChangesIfNeeded(this,e.fileInRootCollectionInfo,function(e,n){return t.mutateAttachmentInNsIdPath(n,{inRootCollection:e})})},t})(a.FluxStore);t.AttachmentStore=p;var _=null;t.getAttachmentStore=h}),define("modules/clean/react/home/recents/stores/flux_utils",["require","exports","tslib"],function(e,t,n){"use strict";function r(e,t,n){var r=!1;Object.keys(t).forEach(function(e){n(t[e],e)&&(r=!0)}),o(e,r)}function o(e,t){t&&e.__emitChange()}function i(e,t){for(var r in t)if(t[r]!==e[r])return n.__assign({},e,t);return e}Object.defineProperty(t,"__esModule",{value:!0}),t.iterateAndEmitChangesIfNeeded=r,t.emitChangeIfNeeded=o,t.getMutatedOrOriginal=i}),define("modules/clean/react/home/recents/stores/recent_activity_store",["require","exports","tslib","external/lodash","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/models/federated_recent_item","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/models/recent_item","modules/clean/react/home/recents/models/utils","modules/clean/react/home/recents/stores/flux_utils","modules/clean/react/home/recents/stores/attachment_store","modules/clean/react/home/store","modules/core/exception","modules/clean/react/home/recents/recent_activity_stream","modules/clean/react/home/post_tti/api","modules/clean/viewer","modules/clean/react/home/constants","modules/clean/react/home/util/logging/availability_logger","modules/clean/react/home/recents/store_utils","modules/clean/flux/flux_store"],function(e,t,n,r,o,i,a,c,s,l,d,u,m,h,p,_,E,T,f,I){"use strict";function g(){return null===R&&(R=new y(a.recentActivityDispatcher)),R}Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){function t(t,n){void 0===n&&(n=[]);var r=e.call(this,t)||this;r.handlePaperRecentsPrefetch=function(){return T.getHomeAvailabilityLogger().handlePrefetch(E.HomePrefetchTypes.RETRIEVE_PAPER_RECENTS,function(e){return f.handleRetrievePaperRecentsPromise(p.waitForHomeTTI,e)})},r.removeFileSyncItem=function(e){r.fileSyncRecentItemIdToRecentItem.hasOwnProperty(e.id)&&(delete r.fileSyncRecentItemIdToRecentItem[e.id],r.needsToRefreshFileSyncCache=!0)},r.addFileSyncItem=function(e){e!==r.fileSyncRecentItemIdToRecentItem[e.id]&&(r.fileSyncRecentItemIdToRecentItem[e.id]=e,r.needsToRefreshFileSyncCache=!0)},r.fileSyncRecentItemIdToRecentItem={},r.fileSyncCursor=null,r.fileSyncTransactionIdToRestoreData={},r.didReceiveRawRecentActivities=!!n.length,n.forEach(r.addFileSyncItem),r.fileSyncCache={items:n},r.needsToRefreshFileSyncCache=!1;var i=u.getHomeStore().getSectionLoadingPreference(E.ConditionalSections.PAPER_RECENTS)===E.ConditionalSectionLoadingPreference.POST_TTI;return r.paperStream=i?new h.RecentActivityStream([],!1):null,r.didRecievePaperItems=i,r.paperActivityKeyToPendingArchiving={},r.cachedFederatedRecentItems=[],r.cachedFederatedTruncatedRecentItems=[],r.federatedRecentItemsCountMax=o.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_PRE_TTI,p.waitForHomeTTI().then(function(){r.federatedRecentItemsCountMax=o.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_POST_TTI,r.didTruncateRecentItems()&&r.cacheTruncatedFederatedRecentItems()}),d.getAttachmentStore(),T.getHomeAvailabilityLogger().handlePrefetch(E.HomePrefetchTypes.RECENTS_JSON,function(e){return f.handleAndLogRecentsJsonPromise(p.waitForHomeTTI,e)}),i?p.waitForHomeTTI().then(r.handlePaperRecentsPrefetch):r.handlePaperRecentsPrefetch(),r}return n.__extends(t,e),t.prototype.getSortedFileSyncRecentItems=function(){return this.fileSyncCache.sortedItems||(this.fileSyncCache.sortedItems=this.fileSyncCache.items.slice().sort(s.compareRecentItems)),this.fileSyncCache.sortedItems},t.prototype.__onDispatch=function(e){this.fileSyncHandler(e)||this.paperHandler(e)},t.prototype.fileSyncHandler=function(e){switch(e.type){case o.DELETE_FILES_COMMIT:this.onDeleteCommit(e);break;case o.DELETE_FILES_PENDING:this.onDeleteFilesPending(e);break;case o.DELETE_FILES_ROLLBACK:this.onDeleteFilesRollback(e);break;case o.RECEIVE_RAW_RECENT_ACTIVITIES:this.onReceiveRawRecentActivities(e);break;case o.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY:this.onReceiveRawRelatedActivitiesByKey(e);break;case o.RAW_RELATED_ACTIVITY_PARSE_ERROR:this.onRawRelatedActivityParseError(e);break;case o.REFRESH_RECENT_ACTIVITIES:this.onRefreshRecentActivities();break;default:return!1}return this.updateFileSyncCache(!0),!0},t.prototype.paperHandler=function(e){switch(e.type){case o.RECEIVE_PAPER_RECENT_ITEMS:this.onReceivePaperRecentItems(e.items,e.hasMore,e.userId);break;case o.ARCHIVE_PAPER_DOCUMENT_PENDING:this.onArchivePaperDocumentPending(e.activityKey);break;case o.ARCHIVE_PAPER_DOCUMENT_COMMIT:this.onArchivePaperDocumentCommit(e.activityKey);break;case o.ARCHIVE_PAPER_DOCUMENT_ROLLBACK:this.onArchivePaperDocumentRollback(e.activityKey);break;default:return}this.__emitChange()},t.prototype.updateFileSyncCache=function(e){this.needsToRefreshFileSyncCache&&(this.fileSyncCache={items:r.values(this.fileSyncRecentItemIdToRecentItem)},this.clearFederatedCache(),this.needsToRefreshFileSyncCache=!1,l.emitChangeIfNeeded(this,e))},t.prototype.onDeleteCommit=function(e){delete this.fileSyncTransactionIdToRestoreData[e.transactionId]},t.prototype.onReceiveRawRecentActivities=function(e){var t=this;l.emitChangeIfNeeded(this,!this.didReceiveRawRecentActivities&&!e.rawRecentActivities.length),this.didReceiveRawRecentActivities=!0;var n=!this.fileSyncCache.items.length,i=[],a={};if(e.rawRecentActivities.forEach(function(s){if(s.viewing_user&&s.viewing_user.id===e.userId){var l=c.convertRecentActivityToRecentItem(s);if(l&&(l.uniqueFilterTypes.indexOf(o.RECENT_EVENT_FILTER_TYPE.JUNK)<0||l.uniqueFilterTypes.indexOf(o.RECENT_EVENT_FILTER_TYPE.ALL)>=0))if(i.push(s),n)t.fileSyncRecentItemIdToRecentItem[l.id]=l;else if(!a[l.id]){a[l.id]=l;var d=t.fileSyncCache.items.find(function(e){return e.id!==l.id&&e.contextDisplayName===l.contextDisplayName});if(d){var u=r.intersection(d.attachmentIds,l.attachmentIds);u.length>0&&(t.removeFileSyncItem(d),t.updateFileSyncCache(!1))}var m=t.fileSyncRecentItemIdToRecentItem[l.id];t.updateFileSyncItem(l,{fqPath:m&&m.fqPath||void 0,paths:m&&m.paths||l.paths})}}}),p.waitForHomeTTI().then(function(e){return e.fetchStarredStatus(i)}),this.updateFileSyncCache(!1),!n){var s={};this.getSortedFileSyncRecentItems().forEach(function(e){if(e.attachmentIds.length>0){var n=Object.keys(s).length;e.attachmentIds.forEach(function(e){return s[e]=!0}),n===Object.keys(s).length&&t.removeFileSyncItem(e)}})}this.fileSyncCursor=e.cursor,this.needsToRefreshFileSyncCache=!0},t.prototype.onReceiveRawRelatedActivitiesByKey=function(e){var t=this;this.waitForAttachmentStoreDispatcher();var n=Object.keys(e.rawRelatedActivitiesByKey||{});n.length&&this.clearFederatedCache(),this.getFileSyncRecentItemsByAttachmentIds(n).forEach(function(e){var n=e.id,r=t.fileSyncRecentItemIdToRecentItem[n];if(r){var o=r.attachmentIds;if(o&&o.length){var i=d.getAttachmentStore().getById(o[0]);if(i&&i.isLoaded){var a=i.fqPath||"";o.slice(1).forEach(function(e){var t=d.getAttachmentStore().getById(e);if(t.isLoaded){var n=t.fqPath||"";n.split("/").length<a.split("/").length&&(a=n)}});var c=a.split("/"),l=c[c.length-2];t.updateFileSyncItem(r,{fqPath:a,paths:s.getPathsByFqPath(a,r.viewingUserId),contextDisplayName:l||r.contextDisplayName})}}}})},t.prototype.onRawRelatedActivityParseError=function(e){this.getFileSyncRecentItemsByAttachmentIds(r.map(e.errors,"activityKey")).forEach(this.removeFileSyncItem)},t.prototype.onDeleteFilesPending=function(e){this.waitForAttachmentStoreDispatcher();var t=this.deleteAttachments(e.attachmentIds);t&&(this.fileSyncTransactionIdToRestoreData[e.transactionId]=t)},t.prototype.onDeleteFilesRollback=function(e){this.waitForAttachmentStoreDispatcher();var t=this.fileSyncTransactionIdToRestoreData[e.transactionId];m.assert(!!t,"Unable to find data for transaction with id: "+e.transactionId),delete this.fileSyncTransactionIdToRestoreData[e.transactionId],this.rollbackDelete(t)},t.prototype.onRefreshRecentActivities=function(){this.getRecentItems(),this.didReceiveRawRecentActivities=!1,this.didRecievePaperItems=!1},t.prototype.deleteAttachments=function(e){var t=null;if(e.length){var n=this.getFileSyncRecentItemsByAttachmentIds([e[0]])[0];if(n){var o=r.difference(n.attachmentIds,e);this.updateFileSyncItem(n,{attachmentIds:o}),t={deletedAttachmentIds:e,item:n},0===o.length&&this.removeFileSyncItem(n)}}return t},t.prototype.rollbackDelete=function(e){var t,n=this.fileSyncRecentItemIdToRecentItem[e.item.id];n?t=n.attachmentIds:(n=e.item,t=[]),this.updateFileSyncItem(n,{attachmentIds:r.uniq(t.concat.apply(t,e.deletedAttachmentIds))})},t.prototype.getCachedAttachmentIdToIdToFileSyncItem=function(){var e=this;return this.fileSyncCache.attachmentIdToIdToItem||(this.fileSyncCache.attachmentIdToIdToItem={},this.fileSyncCache.items.forEach(function(t){return t.attachmentIds.forEach(function(n){e.fileSyncCache.attachmentIdToIdToItem[n]?e.fileSyncCache.attachmentIdToIdToItem[n][t.id]=t:e.fileSyncCache.attachmentIdToIdToItem[n]=(r={},r[t.id]=t,r);var r})})),this.fileSyncCache.attachmentIdToIdToItem},t.prototype.getFileSyncRecentItemsByAttachmentIds=function(e){var t=this.getCachedAttachmentIdToIdToFileSyncItem(),n={};return e.forEach(function(e){t.hasOwnProperty(e)&&r.values(t[e]).forEach(function(e){return n[e.id]=e})}),r.values(n)},t.prototype.waitForAttachmentStoreDispatcher=function(){this.getDispatcher().waitFor([d.getAttachmentStore().getDispatchToken()])},t.prototype.updateFileSyncItem=function(e,t){this.addFileSyncItem(l.getMutatedOrOriginal(e,t))},t.prototype.onArchivePaperDocumentPending=function(e){this.paperActivityKeyToPendingArchiving[e]=!0},t.prototype.onArchivePaperDocumentCommit=function(e){this.deletePendingArchive(e),this.paperStream=this.paperStream.getStreamWithoutActivityKey(e),this.clearFederatedCache()},t.prototype.onArchivePaperDocumentRollback=function(e){this.deletePendingArchive(e)},t.prototype.deletePendingArchive=function(e){this.paperActivityKeyToPendingArchiving[e]&&delete this.paperActivityKeyToPendingArchiving[e]},t.prototype.onReceivePaperRecentItems=function(e,t,n){this.didRecievePaperItems=!0;var r=_.Viewer.get_viewer().get_user_by_id(n),o=e.map(function(e,t){return i.createRecentItemFromPaperRecentItem(e,r,t)});this.paperStream=new h.RecentActivityStream(o,t),p.waitForHomeTTI().then(function(t){return t.setStarredStatusOfPaperRecentItems(e)}),this.clearFederatedCache()},t.prototype.clearFederatedCache=function(){this.cachedFederatedRecentItems&&this.didReceiveItemsFromAllStreams()&&(this.__emitChange(),this.cachedFederatedRecentItems=null,this.cachedFederatedTruncatedRecentItems=null)},t.prototype.cacheTruncatedFederatedRecentItems=function(){this.cachedFederatedRecentItems?this.cachedFederatedTruncatedRecentItems=this.cachedFederatedRecentItems.slice(0,this.federatedRecentItemsCountMax):this.getRecentItems()},t.prototype.getFileSyncCursor=function(){return this.fileSyncCursor},t.prototype.canArchiveActivityKey=function(e){if(this.paperStream&&!this.paperActivityKeyToPendingArchiving[e]){var t=this.paperStream.getRecentItemByActivityKey(e);return!(!t||!t.federatedRecentItem.isArchiveable())}return!1},t.prototype.didReceiveItemsFromAllStreams=function(){return this.didRecievePaperItems&&this.didReceiveRawRecentActivities},t.prototype.getRecentItems=function(){if(null===this.cachedFederatedRecentItems){var e=[this.paperStream,new h.RecentActivityStream(this.getSortedFileSyncRecentItems(),!!this.fileSyncCursor)];this.cachedFederatedRecentItems=h.getMergedRecentItems(e),this.cacheTruncatedFederatedRecentItems()}return this.cachedFederatedTruncatedRecentItems},t.prototype.didTruncateRecentItems=function(){return!!(this.cachedFederatedRecentItems&&this.cachedFederatedTruncatedRecentItems&&this.cachedFederatedTruncatedRecentItems.length<this.cachedFederatedRecentItems.length)},t})(I.FluxStore);t.RecentActivityStore=y;var R=null;t.getRecentActivityStore=g}),define("modules/clean/react/home/recents/utils/events",["require","exports","external/react-dom","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/resource_id_types"],function(e,t,n,r,o,i){"use strict";function a(e,t,n,r,i){var a=m(e,t,n,r,i);return o.homeActivityLogger.logRecentsAction(a.actionTaken,a.scope,a.itemNumber,a.fileDetails.extension,a.sprite,a.subgroupPosition,a.fileDetails.idType,a.fileDetails.resourceId)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(e,t){return 1===e?r.ActionScope.SINGLE:t.length===e?r.ActionScope.AGGREGATION:r.ActionScope.SUBSET},s=function(e){var t=e.querySelector(".file-icon__img");return t&&t.textContent?t.textContent:"thumbnail"},l=function(e){return Array.prototype.indexOf.call(e.parentNode.childNodes,e)},d=function(e,t,n,o,a){if(e===r.ActionScope.AGGREGATION||n===r.ActionType.COLLAPSE||n===r.ActionType.UNCOLLAPSE)return{extension:"various"};for(var c=0,s=["paper","folder","project"];c<s.length;c++){var l=s[c];if(t.indexOf(l)>=0)return{extension:"n/a",idType:void 0,resourceId:void 0}}var d=o[a];if(!d)return{extension:"n/a"};var u=d.lastIndexOf(".");return{extension:u===-1?"":d.substr(u+1),idType:i.HOME_RESOURCE_ID_TYPE.FQ_PATH,resourceId:d}},u=function(e,t,n,o){return e===r.ActionScope.AGGREGATION?n.props.recentItem?0:t+1:e===r.ActionScope.SUBSET?o.classList.contains("recents-item")?0:1:0},m=function(e,t,r,o,i){var a=n.findDOMNode(t),m=c(o,r),h=s(a);return{actionTaken:e,scope:m,itemNumber:l(a),fileDetails:d(m,h,e,r,i||0),sprite:h,subgroupPosition:u(m,i||0,t,a)}};t.logEvent=a}),define("modules/clean/react/home/resource/store",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/constants","modules/clean/react/starred/constants","modules/clean/react/starred/id_type_pair","modules/clean/flux/flux_store"],function(e,t,n,r,o,i,a,c){"use strict";function s(){return null===d&&(d=new l),d}Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=e.call(this,r.Dispatcher)||this;return t.pendingPreviewResourceId=null,t.resourceIdToFile={},t.fileToPreview=null,t.resourceIdToEquivalentResourceId={},t}return n.__extends(t,e),t.prototype.getFileToPreview=function(){return this.fileToPreview},t.prototype.emitIfPendingFileExists=function(){if(null!==this.pendingPreviewResourceId){var e=this.resourceIdToEquivalentResourceId[this.pendingPreviewResourceId]||this.pendingPreviewResourceId;this.fileToPreview=this.resourceIdToFile[this.pendingPreviewResourceId]||this.resourceIdToFile[e]||null,null!==this.fileToPreview&&(this.pendingPreviewResourceId=null,this.__emitChange())}},t.prototype.onRequestPreview=function(e){this.pendingPreviewResourceId=e,this.emitIfPendingFileExists()},t.prototype.onReceivedResourceIdToFile=function(e){this.resourceIdToFile=n.__assign({},this.resourceIdToFile,e),this.emitIfPendingFileExists()},t.prototype.onStarredSetStatus=function(e){var t=this;e.forEach(function(e){if(e.canonicalIdTypePair){var n=a.idTypePairToString(e.idTypePair),r=a.idTypePairToString(e.canonicalIdTypePair);n!==r&&(t.resourceIdToEquivalentResourceId[r]=n,t.resourceIdToEquivalentResourceId[n]=r)}}),this.emitIfPendingFileExists()},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case o.HomeResourceStoreActionTypes.REQUEST_PREVIEW:this.onRequestPreview(t.resourceId);break;case o.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE:this.onReceivedResourceIdToFile(t.resourceIdToFile);break;case i.StarredActionTypes.SET_STATUS:this.onStarredSetStatus(t.starredStatuses)}},t})(c.FluxStore);t.HomeResourceStore=l;var d=null;t.getHomeResourceStore=s}),define("modules/clean/react/home/resource_id_types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.ENCODED_FILE_OBJ_ID="ENCODED_FILE_OBJ_ID",e.FQ_PATH="FQ_PATH",e.PAPER_DOCUMENT_ID="PAPER_DOCUMENT_ID",e.PAPER_FOLDER_ID="PAPER_FOLDER_ID",e.PAPER_DOCUMENT_ID_PATH="PAPER_DOCUMENT_ID_PATH",e.PAPER_FOLDER_ID_PATH="PAPER_FOLDER_ID_PATH",e.EXTERNAL_RESOURCE_ID="EXTERNAL_RESOURCE_ID",e.UNKNOWN="UNKNOWN"})(t.HOME_RESOURCE_ID_TYPE||(t.HOME_RESOURCE_ID_TYPE={}))}),define("modules/clean/react/home/roots/home_access_main",["require","exports","tslib","external/react","modules/clean/react/home/constants","modules/clean/react/home/recents/section","modules/clean/react/home/store","modules/clean/react/home/util/conditional_components","modules/clean/react/home/util/post_tti_components","modules/clean/react/home/post_tti/api"],function(e,t,n,r,o,i,a,c,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(t){var n=e.call(this,t)||this;return n.onHomeStoreUpdate=function(){return n.setState(n.getStateFromStore())},n.state=n.getStateFromStore(),n.removeStoreListeners=a.getHomeStore().addListener(n.onHomeStoreUpdate),n}return n.__extends(t,e),t.prototype.componentWillMount=function(){l.waitForHomeTTIWithProps().then(function(e){var t=e.props;return e.imports.initHomeOnboarding(t.onboardingData)})},t.prototype.componentWillUnmount=function(){this.removeStoreListeners&&this.removeStoreListeners()},t.prototype.getStateFromStore=function(){var e=a.getHomeStore();return{sectionVisibility:e.getSectionVisibility(),canRenderAllHomeSections:e.canRenderAllHomeSections()}},t.prototype.render=function(){var e=this.state,t=e.canRenderAllHomeSections,n=e.sectionVisibility,l=this.props.now;return t?r.createElement("div",{className:"home"},r.createElement("main",{className:"home-access",role:"main"},r.createElement("ul",{className:"home-access-sections",ref:"main"},r.createElement(s.PrototypePostTTICalendarSection,null),r.createElement(s.PostTTIHomeAccessBanner,null),r.createElement(c.ConditionalSuggestView,{isHiddenByUser:!n[o.HomeSections.SUGGEST]}),r.createElement(c.ConditionalHomeAccessUnread,{now:l}),r.createElement(c.ConditionalStarredView,null),r.createElement(i.HomeRecentsSection,{now:l,isHiddenByUser:!n[o.HomeSections.RECENTS],shouldMarkTTIIfOffScreen:a.getHomeStore().getPreTTIProps().shouldMarkRecentsTtiIfOffScreen})))):null},t.displayName="HomeAccessMain",t.defaultProps={showUnreadOnboarding:!1},t})(r.PureComponent);t.HomeAccessMain=d}),define("modules/clean/react/home/roots/home_access_web",["require","exports","tslib","external/react","modules/clean/flux/dispatcher","modules/clean/react/home/roots/home_access_main","modules/clean/react/home/roots/sidebar","modules/clean/react/home/resource/store","modules/clean/react/home/store","modules/clean/react/home/constants","modules/clean/react/home/util/logging/timing_logger","modules/clean/react/maestro/header","modules/clean/react/maestro/layout","modules/clean/react/home/post_tti/api","modules/clean/react/home/util/conditional_api","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/react/home/util/logging/availability_logger"],function(e,t,n,r,o,i,a,c,s,l,d,u,m,h,p,_,E,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){function t(n){var r=e.call(this,n)||this;r.intervalHandle=null,E.log_js_modules_application_code_start();var i=n.preTTIProps,a=n.initialRole,c=n.initialSectionVisibility,s=n.sectionToConditionalData,d=!!i,u=!0;return d||T.getHomeAvailabilityLogger().handlePrefetch(l.HomePrefetchTypes.PRE_TTI_PROPS,function(e){d=!0,u?i=e:(o.Dispatcher.dispatch({type:l.HomeActionTypes.INITIALIZE_STORE,payload:{preTTIProps:i}}),r.setState({canRender:d}))}),u=!1,t.initializeHomeStores(a,c,s,i),r.state={now:new Date,canRender:d},r}return n.__extends(t,e),t.initializeHomeStores=function(e,t,n,r){d.homeTimingLogger.activate(),s.getHomeStore(),o.Dispatcher.dispatch({type:l.HomeActionTypes.INITIALIZE_STORE,payload:{role:e,sectionVisibility:t,preTTIProps:r,sectionToConditionalData:n}}),d.homeTimingLogger.logSkippedSection(l.HomeSections.MAIN),c.getHomeResourceStore(),p.waitForStarred(function(e){return e.getStarredResourceStore()})},t.prototype.componentDidMount=function(){var e=this;h.waitForHomeTTIWithProps().then(function(t){var n=t.imports,r=t.props;e.setState({searchBarExperiments:r.searchBarExperiments}),e.intervalHandle=setInterval(function(){return e.setState({now:new Date})},6e4),n.homeAccessWebComponentDidMount(r.renderSnapEngage)})},t.prototype.componentWillUnmount=function(){null!=this.intervalHandle&&clearInterval(this.intervalHandle)},t.prototype.render=function(){var e=this.state,t=e.searchBarExperiments,n=e.now;return e.canRender?r.createElement(m.MaestroChrome,{user:s.getUser(),embeddedAppRegion:r.createElement(i.HomeAccessMain,{now:n}),titleRegion:r.createElement(u.MaestroHeaderTitle,null,_._("Home")),actionSidebarRegion:r.createElement(a.HomeSidebar,null),searchBarProps:{searchBarExperiments:t}}):null},t.displayName="HomeAccessWeb",t})(r.PureComponent);t.HomeAccessWeb=f}),define("modules/clean/react/home/roots/sidebar",["require","exports","tslib","modules/clean/ajax","modules/core/browser","external/react","modules/core/i18n","external/lodash","modules/clean/react/app_actions_view","modules/clean/react/file_uploader/file_uploader","modules/clean/react/home/actions","modules/clean/react/home/post_tti/api","modules/clean/react/home/constants","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/recents/actions/recent_activity_actions","modules/clean/sharing/wizard/async_wizard_modals","modules/clean/react/home/store"],function(e,t,n,r,o,i,a,c,s,l,d,u,m,h,p,_,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=(function(e){function t(t){var i=e.call(this,t)||this;i.handleUploadFiles=function(){l.FileUploaderController.handleUploadButtonClick(!1),h.homeActivityLogger.logClickRightMenu(m.LoggingTypes.CLICK_UPLOAD_FILES)},i.handleUploadFolder=function(){l.FileUploaderController.handleUploadButtonClick(!0)},i.handleCreateSharedFolder=function(){return n.__awaiter(i,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return"V1"!==this.state.expSubgrowthProOQNewFolder?[3,2]:[4,u.waitForHomeTTI()];case 1:return e.sent().experimentalHandleCreateSharedFolder("V1"),h.homeActivityLogger.logClickRightMenu(m.LoggingTypes.CLICK_NEW_SHARED_FOLDER),[3,4];case 2:return _.asyncShowShareAFolderWizardModal(E.getUser(),function(e){h.homeActivityLogger.logClickRightMenu(m.LoggingTypes.CLICK_NEW_SHARED_FOLDER,e)}),"CONTROL"!==this.state.expSubgrowthProOQNewFolder?[3,4]:[4,u.waitForHomeTTI()];case 3:e.sent().experimentalHandleCreateSharedFolder("CONTROL"),e.label=4;case 4:return[2]}})})},i.handleCreatePaperDoc=function(){i.state.isPaperEnabledForUser?d.HomeActions.createPaperDocInNewTab(E.getUserId()):o.redirect("/paper"),h.homeActivityLogger.logClickRightMenu(m.LoggingTypes.CLICK_CREATE_PAPER_DOC)},i.handleCreateBrainstorm=function(){i.signInAndCreateDoc(m.PaperTemplateTypes.BRAINSTORM)},i.handleCreateMeetingNotes=function(){i.signInAndCreateDoc(m.PaperTemplateTypes.MEETING_NOTES)},i.handleCreateProjectPlan=function(){i.signInAndCreateDoc(m.PaperTemplateTypes.PROJECT_PLAN)},i.signInAndCreateDoc=function(e){if(void 0===e&&(e=""),i.state.isPaperEnabledForUser)i.createPaperDocFromTemplate(e);else{var t=function(){i.createPaperDocFromTemplate(e)};"work"===E.getRole()?i.activateAndSignInToPaper(t):i.signInToPaper(t)}},i.activateAndSignInToPaper=function(e){r.WebRequest({url:"/team/activate_paper",data:{tos_agree:!0,notes_enabled_policy:"yes",team_id:E.getUser().team_dbtid},success:function(t){i.signInToPaper(e)}})},i.signInToPaper=function(e){i.state.isPaperEnabledForUser?e():r.WebRequest({url:"/paper/continue_from_landing_page",success:function(t){e()}})},i.createPaperDocFromTemplate=function(e){void 0===e&&(e=""),d.HomeActions.createPaperDocFromTemplateInNewTab(e),i.logForDocType(e)},i.onFileUploadComplete=c.throttle(p.refreshRecentItems,3500,{leading:!1,trailing:!0});var a=E.getHomeStore().getPreTTIProps(),s=a.isPaperEnabledForUser,T=a.paperLinksVariant,f=a.uploaderExperiments;return i.state={expSubgrowthProOQNewFolder:"OFF",isPaperEnabledForUser:s,paperLinksVariant:T,uploaderExperiments:f},i}return n.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;l.FileUploaderController.setUser(E.getUser()),u.waitForHomeTTI().then(function(){return n.__awaiter(e,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return l.FileUploaderController.loadCoreComponent(),[4,u.waitForHomeTTI()];case 1:return[4,t.sent().experimentalGetVariantSubgrowthProOQNewFolder()];case 2:return e=t.sent(),this.setState({expSubgrowthProOQNewFolder:e.toString()}),[2]}})})})},t.prototype.logForDocType=function(e){switch(void 0===e&&(e=""),e){case m.PaperTemplateTypes.BRAINSTORM:h.homeActivityLogger.logClickRightMenu(m.LoggingTypes.CLICK_CREATE_BRAINSTORM_DOC);break;case m.PaperTemplateTypes.MEETING_NOTES:h.homeActivityLogger.logClickRightMenu(m.LoggingTypes.CLICK_CREATE_MEETING_NOTES_DOC);break;case m.PaperTemplateTypes.PROJECT_PLAN:h.homeActivityLogger.logClickRightMenu(m.LoggingTypes.CLICK_CREATE_PROJECT_PLAN_DOC)}},t.prototype.shouldVariantShowCreateDocLink=function(){return"V0"===this.state.paperLinksVariant||"V2"===this.state.paperLinksVariant},t.prototype.getPaperLinkDocTypes=function(){switch(this.state.paperLinksVariant){case m.PaperSidebarLinkVariants.V1:case m.PaperSidebarLinkVariants.V2:return[m.PaperTemplateTypes.BRAINSTORM,m.PaperTemplateTypes.MEETING_NOTES,m.PaperTemplateTypes.PROJECT_PLAN];case m.PaperSidebarLinkVariants.V0:default:return[]}},t.prototype.getPath=function(){var e=E.getUser(),t=e.is_cdm_member,n=e.cdm_tmf_path;return t?n:"/"},t.prototype.render=function(){var e=[{displayName:a._("New shared folder"),iconName:"new-shared-folder",className:"action-new-shared-folder",handleClick:this.handleCreateSharedFolder}];this.state.isPaperEnabledForUser?e.push({displayName:a._("Create Paper doc"),iconName:"new-paper-doc",className:"action-new-paper-doc",handleClick:this.handleCreatePaperDoc}):this.shouldVariantShowCreateDocLink()&&e.push({displayName:a._("Create Paper doc"),iconName:"new-paper-doc",className:"action-new-paper-doc",handleClick:this.handleCreatePaperDoc});for(var t=this.getPaperLinkDocTypes(),n=0,r=t;n<r.length;n++){switch(r[n]){case m.PaperTemplateTypes.BRAINSTORM:e.push({displayName:a._("Start a brainstorm"),iconName:"brainstorm",className:"action-new-paper-doc",handleClick:this.handleCreateBrainstorm});break;case m.PaperTemplateTypes.MEETING_NOTES:e.push({displayName:a._("Create meeting notes"),iconName:"new-meeting-note",className:"action-new-paper-doc",handleClick:this.handleCreateMeetingNotes});break;case m.PaperTemplateTypes.PROJECT_PLAN:e.push({displayName:a._("Plan your project"),iconName:"select",className:"action-new-paper-doc",handleClick:this.handleCreateProjectPlan})}}var c=!!this.state.uploaderExperiments.expFolderUploadAction&&o.is_input_webkitdirectory_supported(),d=c?{displayName:a._("Upload"),subItems:[{displayName:a._("Upload files"),popoverMenuName:a._("Files"),handleClick:this.handleUploadFiles,className:"action-upload-files",iconName:"upload-file"},{displayName:a._("Upload folder"),popoverMenuName:a._("Folder"),handleClick:this.handleUploadFolder,className:"action-upload-folder",iconName:"upload-folder"}]}:{displayName:a._("Upload files"),handleClick:this.handleUploadFiles};return i.createElement("div",{className:"home-access-sidebar"},i.createElement(l.FileUploaderController,{loadOnRender:!1,needToSetStoreValues:!0,chooseDestination:!0,dragAndDropEnabled:!0,initialPermission:!0,initialPath:this.getPath(),onFileUploadComplete:this.onFileUploadComplete,uploaderExperiments:this.state.uploaderExperiments}),i.createElement(s.AppActionsView,{responsive:this.props.responsive,primaryMenuItem:{displayName:d.displayName,handleClick:d.handleClick,className:"action-upload",iconName:"upload",subItems:d.subItems},secondaryMenuItems:e}))},t})(i.PureComponent);t.HomeSidebar=T}),define("modules/clean/react/home/section_header",["require","exports","tslib","external/react","modules/clean/user_education/react/user_education_effect"],function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderButton=function(){return this.props.buttonText&&this.props.buttonAction?r.createElement("div",{className:"home-section-header__button"},r.createElement("button",{className:"button-as-link",onClick:this.props.buttonAction},this.props.buttonText)):null},t.prototype.render=function(){return r.createElement("h2",{className:"home-access-section__header"},r.createElement("div",{className:"home-access-section__title"},r.createElement("div",{className:"home-access-section__title-text"},r.createElement(o.UserEducationEffect,{containerName:"home-section-header",name:this.props.ueName
},this.props.title))),this.renderButton())},t.displayName="SectionHeader",t})(r.PureComponent);t.SectionHeader=i}),define("modules/clean/react/home/starred/starred_empty_state",["require","exports","external/react","modules/core/i18n","spectrum/tip_card","modules/clean/react/home/section_header"],function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredHeader=function(){return n.createElement(i.SectionHeader,{title:r._("Starred",{comment:"Home's starred section"}),ueName:"starred"})},t.StarredEmptyState=function(){return n.createElement("div",{className:"starred--empty"},n.createElement(o.TipCard,null,r._("When you star items, they’ll show up here for easy access.")+" ",n.createElement("a",{href:"/help/desktop-web/star-doc-file-folder",target:"_blank",rel:"noopener noreferrer"},r._("Learn more"))))},t.StarredEmptyStateWithHeader=function(){return n.createElement("li",{className:"home-access-section"},n.createElement("div",{className:"starred"},n.createElement(t.StarredHeader,null),n.createElement(t.StarredEmptyState,null)))}}),define("modules/clean/react/home/store",["require","exports","tslib","modules/clean/flux/dispatcher","external/lodash","modules/clean/flux/flux_store","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/home/constants","modules/clean/viewer","modules/core/exception"],function(e,t,n,r,o,i,a,c,s,l){"use strict";function d(){return null===f&&(f=new T),f}function u(){return d().getUser()}function m(){return u().id}function h(){return u().role}function p(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function _(e){return!!I[e]}function E(e){return _(e)}Object.defineProperty(t,"__esModule",{value:!0});var T=(function(e){function t(){var t=e.call(this,r.Dispatcher)||this;return t.thumbStore=new a.GenericThumbStore,t.sectionToDidLoadSynchronously={},t.sectionToPendingCallbacks={},t.preTTIProps=c.DEFAULT_PRE_TTI_PROPS,t}return n.__extends(t,e),t.prototype.getRole=function(){return this.role},t.prototype.getUser=function(){return this.user},t.prototype.getThumbStore=function(){return this.thumbStore},t.prototype.getSectionVisibility=function(){return this.sectionVisibility},t.prototype.getPreTTIProps=function(){return this.preTTIProps},t.prototype.getActiveVariants=function(){return this.preTTIProps.activeVariants},t.prototype.getActiveVariant=function(e){return this.getActiveVariants()[e]},t.prototype.executeWhenSectionIsReady=function(e,t,n){var r=this.getSectionLoadingPreference(e);return r===c.ConditionalSectionLoadingPreference.DO_NOT_LOAD?null:r===c.ConditionalSectionLoadingPreference.IMMEDIATE||this.getSectionLoadingMode(e)!==c.ConditionalSectionLoadingMode.UNKNOWN?n(!0):(t&&(this.sectionToPendingCallbacks[e]?this.sectionToPendingCallbacks[e].push(n):this.sectionToPendingCallbacks[e]=[n]),null)},t.prototype.getSectionLoadingPreference=function(e){if(this.sectionToExtendedConditionalData){var t=this.sectionToExtendedConditionalData[e];return t?t.isPostTTI?c.ConditionalSectionLoadingPreference.POST_TTI:c.ConditionalSectionLoadingPreference.IMMEDIATE:c.ConditionalSectionLoadingPreference.DO_NOT_LOAD}return this.role?c.ConditionalSectionLoadingPreference.IMMEDIATE:c.ConditionalSectionLoadingPreference.UNKNOWN},t.prototype.getSectionLoadingMode=function(e){if(this.sectionToExtendedConditionalData){if(this.sectionToExtendedConditionalData[e])return this.sectionToExtendedConditionalData[e].loadingMode}else if(this.role)return c.ConditionalSectionLoadingMode.SYNCHRONOUS;return c.ConditionalSectionLoadingMode.UNKNOWN},t.prototype.canRenderAllHomeSections=function(){return this.sectionToExtendedConditionalData?o.values(this.sectionToExtendedConditionalData).every(function(e){return!e.isBlocking||(!!e.isPostTTI||e.loadingMode!==c.ConditionalSectionLoadingMode.UNKNOWN)}):(this.role||l.reportStack("Called canRenderAllHomeSections before initialization",{severity:l.SEVERITY.NONCRITICAL}),!0)},t.prototype.setSectionVisibility=function(e){var t=e.section,r=e.visible;this.sectionVisibility[t]!==r&&(this.sectionVisibility=n.__assign({},this.sectionVisibility,(o={},o[t]=r,o)));var o},t.prototype.setSectionLoadingMode=function(e,t){var r=this.getExtendedConditionalData(e);r&&(this.sectionToExtendedConditionalData[e]=n.__assign({},r,{loadingMode:t}))},t.prototype.getExtendedConditionalData=function(e){return this.sectionToExtendedConditionalData&&this.sectionToExtendedConditionalData[e]},t.prototype.onSetPreTIProps=function(e){var t=e.preTTIProps;this.preTTIProps=t},t.prototype.onInitializeStore=function(e){var t=this,r=e.role,i=e.sectionVisibility,a=e.preTTIProps,d=e.sectionToConditionalData;this.role=r,this.sectionVisibility=i,this.user=s.Viewer.get_viewer().get_user_by_role(r),l.assert(!!this.user,"Could not find user for role "+r),this.preTTIProps=a||this.preTTIProps,this.sectionToExtendedConditionalData=o.mapValues(d,function(e,t){return n.__assign({},e,{loadingMode:c.ConditionalSectionLoadingMode.UNKNOWN,isBlocking:E(t)})}),Object.keys(this.sectionToDidLoadSynchronously).forEach(function(e){(0,t.sectionToDidLoadSynchronously[e])(t.getSectionLoadingPreference(e))&&t.setSectionLoadingMode(e,c.ConditionalSectionLoadingMode.SYNCHRONOUS)}),this.sectionToDidLoadSynchronously={}},t.prototype.onDeclareConditionalSection=function(e){var t=e.section,n=e.didInitializeSynchronously;this.sectionToExtendedConditionalData?l.reportStack("declared conditional section too late",{severity:l.SEVERITY.CRITICAL,exc_extra:{section:t}}):this.sectionToDidLoadSynchronously[t]?l.reportStack("Re-declared a conditional section",{severity:l.SEVERITY.CRITICAL,exc_extra:{section:t}}):this.sectionToDidLoadSynchronously[t]=n},t.prototype.onLoadedAsyncConditionalSection=function(e){var t=e.section,n=this.getExtendedConditionalData(t);n&&this.setSectionLoadingMode(t,n.isPostTTI?c.ConditionalSectionLoadingMode.POST_TTI:c.ConditionalSectionLoadingMode.ASYNCHRONOUS_PRE_TTI),(this.sectionToPendingCallbacks[t]||[]).forEach(function(e){return e(!1)}),this.sectionToPendingCallbacks[t]=[]},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case c.HomeActionTypes.SET_PRE_TTI_PROPS:this.onSetPreTIProps(t.payload),this.__emitChange();break;case c.HomeActionTypes.INITIALIZE_STORE:this.onInitializeStore(t.payload),this.__emitChange();break;case c.HomeActionTypes.SET_SECTION_VISIBILITY:this.setSectionVisibility(t.payload),this.__emitChange();break;case c.HomeActionTypes.DECLARE_CONDITIONAL_SECTION:this.onDeclareConditionalSection(t.payload),this.__emitChange();break;case c.HomeActionTypes.LOADED_ASYNC_CONDITIONAL_SECTION:this.onLoadedAsyncConditionalSection(t.payload),this.__emitChange()}},t})(i.FluxStore);t.PrivateHomeStoreClass=T;var f=null;t.getHomeStore=d,t.getUser=u,t.getUserId=m,t.getRole=h;var I=p(c.HomeSections);t.isHomeSection=_,t.isBlockingSection=E}),define("modules/clean/react/home/util/conditional",["require","exports","tslib","external/react","modules/clean/react/async/loadable","modules/clean/react/home/post_tti/api","modules/clean/react/home/store","modules/clean/react/home/constants","modules/clean/react/home/util/logging/timing_logger","modules/core/exception","modules/clean/flux/dispatcher"],function(e,t,n,r,o,i,a,c,s,l,d){"use strict";function u(e){var u=this,m=e.section,h=e.syncLoader,p=e.asyncLoader,_=e.loading,E=null,T=c.ConditionalSectionLoadingPreference.UNKNOWN,f=function(e){if(T=e,e===c.ConditionalSectionLoadingPreference.UNKNOWN)return!1;if(e===c.ConditionalSectionLoadingPreference.DO_NOT_LOAD)return a.isHomeSection(m)&&s.homeTimingLogger.logSkippedSection(m),!1;var t=e===c.ConditionalSectionLoadingPreference.POST_TTI;if(t)a.isHomeSection(m)&&s.homeTimingLogger.logSkippedSection(m);else{try{E=h()}catch(e){}if(E)return!0}var r=!t&&a.isBlockingSection(m),l=function(){return n.__awaiter(u,void 0,void 0,function(){var e;return n.__generator(this,function(n){switch(n.label){case 0:return t?[4,i.waitForHomeTTI()]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,p()];case 3:return e=n.sent(),r&&(E=e),d.Dispatcher.dispatch({type:c.HomeActionTypes.LOADED_ASYNC_CONDITIONAL_SECTION,payload:{section:m}}),[2,e]}})})};return r?l():E=o.Loadable({loader:l,loading:_}),!1};return a.getHomeStore(),d.Dispatcher.dispatch({type:c.HomeActionTypes.DECLARE_CONDITIONAL_SECTION,payload:{section:m,didInitializeSynchronously:f}}),function(e){return(T===c.ConditionalSectionLoadingPreference.UNKNOWN||!E&&T!==c.ConditionalSectionLoadingPreference.DO_NOT_LOAD&&a.isBlockingSection(m)&&t.IS_PROD)&&l.reportStack("Premature render",{severity:l.SEVERITY.CRITICAL,exc_extra:{section:m,loadingPreference:T,isBlockingSection:a.isBlockingSection(m)}}),E?r.createElement(E,n.__assign({},e)):r.createElement("div",null)}}Object.defineProperty(t,"__esModule",{value:!0}),t.IS_PROD=!0,t.homeConditionalSection=u}),define("modules/clean/react/home/util/conditional_api",["require","exports","modules/clean/react/home/store","modules/clean/react/home/constants"],function(e,t,n,r){"use strict";function o(e,r,o,i,a){return void 0===r&&(r=!0),t.sectionToConditionalInterface[o]?e(t.sectionToConditionalInterface[o]):n.getHomeStore().executeWhenSectionIsReady(o,r,function(n){if(n&&!t.sectionToConditionalInterface[o])try{t.sectionToConditionalInterface[o]=i()}catch(e){}return t.sectionToConditionalInterface[o]?e(t.sectionToConditionalInterface[o]):(r&&a().then(function(n){t.sectionToConditionalInterface[o]=n,e(n)}),null)})}function i(t,n){return void 0===n&&(n=!0),o(t,n,r.HomeSections.STARRED,function(){return e("modules/clean/react/home/starred/conditional_interface")},function(){return new Promise(function(t,n){e(["modules/clean/react/home/starred/conditional_interface"],t,n)})})}Object.defineProperty(t,"__esModule",{value:!0}),t.sectionToConditionalInterface={},t.waitForSection=o,t.waitForStarred=i}),define("modules/clean/react/home/util/conditional_components",["require","exports","external/react","modules/clean/react/home/constants","modules/clean/react/home/util/conditional","modules/clean/react/home/starred/starred_empty_state"],function(e,t,n,r,o,i){"use strict";function a(e){return e&&e.HomeAccessUnread}function c(e){return e&&e.StarredView}function s(e){return e&&e.HomeSuggest}Object.defineProperty(t,"__esModule",{value:!0}),t.ConditionalHomeAccessUnread=o.homeConditionalSection({section:r.HomeSections.UNREAD,syncLoader:function(){return a(e("modules/clean/react/home/unread/home_access_unread"))},asyncLoader:function(){return new Promise(function(t,n){e(["modules/clean/react/home/unread/home_access_unread"],t,n)}).then(function(e){return a(e)})}}),t.ConditionalStarredView=o.homeConditionalSection({section:r.HomeSections.STARRED,syncLoader:function(){return c(e("modules/clean/react/home/starred/conditional_interface"))},asyncLoader:function(){return new Promise(function(t,n){e(["modules/clean/react/home/starred/conditional_interface"],t,n)}).then(function(e){return c(e)})},loading:n.createElement(i.StarredEmptyStateWithHeader,null)}),t.ConditionalSuggestView=o.homeConditionalSection({section:r.HomeSections.SUGGEST,syncLoader:function(){return s(e("modules/clean/react/home/experiments/home_suggest_grid/home_suggest"))},asyncLoader:function(){return new Promise(function(t,n){e(["modules/clean/react/home/experiments/home_suggest_grid/home_suggest"],t,n)}).then(function(e){return s(e)})}})}),define("modules/clean/react/home/util/logging/activity_logger",["require","exports","modules/clean/react/home/api","modules/clean/react/home/store","modules/clean/react/home/constants"],function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}return e.prototype.logClickShowAll=function(e,t){return n.logHomeActivity({eventName:o.LoggingTypes.CLICK_SHOW_ALL,role:r.getHomeStore().getRole(),extra:{component_name:e,should_show_all:t}})},e.prototype.logHomePageShown=function(){return n.logHomeActivity({eventName:o.LoggingTypes.HOME_PAGE_SHOWN,role:r.getHomeStore().getRole(),extra:{}})},e.prototype.logStarredShown=function(e,t,i){return n.logHomeActivity({eventName:o.LoggingTypes.STARRED_SHOWN,role:r.getHomeStore().getRole(),extra:{num_items:e,is_hidden:!1,has_hidden_rows:t,has_more:i}})},e.prototype.logRecentsShown=function(e,t){return n.logHomeActivity({eventName:o.LoggingTypes.RECENTS_SHOWN,role:r.getHomeStore().getRole(),extra:{num_items:e,is_hidden:t}})},e.prototype.logShowHideSection=function(e,t){return n.logHomeActivity({eventName:t?o.LoggingTypes.HIDE_SECTION:o.LoggingTypes.UNHIDE_SECTION,role:r.getHomeStore().getRole(),extra:{section_name:e}})},e.prototype.logRecentsAction=function(e,t,i,a,c,s,l,d){var u={action_taken:e,scope:t,item_number:i,extension:a,sprite:c,subgroup_position:s};return l&&d&&(u.id_type=l,u.resource_id=d),n.logHomeActivity({eventName:o.LoggingTypes.RECENTS_ITEM_ACTION,role:r.getHomeStore().getRole(),extra:u})},e.prototype.logOpenStarredItem=function(e,t,i,a){return n.logHomeActivity({eventName:o.LoggingTypes.OPEN_STARRED_ITEM,role:r.getHomeStore().getRole(),extra:{resource_id:e,resource_type:t,position:a}})},e.prototype.logUndoUnstarItem=function(e,t,i,a){return n.logHomeActivity({eventName:o.LoggingTypes.UNDO_UNSTAR_ITEM,role:r.getHomeStore().getRole(),extra:{resource_id:e,resource_type:t,position:a}})},e.prototype.logClickStarOverflowMenu=function(e,t,i,a){return n.logHomeActivity({eventName:o.LoggingTypes.CLICK_STAR_OVERFLOW_MENU,role:r.getHomeStore().getRole(),extra:{resource_id:e,resource_type:t,position:a}})},e.prototype.logClickStarOverflowShare=function(e,t,i,a){return n.logHomeActivity({eventName:o.LoggingTypes.CLICK_STAR_OVERFLOW_SHARE,role:r.getHomeStore().getRole(),extra:{resource_id:e,resource_type:t,position:a}})},e.prototype.logClickRightMenu=function(e,t){var o=t?{modalSessionId:t}:{};return n.logHomeActivity({eventName:e,role:r.getHomeStore().getRole(),extra:o})},e.prototype.logViewUploadedFiles=function(e,t){return n.logHomeActivity({eventName:o.LoggingTypes.VIEW_UPLOADED_FILES,role:r.getHomeStore().getRole(),extra:{num_items:e,num_selected_items:t}})},e})();t.HomeActivityLogger=i,t.homeActivityLogger=new i}),define("modules/clean/react/home/util/logging/availability_logger",["require","exports","external/lodash","modules/clean/web_timing_logger","modules/clean/react/home/store","modules/core/exception","modules/clean/react/home/util/prefetch_handler","modules/clean/react/home/util/logging/availability_logger_common","modules/clean/react/home/post_tti/api"],function(e,t,n,r,o,i,a,c,s){"use strict";function l(){return u=u||new d}Object.defineProperty(t,"__esModule",{value:!0});var d=(function(){function e(){this.didLog=!1,this.sectionToTTData={},this.sectionToTTI={},this.sectionToIsSkipped={},this.typeToExecutionData=n.mapValues(c.HOME_PREFETCH_TYPE_TO_INFO,function(e){return{info:e,homeTiming:{}}})}return e.prototype.logPrefetch=function(e,t){var n=this.typeToExecutionData[e];void 0===n.success&&(n.success=t,this.pendingPrefetchesCount&&this.pendingPrefetchesCount--,this.logIfPossible())},e.prototype.logIfPossible=function(){var e=this;!this.didLog&&void 0!==this.pendingPrefetchesCount&&this.pendingPrefetchesCount<=0&&(s.waitForHomeTTI().then(function(t){return(0,t.logHomeAvailability)({typeToExecutionData:e.typeToExecutionData,sectionToTTData:e.sectionToTTData,sectionToTTI:e.sectionToTTI,sectionToIsSkipped:e.sectionToIsSkipped})}),this.didLog=!0)},e.prototype.logTTData=function(e){this.sectionToTTData.hasOwnProperty(e)||(this.sectionToTTData[e]=r.time_since_start(),this.logIfPossible())},e.prototype.logTTI=function(e,t,i){var a=this;if(!this.sectionToTTI.hasOwnProperty(e)&&(this.sectionToTTI[e]=r.time_since_start(),this.sectionToIsSkipped[e]=Number(t),i)){this.pendingPrefetchesCount=0;var s=o.getHomeStore();n.map(this.typeToExecutionData,function(e){c.isPendingPrefetch(s,e)&&a.pendingPrefetchesCount++}),this.logIfPossible()}},e.prototype.handlePrefetch=function(e,t){var o=this,s=c.HOME_PREFETCH_TYPE_TO_INFO[e].handle,l=a.getPrefetchHandler(s),d=this.typeToExecutionData[e],u=d.homeTiming,m=d.didInvoke,h=function(t){i.reportStack("prefetch for "+e+" failed",{severity:i.SEVERITY.CRITICAL,exc_extra:{error:t,type:e}}),o.logPrefetch(e,!1)};if(l){if(!m){d.didInvoke=!0,u.register_prefetch_callback=r.time_since_start();var p=function(i){try{u.json_parse_start=r.time_since_start();var a=JSON.parse(i);u.json_parse_end=r.time_since_start(),u.json_string_size=16*i.length,n.isEqual(a,{})?h("payload is {}"):(o.logPrefetch(e,!0),u.payload_processing_start=r.time_since_start(),t(a),u.payload_processing_end=r.time_since_start())}catch(e){h(e)}};u.asynchronous=a.handlePrefetch(l,p,h)?0:1}}else h("no prefetch handler")},e})();t.HomeAvailabilityLogger=d;var u=null;t.getHomeAvailabilityLogger=l}),define("modules/clean/react/home/util/logging/availability_logger_common",["require","exports","modules/clean/react/home/constants"],function(e,t,n){"use strict";function r(e,t){var n=t.success,r=t.info;return void 0===n&&(!r.isOptional||o.indexOf(e.getSectionLoadingPreference(r.conditionalSection))>=0)}Object.defineProperty(t,"__esModule",{value:!0});var o=[n.ConditionalSectionLoadingPreference.IMMEDIATE,n.ConditionalSectionLoadingPreference.POST_TTI];t.HOME_PREFETCH_TYPE_TO_INFO=(i={},i[n.HomePrefetchTypes.RETRIEVE_STARRED]={fragment:"retrieve_starred",handle:"__REGISTER_RETRIEVE_STARRED_PRELOAD_HANDLER",section:n.HomeSections.STARRED,conditionalSection:n.HomeSections.STARRED},i[n.HomePrefetchTypes.RECENTS_JSON]={fragment:"recents/json",handle:"__REGISTER_RECENTS_PRELOAD_HANDLER",section:n.HomeSections.RECENTS,conditionalSection:n.HomeSections.RECENTS},i[n.HomePrefetchTypes.RETRIEVE_PAPER_RECENTS]={fragment:"retrieve_paper_recents",handle:"__REGISTER_PAPER_RECENTS_PRELOAD_HANDLER",section:n.HomeSections.RECENTS,conditionalSection:n.ConditionalSections.PAPER_RECENTS},i[n.HomePrefetchTypes.RETRIEVE_UNREAD]={fragment:"retrieve_unread",handle:"__REGISTER_UNREAD_PREFETCH_HANDLER",section:n.HomeSections.UNREAD,conditionalSection:n.HomeSections.UNREAD},i[n.HomePrefetchTypes.PRE_TTI_PROPS]={fragment:"pre_tti_props",handle:"__REGISTER_PRE_TTI_PROPS_PREFETCH_HANDLER",section:n.HomeSections.MAIN,conditionalSection:n.HomeSections.MAIN,isOptional:!0},i[n.HomePrefetchTypes.GET_SUGGESTED]={fragment:"get_suggested",handle:"__REGISTER_SUGGEST_GRID_PRELOAD_HANDLER",section:n.HomeSections.SUGGEST,conditionalSection:n.HomeSections.SUGGEST,isOptional:!0},i),t.isPendingPrefetch=r;var i}),define("modules/clean/react/home/util/logging/timing_component",["require","exports","tslib","external/react","external/react-dom","modules/clean/react/home/util/logging/timing_logger"],function(e,t,n,r,o,i){"use strict";function a(e,t){return(function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return n.__extends(c,a),c.prototype.isWrappedComponentBelowViewport=function(){var e=this.refs.wrapped;if(e){var t=o.findDOMNode(e);return t&&document.documentElement.scrollTop+window.innerHeight>t.getBoundingClientRect().top}return!1},c.prototype.componentDidMount=function(){!i.homeTimingLogger.logTTI(t)&&this.props.shouldMarkTTIIfOffScreen&&this.isWrappedComponentBelowViewport()&&i.homeTimingLogger.logSkippedSection(t);var e=this.refs.wrapped,n=e.componentDidUpdate;e.componentDidUpdate=function(){i.homeTimingLogger.logTTI(t),n&&n.call(e)}},c.prototype.render=function(){return r.createElement(e,n.__assign({ref:"wrapped"},this.props))},c})(r.PureComponent)}Object.defineProperty(t,"__esModule",{value:!0}),t.timingComponent=a}),define("modules/clean/react/home/util/logging/timing_logger",["require","exports","modules/clean/js_client_stopwatch","external/lodash","modules/clean/web_timing_logger","modules/clean/react/home/util/logging/timing_state","modules/clean/react/home/util/logging/activity_logger","modules/core/exception","modules/clean/react/home/util/logging/availability_logger"],function(e,t,n,r,o,i,a,c,s){"use strict";function l(e){return"home_"+e}Object.defineProperty(t,"__esModule",{value:!0});var d=r.once(a.homeActivityLogger.logHomePageShown),u=(function(){function e(){this.timingStates=new i.HomeTimingStates,this.activate=r.once(function(){return n.JSStopwatch.create_stopwatch_if_not_exist("home_access_tti")})}return e.prototype.validateActivated=function(e,t){return!!n.JSStopwatch.stopwatch_exists("home_access_tti")||(c.reportStack("Did not activate when "+e+" before logging "+t,{severity:c.SEVERITY.NONCRITICAL}),!1)},e.prototype.logTTData=function(e){if(this.validateActivated(e,i.HomeTimingState.TTDATA)){if(this.timingStates.progressState(e,i.HomeTimingState.TTDATA))return this.timingStates.haveAllSectionsReachedState(i.HomeTimingState.TTDATA)&&o.log_js_modules_fetched_data_required_for_tti(),s.getHomeAvailabilityLogger().logTTData(e),!0}return!1},e.prototype.logSkippedSection=function(e){this.activate(),this.logTTData(e),this.logTTI(e,!0)},e.prototype.logTTI=function(e,t){if(void 0===t&&(t=!1),this.validateActivated(e,i.HomeTimingState.TTI)){if(this.timingStates.progressState(e,i.HomeTimingState.TTI)){d(),n.JSStopwatch.recordTrace(l(e),{stopwatchName:"home_access_tti"});var r=this.timingStates.haveAllSectionsReachedState(i.HomeTimingState.TTI);return r&&(o.mark_time_to_interactive(),n.JSStopwatch.flush_current_data()),s.getHomeAvailabilityLogger().logTTI(e,t,r),!0}}return!1},e})();t._HomeTimingLogger=u,t.homeTimingLogger=new u,t.withHomePrefix=l}),define("modules/clean/react/home/util/logging/timing_state",["require","exports","external/lodash","modules/clean/react/home/constants"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;(function(e){e[e.INIT=0]="INIT",e[e.TTDATA=1]="TTDATA",e[e.TTI=2]="TTI"})(o=t.HomeTimingState||(t.HomeTimingState={}));var i=(function(){function e(){var e=this;this.homeSectionToState={},n.values(r.HomeSections).forEach(function(t){return e.homeSectionToState[t]=o.INIT})}return e.prototype.progressState=function(e,t){return this.homeSectionToState[e]+1===t&&(this.homeSectionToState[e]=t,!0)},e.prototype.haveAllSectionsReachedState=function(e){return n.every(this.homeSectionToState,function(t){return t>=e})},e})();t.HomeTimingStates=i}),define("modules/clean/react/home/util/navigation",["require","exports","modules/core/browser"],function(e,t,n){"use strict";function r(e){return e.metaKey||e.ctrlKey}function o(e){return r(e)?a.NEW_TAB:a.REDIRECT}function i(e,t,r){switch(void 0===r&&(r=a.NEW_TAB),r){case a.REDIRECT:return void(t?t().then(function(){return n.redirect(e)}):n.redirect(e));case a.NEW_TAB:n.open_tab(e);break;case a.UNSAFE_NEW_TAB:n.unsafe_open_tab(e)}t&&t()}Object.defineProperty(t,"__esModule",{value:!0});var a;(function(e){e[e.REDIRECT=1]="REDIRECT",e[e.NEW_TAB=2]="NEW_TAB",e[e.UNSAFE_NEW_TAB=3]="UNSAFE_NEW_TAB"})(a=t.NavigationMethod||(t.NavigationMethod={})),t.isMetaKeyPressed=r,t.getNavigationMethod=o,t.logAndNavigate=i}),define("modules/clean/react/home/util/post_tti_components",["require","exports","tslib","react","modules/clean/react/home/post_tti/api","modules/clean/react/home/recents/components/pending_attachment_list_view","modules/clean/react/home/banner/constants"],function(e,t,n,r,o,i,a){"use strict";function c(e){return e.props.calendarProtoData.shouldShow}function s(){return new Promise(function(t,n){e(["modules/clean/react/home/experiments/calendar/drag_handler"],t,n)})}function l(e){var t=e.innerWrapper,n=e.children,o=e.className;return r.createElement("div",{className:o},t({children:n}))}var d=this;Object.defineProperty(t,"__esModule",{value:!0}),t.PostTTIRecentActivityImageAttachments=o.PostHomeTTIComponent({preTTIRenderer:function(e){var t=e.count;return r.createElement(i.PendingAttachmentListView,{count:t})},getPostTTIRenderer:function(e){var t=e.AttachmentListView;return function(e){var n=e.attachments;return r.createElement(t,{attachments:n})}}}),t.PrototypePostTTICalendarSection=o.PostHomeTTIComponentWithProps({getPostTTIRenderer:function(t){var o=t.props;return n.__awaiter(d,void 0,void 0,function(){var t,i;return n.__generator(this,function(a){switch(a.label){case 0:return t=o.calendarProtoData,t.shouldShow?[4,new Promise(function(t,n){e(["modules/clean/react/home/experiments/calendar/home_access_calendar"],t,n)})]:[3,2];case 1:return i=a.sent().HomeCalendarSection,[2,function(){return r.createElement("li",{className:"home-access-section"},r.createElement(i,n.__assign({},o.calendarProtoData)))}];case 2:return[2,null]}})})}});var u=function(e){var t=e.children;return r.createElement("div",null,t)};t.PrototypePostTTICalendarRecentActivityDragHandler=o.PostHomeTTIComponentWithProps({getPostTTIRenderer:function(e){return n.__awaiter(d,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return c(e)?[4,s()]:[3,2];case 1:return t=n.sent().RecentActivityItemViewDragHandler,[2,t];case 2:return[2,u]}})})},preTTIRenderer:u}),t.PrototypePostTTICalendarStarredDragHandler=o.PostHomeTTIComponentWithProps({getPostTTIRenderer:function(e){return n.__awaiter(d,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return c(e)?[4,s()]:[3,2];case 1:return t=n.sent().StarredItemDragHandler,[2,t];case 2:return[2,l]}})})},preTTIRenderer:l}),t.PostTTIHomeAccessBanner=o.PostHomeTTIComponentWithProps({getPostTTIRenderer:function(t){var o=t.props;return n.__awaiter(d,void 0,void 0,function(){var t,i,c,s;return n.__generator(this,function(n){switch(n.label){case 0:return t=o.paperBannerProps,i=t.variant,c=t.isPaperEnabledForUser,a.HOME_ACCESS_BANNER_ON_VARIANTS.includes(i)?[4,new Promise(function(t,n){e(["modules/clean/react/home/banner/home_access_banner_post_tti"],t,n)})]:[3,2];case 1:return s=n.sent().HomeAccessBanner,[2,function(){return r.createElement("li",{className:"home-access-section"},r.createElement(s,{variant:i,isPaperEnabledForUser:c}))}];case 2:return[2,null]}})})}})}),define("modules/clean/react/home/util/prefetch_handler",["require","exports"],function(e,t){"use strict";function n(e){return window[e]}function r(e,t,n){var r=e.getDataIfAvailable();if(r){var o=r.error,i=r.payload;o?n(o):t(i)}else e(t,n);return Boolean(r)}Object.defineProperty(t,"__esModule",{value:!0}),t.getPrefetchHandler=n,t.handlePrefetch=r}),define("modules/clean/react/home/util/resource_icon",["require","exports","tslib","external/react","spectrum/icon_content","spectrum/file_icon","modules/clean/react/home/constants"],function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderIcon=function(){if(a.DisplayTypeToResourceType[this.props.displayType]===a.FILE_RESOURCE_TYPE)return r.createElement(i.FileIcon,{path:this.props.fileName,variant:this.props.variant});var e=a.DisplayTypeToIconName[this.props.displayType]||"unknown";return r.createElement(o.IconContent,{name:e+"-"+this.props.variant})},t.prototype.render=function(){return r.createElement("span",{className:this.props.className},this.renderIcon())},t.displayName="HomeResourceIcon",t})(r.PureComponent);t.HomeResourceIcon=c}),define("modules/clean/react/home/util/show_hide_link",["require","exports","tslib","external/classnames","external/react","spectrum/icon_arrow","modules/core/i18n"],function(e,t,n,r,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getLinkText=function(){return this.props.isExpanded?a._("Collapse section"):this.props.hiddenItemCount<=0?a._("Show more"):this.props.canLoadMore?a._("Show %(number)s+ more").format({number:this.props.hiddenItemCount}):a._("Show %(number)s more").format({number:this.props.hiddenItemCount})},t.prototype.getLinkClass=function(){return r({"button-as-link":!0,"show-hide-link":!0,"show-hide-link--expanded":this.props.isExpanded})},t.prototype.render=function(){return o.createElement("div",{className:"show-hide-link__container"},o.createElement("button",{onClick:this.props.onClick,className:this.getLinkClass()},o.createElement("div",{className:"show-hide-link__arrow"},o.createElement(i.IconArrow,{name:"right"})),this.getLinkText()))},t.displayName="ShowHideLink",t})(o.PureComponent);t.ShowHideLink=c}),define("modules/clean/react/starred/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredLoadingState={LOADING:"LOADING",LOAD_SUCCESS:"LOAD_SUCCESS",LOAD_FAILED:"LOAD_FAILED"},t.StarredActionTypes={LOADING:"STARRED_LOADING",SET_STATUS:"STARRED_SET_STATUS",LOAD_FAILURE:"STARRED_LOAD_FAILURE",RENAME_EXTERNAL_RESOURCE:"STARRED_RENAME_EXTERNAL_RESOURCE"},t.IdTypes={ENCODED_FILE_OBJ_ID:"ENCODED_FILE_OBJ_ID",EXTERNAL_RESOURCE_ID:"EXTERNAL_RESOURCE_ID",PAPER_ID_PATH:"PAPER_ID_PATH",FQ_PATH:"FQ_PATH"};(function(e){e.HOME_STARRED="HOME_STARRED",e.HOME_RECENTS="HOME_RECENTS",e.BROWSE="BROWSE",e.FILE_VIEWER="FILE_VIEWER",e.SUGGESTED_STARS="SUGGESTED_STARS"})(t.StarredSource||(t.StarredSource={})),t.StarExtensionId_DEV="bkoifdjjfabbedgjlkmkcabdpajmmlhd",t.StarExtensionId_PROD="hjdobpfegefofikebjlabkpjlndkfefg"}),define("modules/clean/react/starred/id_type_pair",["require","exports"],function(e,t){"use strict";function n(e){return e.type+":"+e.id}Object.defineProperty(t,"__esModule",{value:!0}),t.idTypePairToString=n});
//# sourceMappingURL=pkg-home.min.js-vflkuaUu6.map