define(["require","exports","modules/clean/ajax","modules/core/browser","modules/clean/sharing/api/client","modules/constants/file_viewer","modules/clean/file_store/utils","modules/clean/viewer","modules/clean/react/paper/paper_log","modules/core/i18n","modules/clean/react/bubble_dropdown_v2","modules/core/notify"],function(e,r,o,n,t,i,a,s,l,u,c,d){"use strict";function p(e){var r=e.file,o=e.sharedLink;return f(e)?h(r)?o?k.Button:k.Dropdown:k.Ellipsis:k.Off}function _(e){return e===k.Dropdown||e===k.Ellipsis?c.BubbleDropdownPositions.BOTTOM_LEFT:c.BubbleDropdownPositions.BOTTOM}function f(e){var r=e.file,o=e.user,t=e.sharedLink;return!!r&&((h(r)&&w.includes(i.OPEN_IN_PAPER_VARIANT)||A(r)&&O.includes(i.EMBED_TO_PAPER_VARIANT))&&!s.Viewer.get_viewer().is_assume_user_session&&!n.is_mobile_or_tablet()&&n.is_supported_paper_browser()&&(!o&&!!t||!!o&&!o.is_paper_disabled))}function A(e){var r=a.getExtension(e);return!!r&&N.includes(r)}function h(e){var r=a.getExtension(e);return!!r&&(C.includes(r)&&e.bytes<20971520)}function b(e){var r=u._("Copy to Paper");return A(e)&&(r=u._("Add to Paper doc")),r}function P(e){return A(e)}function T(e){if(A(e))return u._("Bring it all together");switch(i.OPEN_IN_PAPER_CALLOUT_VARIANT){case"VARIANT_1":return u._("Plan your next steps");case"VARIANT_2":return u._("Bring it all together")}return u._("Bring this doc to life")}function I(e){if(A(e))return u._("Add this file to a Paper doc to collect ideas and organize your thoughts.");switch(i.OPEN_IN_PAPER_CALLOUT_VARIANT){case"VARIANT_1":return u._("Copy to Paper for the ability to create and assign to-dos with due dates.");case"VARIANT_2":return u._("Copy to Paper to make this a doc where you can link other files and media.")}return u._("Copy to Paper and make changes or ask for feedback.")}function m(e){var r=e.file,n=e.sharedLink,t=e.contUrl,i=e.successCallback,a=e.errorCallback,s=e.extension,l=e._tk,u=e.oqa;o.WebRequest({url:"/paper/sign_request_data",data:{path:r.file_id,sharedLink:n,cont_url:t,extension:s,_tk:l,oqa:u},success:i,error:a})}function g(e){var r=window.open("","_blank"),o=function(e){r?n.redirect(e,r):n.redirect(e)},i=function(){r&&r.close(),d.Notify.error(u._("Canâ€™t copy file to Paper"))},s=e.sharedLink?e.sharedLink:"",c=e.file,p=e.user,_=e.sharedLink?"shared_file_actions":"mounted_file_actions",f=a.getExtension(c);l.paperLog(l.PaperEventTypes.CTA_CLICK,{source:_,cta:"open_in_paper_button",extension:f});var A=f,b={file:c,sharedLink:s,contUrl:"/create-doc-from-dropbox-file",extension:f,successCallback:o,errorCallback:i,_tk:"dropbox_web_copy_from_previews",oqa:A};if(h(c))m(b);else if(b._tk="dropbox_web_embed_from_previews",!s&&p){var P=new t.FileShareApiClient({userId:p.id});P.sharedLinkInfo({fileIdOrPath:c.file_id}).then(function(e){e?(b.sharedLink=e.url,b.contUrl="/dropbox-file-embed",m(b)):P.createSharedLink({fileIdOrPath:c.file_id}).then(function(e){b.sharedLink=e.url,b.contUrl="/dropbox-file-embed",m(b)}).catch(function(e){i&&i()})}).catch(function(e){i&&i()})}else b.contUrl="/dropbox-file-embed",m(b)}Object.defineProperty(r,"__esModule",{value:!0});var k,w=["VARIANT_A","VARIANT_B1","VARIANT_B2","VARIANT_B3","VARIANT_B4","ON"],O=["BUTTON","DROPDOWN","ELLIPSIS"],C=["docx"],N=["jpg","jpeg","png","pdf","xls","xlsx","mp4","mov","pptx","ppt","zip","rar","mp3"];(function(e){e[e.Off=1]="Off",e[e.Control=2]="Control",e[e.Button=3]="Button",e[e.Dropdown=4]="Dropdown",e[e.Ellipsis=5]="Ellipsis"})(k=r.OpenInPaperButtonVariant||(r.OpenInPaperButtonVariant={})),r.getOpenInPaperButtonVariant=p,r.getCalloutPosition=_,r.shouldShowOpenInPaper=f,r.fileSupportsEmbedToPaper=A,r.fileSupportsCopyToPaper=h,r.getCTAText=b,r.shouldShowCTADescription=P,r.getCalloutTitle=T,r.getCalloutMessage=I,r.createPaperAccountAndRedirect=m,r.openFileInPaper=g});
//# sourceMappingURL=utils.min.js-vfl4qTKgT.map