define("external/deep-freeze",["require","exports","module"],function(e,r,t){t.exports=function e(r){return Object.freeze(r),Object.getOwnPropertyNames(r).forEach(function(t){!r.hasOwnProperty(t)||null===r[t]||"object"!=typeof r[t]&&"function"!=typeof r[t]||Object.isFrozen(r[t])||e(r[t])}),r}}.bind(Object.create(null))),define("modules/clean/browse_uri_interface",["require","exports","modules/clean/viewer","modules/core/uri"],function(e,r,t,s){"use strict";function n(e){return t.Viewer.get_viewer().is_paired?"personal"===e.role?l+r.PERSONAL_ROOT:l+r.WORK_ROOT:l+r.HOME_ROOT}function o(e){l=e}function a(e,r){return"/"!==r.charAt(0)&&(r="/"+r),new s.URI({scheme:"https",authority:"www.dropbox.com",path:l+"/preview"+r,query:{role:e.role}})}function i(e,r){return r.is_dir?r.href:r.is_cloud_doc&&r.preview_url?r.preview_url:a(e,r.fq_path).toString()}function c(e,r){return new s.URI({scheme:"https",authority:"www.dropbox.com",path:""+n(e)+r})}Object.defineProperty(r,"__esModule",{value:!0}),r.HOME_ROOT="/home",r.WORK_ROOT="/work",r.PERSONAL_ROOT="/personal";var l="";r.get_browse_root=n,r.set_base_prefix=o,r.preview_uri_for_fq_path=a,r.href_for_file=i,r.browse_uri_for_fq_path=c}),define("modules/clean/filetypes",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e[e.FILE=1]="FILE",e[e.FOLDER=2]="FOLDER",e[e.PACKAGE=3]="PACKAGE",e[e.SHARED_FOLDER=4]="SHARED_FOLDER",e[e.SANDBOX=5]="SANDBOX",e[e.TEAM_SHARED_FOLDER=6]="TEAM_SHARED_FOLDER",e[e.TEAM_MEMBER_FOLDER=7]="TEAM_MEMBER_FOLDER"})(r.FileTypes||(r.FileTypes={}))}),define("modules/clean/immutability_helper",["require","exports","external/deep-freeze"],function(e,r,t){"use strict";function s(e){if(null==e)throw new TypeError("Cannot thaw null/undefined object");if(Array.isArray(e))return E.call(e);for(var r=Object.create(Object.getPrototypeOf(e)),t=Object.getOwnPropertyNames(e),s=0,n=t;s<n.length;s++){var o=n[s],a=Object.getOwnPropertyDescriptor(e,o);a&&(a.get||a.set)?(a.configurable=!0,Object.defineProperty(r,o,a)):r[o]=e[o]}return r}function n(e,r){var n=s(e);return r(n),t(n)}function o(e,r){if(!r||0===r.length)throw new TypeError("Invalid key path: "+JSON.stringify(r));return r.reduce(function(e,r){return null==e?null:e[r]},e)}function a(e,r,n){if(null==e)throw new TypeError("Object to `set` cannot be null");if(e[r]===n)return e;var o=s(e);return o[r]=n,t(o)}function i(e,r,t){return a(e,r,t(e[r]))}function c(e,r,t){if(!r||0===r.length)throw new TypeError("Invalid key path: "+JSON.stringify(r));if(null==e)throw new TypeError("Target object cannot be null");var s=r[0];return 1===r.length?i(e,s,t):a(e,s,c(e[s],r.slice(1),t))}function l(e,r,t){if(!r||0===r.length)throw new TypeError("Invalid key path: "+JSON.stringify(r));if(null==e)throw new TypeError("Target object cannot be null");var s=r[0];switch(r.length){case 1:return a(e,s,t);default:return a(e,s,l(e[s]||{},r.slice(1),t))}}function _(e,r){if(null==e||null==r)throw new TypeError("Both target and source cannot be null");var n=Object.keys(r).reduce(function(t,s){return r[s]!==e[s]&&t.push(s),t},[]);if(n.length){for(var o=s(e),a=0,i=n;a<i.length;a++){var c=i[a],l=Object.getOwnPropertyDescriptor(r,c);void 0!==l&&Object.defineProperty(o,c,l)}return t(o)}return e}function u(e,r,t){if(null==e||null==t)throw new TypeError("Both target and source cannot be null");return c(e,r,function(e){return _(e,t)})}function d(e,r,s){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var a=E.call(e);return a.splice.apply(a,[r,s].concat(n)),t(a)}function h(e){for(var r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];var n=E.call(e);return n.unshift.apply(n,r),t(n)}function p(e){for(var r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];var n=E.call(e);return n.push.apply(n,r),t(n)}Object.defineProperty(r,"__esModule",{value:!0});var E=Array.prototype.slice;r.thaw=s,r.withMutations=n,r.getIn=o,r.set=a,r.update=i,r.updateIn=c,r.setIn=l,r.merge=_,r.mergeIn=u,r.splice=d,r.unshift=h,r.push=p}),define("modules/clean/react/app_actions_view",["require","exports","tslib","external/classnames","spectrum/button","spectrum/icon_action","spectrum/popover","spectrum/overflow_button","spectrum/tertiary_link","external/react","modules/clean/react/css","modules/clean/user_education/react/user_education_effect","modules/clean/user_education/user_education_client","modules/clean/react/file_uploader/upload_button","modules/clean/react/badge"],function(e,r,t,s,n,o,a,i,c,l,_,u,d,h,p){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var E=function(e){e.handleClick&&e.handleClick()};r.AppActionsPopover=function(e){var r=e.primaryMenuItem,t=e.secondaryMenuItems,s=e.popoverTriggerLabel,n=[];return r&&(n=r.subItems?n.concat(r.subItems):n.concat([r])),t&&(n=n.concat.apply(n,t)),n.length&&s?l.createElement(a.Popover,{onSelection:E},l.createElement(a.PopoverTrigger,null,l.createElement(i.OverflowButton,{tagName:"span","aria-label":s})),l.createElement(a.PopoverContent,{attachment:"right"},n.map(function(e){return l.createElement(a.PopoverContentItem,{key:e.displayName,value:e,className:e.className,disabled:e.disabled},e.iconName&&l.createElement(o.IconAction,{name:e.iconName,className:"popover-item-icon"}),e.displayName)}))):l.createElement("noscript",null)};var S=function(e,r,t){d.UEClient.sendEvent(e,r),t&&t()},m=function(e){var r=e.primaryMenuItem,t=e.headerText;if(r&&Object.keys(r).length>0){var i=s("primary-action-menu__button",r.className),c=i.indexOf("action-upload")>=0,_=!!r.subItems,d=l.createElement(u.UserEducationEffect,{containerName:"AppActionsView",name:"PrimaryButtonText",useSpan:!0},r.displayName),p=c?l.createElement(h.UploadButton,{className:i,disabled:r.disabled,handleClick:function(){S("AppActionsView","PrimaryButtonTextClicked",r.handleClick)},variant:"primary",tagName:_?"span":void 0},d):l.createElement(n.Button,{className:i,disabled:r.disabled,onClick:r.handleClick,variant:"primary",tagName:_?"span":void 0},d),m=_?l.createElement(a.Popover,{onSelection:E},l.createElement(a.PopoverTrigger,{disabled:r.disabled},p),l.createElement(a.PopoverContent,{className:"primary-action-menu__popover-menu"},r.subItems.map(function(e){return l.createElement(a.PopoverContentItem,{key:e.popoverMenuName,value:e,className:e.className,disabled:e.disabled},e.iconName&&l.createElement(o.IconAction,{name:e.iconName,className:"popover-item-icon"}),e.popoverMenuName)}))):p;return l.createElement("div",{className:"primary-action-menu"},l.createElement("span",{className:"primary-action-menu__header-text"},t),l.createElement("div",{className:"primary-action-menu__button-wrapper"},m))}return l.createElement("noscript",null)},f=function(e){var r=e.menuItem,n=r.disabled,o=r.displayName,a=r.handleClick,i=r.iconName,_=r.badge,d=s("secondary-action-menu__button",e.menuItem.className),E=d.indexOf("action-upload")>=0,m=l.createElement(u.UserEducationEffect,{containerName:"AppActionsView",name:"SecondaryActionMenu-text-"+i},o,_&&l.createElement(p.Badge,t.__assign({},_)));return E?l.createElement(h.UploadButton,{key:o,iconName:i,handleClick:function(){S("AppActionsView","SecondaryActionMenu-text-"+i+"-Clicked",a)},disabled:n,className:d,variant:"secondary"},m):l.createElement(c.TertiaryLink,{key:o,icon:i,onClick:function(){S("AppActionsView","SecondaryActionMenu-text-"+i+"-Clicked",a)},disabled:n,className:d},m)},T=function(e){var r=e.secondaryMenuItems;return l.createElement(c.TertiaryList,{className:"secondary-action-menu"},r.map(function(e){return l.createElement(f,{key:e.displayName,menuItem:e})}))},R=(function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(s,e),s.prototype.componentDidMount=function(){this.props.handleComponentTTI("AppActionsView")},s.prototype.render=function(){var e=this.props,t=e.responsive,s=e.primaryMenuItem,n=e.primarySubnode,o=e.secondaryMenuItems,a=e.headerText,i=e.popoverTriggerLabel,c=!(!t||!t.isResponsive||t.isMatchedLarge);return l.createElement("div",{className:"appactions-menu"},c&&l.createElement("div",{className:"appactions-menu--popover"},s&&i&&l.createElement(r.AppActionsPopover,{primaryMenuItem:s,secondaryMenuItems:o,popoverTriggerLabel:i})),!c&&l.createElement("div",{className:"appactions-menu--buttons"},s&&l.createElement(m,{primaryMenuItem:s,headerText:a}),n,o&&l.createElement(T,{secondaryMenuItems:o})))},s.defaultProps={headerText:"",secondaryMenuItems:[],handleComponentTTI:function(){}},s})(l.PureComponent),C=_(R,["/static/css/spectrum/index.web-vflcqOQ-g.css","/static/css/dropbox/app_actions-vflfwXvD7.css"]);r.AppActionsView=C}),define("modules/clean/react/badge",["require","exports","tslib","external/react","external/classnames","modules/clean/react/css","modules/core/i18n"],function(e,r,t,s,n,o,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i;(function(e){e.NEW="new",e.PRO="pro"})(i=r.BadgeVariant||(r.BadgeVariant={}));var c;(function(e){e.NEON_GREEN="neon-green",e.STONE_FORTY="stone-forty",e.SQUASH="squash"})(c=r.BadgeColor||(r.BadgeColor={}));var l=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.render=function(){return s.createElement("span",{className:n("badge","badge--variant-"+this.props.variant,"badge--color-"+this.props.color,{"badge--absolute":this.props.absolute},this.props.className)},this.props.variant===i.NEW?a._("New"):this.props.variant===i.PRO?a._("Pro"):null)},r.defaultProps={color:c.NEON_GREEN,absolute:!1},r})(s.Component);r.Badge=o(l,["/static/css/react/badge-vflVhw_sU.css"])}),define("modules/clean/react/browse/constants",["require","exports","modules/core/i18n"],function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e[e.NotReady=0]="NotReady",e[e.NotLive=1]="NotLive",e[e.Live=2]="Live"})(r.BrowseBoltClientStatus||(r.BrowseBoltClientStatus={}));(function(e){e.INITIALIZE_EVERYTHING="INITIALIZE_EVERYTHING",e.LOAD_PATH="LOAD_PATH",e.CLEAR_FILES="CLEAR_FILES",e.ADD_FILES="ADD_FILES",e.ADD_FILES_AND_SET_LOADING_STATE="ADD_FILES_AND_SET_LOADING_STATE",e.SET_PATH="SET_PATH",e.SET_USER="SET_USER",e.SET_URL_PREFIX="SET_URL_PREFIX",e.SET_LOADING_STATE="SET_LOADING_STATE",e.SET_MOUNT_POINTS="SET_MOUNT_POINTS",e.SET_TEAM_FOLDERS="SET_TEAM_FOLDERS",e.CHANGE_FILES="CHANGE_FILES",e.SET_SELECTION="SET_SELECTION",e.SELECT_FILES_AFTER_UPLOAD="SELECT_FILES_AFTER_UPLOAD",e.SELECT_FILES_BY_FQ_PATH="SELECT_FILES_BY_FQ_PATH",e.SET_SHOULD_SHOW_DELETED_FILES="SET_SHOULD_SHOW_DELETED_FILES",e.SET_DROP_TARGET="SET_DROP_TARGET",e.SORT_FILES="SORT_FILES",e.SET_VIEW_TYPE="SET_VIEW_TYPE",e.COPY_FILES_TO_CLIPBOARD="COPY_FILES_TO_CLIPBOARD",e.REQUEST_NEW_FILE_NAME="REQUEST_NEW_FILE_NAME",e.CANCEL_FILE_RENAME="CANCEL_FILE_RENAME",e.SET_FILE_RENAME_PENDING="SET_FILE_RENAME_PENDING",e.SET_FILE_RENAME_COMPLETE="SET_FILE_RENAME_COMPLETE",e.REQUEST_FOLDER_NAME="REQUEST_FOLDER_NAME",e.CREATE_FOLDER_PENDING="CREATE_FOLDER_PENDING",e.CREATE_FOLDER_COMPLETE="CREATE_FOLDER_COMPLETE",e.CANCEL_CREATE_FOLDER="CANCEL_CREATE_FOLDER",e.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE="SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE",e.TEAM_FOLDER_DOWNGRADE="TEAM_FOLDER_DOWNGRADE",e.ADD_COMMENT_STATUS_BATCH="ADD_COMMENT_STATUS_BATCH",e.ADD_FILE_JUMP_KEY_CODE="ADD_FILE_JUMP_KEY_CODE",e.RESET_FILE_JUMP="RESET_FILE_JUMP",e.SET_ACTIVE_TAB="SET_ACTIVE_TAB",e.REQUEST_FETCH_FOLDER_SIZES="REQUEST_FETCH_FOLDER_SIZES",e.FETCHED_FOLDER_SIZES="FETCHED_FOLDER_SIZES",e.COMPLETE_FETCH_FOLDER_SIZES="COMPLETE_FETCH_FOLDER_SIZES",e.SET_COLUMN_DEPENDENT_CAPABILITIES="SET_COLUMN_DEPENDENT_CAPABILITIES",e.SET_TILES_PER_ROW="SET_TILES_PER_ROW",e.SET_COLUMN_CONFIGURATION="SET_COLUMN_CONFIGURATION",e.SET_EXPERIMENTS="SET_EXPERIMENTS"})(r.BrowseActionType||(r.BrowseActionType={})),r.BROWSE_FILE_VIEWER_ELEMENT_ID="browse-react-file-viewer-container";var s={IMAGE:["bmp","cr2","gif","ico","jpeg","jpg","nef","png","psd","tif","tiff","svg","svgz"],VIDEO:["3gp","3gpp","3gpp2","avi","dv","flv","m2t","m4v","mkv","mov","mp4","mpeg","mpg","mts","ts","vob","wmv"],AUDIO:["aif","flac","m4a","m4p","mp3","ogg","wav","wma"],DOCUMENT:["ai","cdr","csv","doc","docx","docm","eps","fla","indd","keynote","numbers","otf","pages","pdf","ppt","pptx","pptm","pps","ppsx","ppsm","ps","rtf","swf","txt","wpd","xls","xlsx","xlsm"],COMPRESSED_FILE:["7z","bz2","gz","gzip","rar","tar","zip"],CODE:["as","as3","asm","aspx","bat","c","cc","cmake","coffee","cpp","cs","css","cxx","diff","erb","erl","groovy","gry","h","haml","hh","hpp","html","htm","hxx","java","js","json","jsx","less","lst","m","make","mk","ml","mm","msg","out","patch","php","pl","pm","plist","properties","py","rb","sass","scala","scm","script","scss","sh","sml","sql","vb","vi","vim","xhtml","xml","xsd","xsl","y","yaml","yml","yxx"],DISK_IMAGE:["dmg","iso"],EXECUTABLE:["exe"],SHORTCUT:["lnk"],LINK:["url","webloc"],FONT:["ttf"]};r.CulledListConstants={ITEM_ROW_HEIGHT_PX:46,MAESTRO_ITEM_ROW_HEIGHT_PX:57,SEARCH_ROW_HEIGHT_PX:53,MAESTRO_SEARCH_ROW_HEIGHT_PX:66,DEFAULT_HEADER_HEIGHT_PX:142,ITEM_BUFFER_SIZE:5},r.OverflowMenuConstants={MENU_ITEM_HEIGHT_PX:32,MENU_MARGIN_PX:8,MENU_POPOVER_ITEM_GROUP_SEPARATOR_HEIGHT_PX:17},r.FileTypeCategoryTranslations={FILE:t._("File"),FOLDER:t._("Folder"),SHARED_FOLDER:t._("Shared folder"),TEAM_SHARED_FOLDER:t._("Team folder"),TEAM_MEMBER_FOLDER:t._("Member folder"),PUBLIC_FOLDER:t._("Folder"),IMAGE:t._("Image"),VIDEO:t._("Video"),AUDIO:t._("Audio"),DOCUMENT:t._("Document"),COMPRESSED_FILE:t._("Archive"),CODE:t._("Code"),DISK_IMAGE:t._("Disk image"),EXECUTABLE:t._("Executable"),SHORTCUT:t._("Shortcut"),LINK:t._("Link"),FONT:t._("Font"),SANDBOX:t._("App folder")},r.FileTypeCapitalizedCategoryTranslations={FILE:t._("FILE"),FOLDER:t._("FOLDER"),SHARED_FOLDER:t._("SHARED FOLDER"),TEAM_SHARED_FOLDER:t._("TEAM FOLDER"),TEAM_MEMBER_FOLDER:t._("MEMBER FOLDER"),PUBLIC_FOLDER:t._("FOLDER"),IMAGE:t._("IMAGE"),VIDEO:t._("VIDEO"),AUDIO:t._("AUDIO"),DOCUMENT:t._("DOCUMENT"),COMPRESSED_FILE:t._("ARCHIVE"),CODE:t._("CODE"),DISK_IMAGE:t._("DISK IMAGE"),EXECUTABLE:t._("EXECUTABLE"),SHORTCUT:t._("SHORTCUT"),LINK:t._("LINK"),FONT:t._("FONT"),SANDBOX:t._("APP FOLDER")},r.DeletedFileTypeCategoryTranslations={FILE:t._("Deleted file"),FOLDER:t._("Deleted folder"),SHARED_FOLDER:t._("Deleted shared folder"),TEAM_SHARED_FOLDER:t._("Deleted team folder"),TEAM_MEMBER_FOLDER:t._("Deleted member folder"),PUBLIC_FOLDER:t._("Deleted folder"),IMAGE:t._("Deleted image"),VIDEO:t._("Deleted video"),AUDIO:t._("Deleted audio"),DOCUMENT:t._("Deleted document"),COMPRESSED_FILE:t._("Deleted archive"),CODE:t._("Deleted code"),DISK_IMAGE:t._("Deleted disk image"),EXECUTABLE:t._("Deleted executable"),SHORTCUT:t._("Deleted shortcut"),LINK:t._("Deleted link"),FONT:t._("Deleted font"),SANDBOX:t._("Deleted app folder")},r.DeletedFileTypeCapitalizedCategoryTranslations={FILE:t._("DELETED FILE"),FOLDER:t._("DELETED FOLDER"),SHARED_FOLDER:t._("DELETED SHARED FOLDER"),TEAM_SHARED_FOLDER:t._("DELETED TEAM FOLDER"),TEAM_MEMBER_FOLDER:t._("DELETED MEMBER FOLDER"),PUBLIC_FOLDER:t._("DELETED FOLDER"),IMAGE:t._("DELETED IMAGE"),VIDEO:t._("DELETED VIDEO"),AUDIO:t._("DELETED AUDIO"),DOCUMENT:t._("DELETED DOCUMENT"),COMPRESSED_FILE:t._("DELETED ARCHIVE"),CODE:t._("DELETED CODE"),DISK_IMAGE:t._("DELETED DISK IMAGE"),EXECUTABLE:t._("DELETED EXECUTABLE"),SHORTCUT:t._("DELETED SHORTCUT"),LINK:t._("DELETED LINK"),FONT:t._("DELETED FONT"),SANDBOX:t._("DELETED APP FOLDER")},r.SyncSettingTranslations={sync:t._("Starts as synced"),nosync:t._("Starts as unsynced"),nosync_inherited:t._("Starts as unsynced"),sync_partial:t._("Some start synced"),deleted:""},r.ExtensionCategories={};for(var n=0,o=Object.keys(s);n<o.length;n++)for(var a=o[n],i=s[a],c=0,l=i;c<l.length;c++){var _=l[c];r.ExtensionCategories[_]=a}(function(e){e[e.ShareExisting=1]="ShareExisting",e[e.EditShared=2]="EditShared",e[e.EditSharedSubFolder=3]="EditSharedSubFolder"})(r.ShareFolderModalType||(r.ShareFolderModalType={}));(function(e){e.SET_SHARED_FOLDER_DATA="SET_SHARED_FOLDER_DATA",e.SET_MEMBER_COUNTS_FOR_NS="SET_MEMBER_COUNTS_FOR_NS",e.SET_SHARED_LINK_DATA="SET_SHARED_LINK_DATA",e.SET_SHARED_FILE_DATA="SET_SHARED_FILE_DATA",e.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE="SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE",e.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE="SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE",e.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE="SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE",e.CLEAR_SHARED_FOLDER_DATA_FOR_NS="CLEAR_SHARED_FOLDER_DATA_FOR_NS",e.REMOVE_SHARED_LINK_DATA="REMOVE_SHARED_LINK_DATA"})(r.SharedWithActionType||(r.SharedWithActionType={})),r.SEARCH_PREFIX="/search",r.MAX_FOLDERS_PER_CALL=100,r.MAX_FOLDER_SIZE_QUEUE_SIZE=50,r.MAX_FOLDER_SIZE_ITERATIONS=1e3;(function(e){e.GOOGLE_DSS_DOC="gdoc",e.GOOGLE_DSS_SHEET="gsheet",e.GOOGLE_DSS_SLIDES="gslides",e.PAPER="paper"})(r.CloudDoc||(r.CloudDoc={})),r.VIEW_TYPE_COOKIE_NAME="browse_view_type",r.COLUMNS_STORAGE_KEY="browse_columns",r.BROWSE_SORT_COOKIE_NAME="browse_current_sort";var u;(function(e){e.country_override="country_override",e.cProfile="cProfile",e.d="d",e.last_fq_path="last_fq_path",e.path="path",e.preview="preview",e.public_mode_override="public_mode_override",e.query="query",e.query_unnormalized="query_unnormalized",e.search_session_id="search_session_id",e.search_token="search_token",e.select="select",e.stormcrow_override="stormcrow_override",e.stormcrow_override_data_field="stormcrow_override_data_field",e.stormcrow_override_population="stormcrow_override_population",e.stormcrow_override_ttl="stormcrow_override_ttl",e.stormcrow_panel="stormcrow_panel",e.uncompressed_js="uncompressed_js",e.use_packages="use_packages"})(u=r.BrowseQueryArg||(r.BrowseQueryArg={})),r.FRAMEWORK_ARGS=[[u.country_override],[u.cProfile],[u.public_mode_override],[u.stormcrow_override],[u.stormcrow_override_data_field],[u.stormcrow_override_population],[u.stormcrow_override_ttl],[u.stormcrow_panel],[u.uncompressed_js],[u.use_packages]]}),define("modules/clean/react/browse/logger_util",["require","exports"],function(e,r){"use strict";function t(e){return!!e&&!!e.fq_path}function s(e){return!!e&&!!e.pad_id}function n(e){return void 0!==e.folder_id}function o(e){var r=e.filter(function(e){return t(e)&&e.is_dir}).count();return{num_files_selected:e.filter(function(e){return t(e)&&!e.is_dir}).count(),num_folders_selected:r}}Object.defineProperty(r,"__esModule",{value:!0}),r.isFile=t,r.isPaper=s,r.isPaperFolder=n,r.countFilesAndFolders=o}),define("modules/clean/react/browse/models",["require","exports","tslib","modules/clean/immutability_helper","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/constants","modules/clean/sharing/access_level","modules/clean/display_format","modules/clean/datetime","modules/core/i18n"],function(e,r,t,s,n,o,a,i,c,l,_){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=(function(){function e(e){this.beacon_context=e.beacon_context,this.bytes=e.bytes,this.comment_count=e.comment_count,this.direct_blockserver_link=e.direct_blockserver_link,this.event_type=e.event_type,this.ext=e.ext,this.feedback_off=e.feedback_off,this.file_id=e.file_id,this.filename_highlights=e.filename_highlights,this.fq_path=e.fq_path,this.href=e.href,this.htmlified_link=e.htmlified_link,this.icon=e.icon,this.is_cloud_doc=e.is_cloud_doc,this.is_dir=e.is_dir,this.is_in_team_folder_tree=e.is_in_team_folder_tree,this.is_symlink=e.is_symlink,this.is_unmounted=e.is_unmounted,this.last_modified_name=e.last_modified_name,this.latest_rev=e.latest_rev,this.linkfile_data=e.linkfile_data,this.match_type=e.match_type,this._mount_access_perms=e._mount_access_perms,this.ns_id=e.ns_id,this.ns_path=e.ns_path,this.preview_type=e.preview_type,this.preview_url=e.preview_url,this.preview_thumbnail_url=e.preview_thumbnail_url,this.read_only=!!e.read_only,this.request_id=e.request_id,this.revision_id=e.revision_id,this.sjid=e.sjid,this.sort_key=e.sort_key,this.sort_rank=e.sort_rank,this.sync_setting=e.sync_setting,this.target_ns=e.target_ns,this.team_folder_status=e.team_folder_status,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.ts=e.ts,this.type=e.type,this.unresolved_comment_count=e.unresolved_comment_count,this.video_metadata_url=e.video_metadata_url,this.video_container=e.video_container,this.video_transcode_url=e.video_transcode_url,this.video_thumb_scrubber_vtt_url=e.video_thumb_scrubber_vtt_url,this.preview_ssr_text_url_tmpl=e.preview_ssr_text_url_tmpl,this.preview_ssr_image_url_tmpl=e.preview_ssr_image_url_tmpl,this.preview_ssr_refresh_url=e.preview_ssr_refresh_url,this.isDeleted=!!e.isDeleted,this.fetchFolderSizesStatus=e.fetchFolderSizesStatus}return Object.defineProperty(e.prototype,"ago",{get:function(){return this.is_dir||null===this.ts||void 0===this.ts?"":l.getActingTimeWithAgoEnabled(1e3*this.ts,!1,!0,0,!0,!0,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.isDeleted||this.bytes<0?_._("Deleted"):void 0===this.bytes?"":c.format_bytes(this.bytes)},enumerable:!0,configurable:!0}),e.fromServerObject=function(r){return new e(t.__assign({},r,{_mount_access_perms:r.mount_access_perms,isDeleted:r.bytes===-1}))},e.prototype.set=function(e,r){return s.set(this,e,r)},e.prototype.merge=function(e){return s.merge(this,e)},e.prototype.toJS=function(){return Object.assign({},this)},e.getExtension=function(e){return e.is_dir?"":n.file_extension(n.filename(e.fq_path))},e.getCategoryDescription=function(r,t){void 0===t&&(t=!1);var s;if(r.is_dir)if(r.is_in_team_folder_tree)s="SHARED_FOLDER";else switch(s="FOLDER",r.type){case o.FileTypes.TEAM_SHARED_FOLDER:s="TEAM_SHARED_FOLDER";break;case o.FileTypes.SHARED_FOLDER:s="SHARED_FOLDER";break;case o.FileTypes.SANDBOX:s="SANDBOX";break;case o.FileTypes.TEAM_MEMBER_FOLDER:s="TEAM_MEMBER_FOLDER";break;default:r.target_ns&&(s="SHARED_FOLDER")}else s=a.ExtensionCategories[e.getExtension(r)]||"FILE";return r.isDeleted?t?a.DeletedFileTypeCapitalizedCategoryTranslations[s]:a.DeletedFileTypeCategoryTranslations[s]:t?a.FileTypeCapitalizedCategoryTranslations[s]:a.FileTypeCategoryTranslations[s]},e.getSyncSettingDescription=function(e){return e.sync_setting?a.SyncSettingTranslations[e.sync_setting]:""},e.isTeamSharedFolder=function(e){return e.type===o.FileTypes.TEAM_SHARED_FOLDER},e.isTeamMemberFolder=function(e){return e.type===o.FileTypes.TEAM_MEMBER_FOLDER},e.isReadOnlySharedFolder=function(e){var r=e._mount_access_perms;return null!=r&&!r.includes("can_edit")},e.isNoAccessSharedFolder=function(e){var r=e._mount_access_perms;return null!=r&&!r.includes("can_view")},e.canViewFileMembers=function(e,r){var t=e._mount_access_perms;return!(t&&t.indexOf("can_view_members")<0)&&(!(r&&!r.canViewContainingNSMembers)||!!(t&&t.indexOf("can_view_members")>=0))},e.prototype.updateSize=function(e,r){return this.merge({bytes:e,fetchFolderSizesStatus:r})},e})();r.File=u;var d=(function(){function e(e){void 0===e&&(e={}),this.isPublicFolderEnabled=!!e.isPublicFolderEnabled,this.publicFolderFqPath=e.publicFolderFqPath,this.publicAppToken=e.publicAppToken,Object.freeze(this)}return e.fromServerObject=function(r){return new e({isPublicFolderEnabled:r.public_folder_enabled,publicFolderFqPath:r.public_folder_fq_path,publicAppToken:r.public_app_token})},e.prototype.set=function(e,r){return s.set(this,e,r)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e})();r.Config=d;var h=(function(){function e(e){var r=void 0===e?{}:e,t=r.canViewContainingNSMembers,s=r.currentNSID,n=r.currentFQPath,o=r.currentMountPoint,a=r.currentNSPath,c=r.currentSharedFolderPermissionRole,l=r.currentNSAllowsNesting,_=r.inactiveNSIDByFQPath,u=r.permanentDeletionDisabledStateByNSID,h=r.isInFolderMode,p=r.isCurrentlyInRoot,E=r.isInsideSandboxFolder,S=r.isInsideSharedFolder,m=r.isInsideTeamFolderRoot,f=r.isInsideArchivedTeamFolder,T=r.isInsideTeamFolderTree,R=r.isInsideDeletedFolder,C=r.isInsideDeletedSharedFolder,A=r.isInsideDeletedNestedSharedFolder,g=r.isNonUserRelativeContext,O=r.pathRoot,I=r.rootNSID,y=r.showSharedFolderCreateTeamPromo,D=r.showPinnedTeamFolder,v=r.teamFolderOwnerTeamApiId,L=r.blockHash,N=r.config,b=r.syncSetting;this.canViewContainingNSMembers=null==t||t,this.currentNSID=s,this.currentFQPath=n||"",this.currentMountPoint=o,this.currentNSPath=a,this.currentSharedFolderPermissionRole=null!=c?c:i.NameSpaceAccess.ACCESS_NO_ACCESS,this.currentNSAllowsNesting=!!l,this.inactiveNSIDByFQPath=_||{},this.permanentDeletionDisabledStateByNSID=u||{},this.isInFolderMode=null==h||h,this.isCurrentlyInRoot=!!p,this.isInsideSandboxFolder=!!E,this.isInsideSharedFolder=!!S,this.isInsideTeamFolderRoot=!!m,this.isInsideArchivedTeamFolder=!!f,this.isInsideTeamFolderTree=!!T,this.isInsideDeletedFolder=!!R,this.isInsideDeletedSharedFolder=!!C,this.isInsideDeletedNestedSharedFolder=!!A,this.isNonUserRelativeContext=!!g,this.pathRoot=O,this.rootNSID=I,this.showSharedFolderCreateTeamPromo=!!y,this.showPinnedTeamFolder=!!D,this.teamFolderOwnerTeamApiId=v,this.blockHash=L,this.config=N||new d,this.syncSetting=b}return e.fromServerObject=function(r){var t=r.containing_fq_path||"";t.startsWith("/")||(t="/"+t);var s;r.inside_shared_folder&&(s=i.NameSpaceAccess.ACCESS_READER);var n,o=r.containing_ns_permissions||[],a=o.includes("mount_shared_folders");return r.inside_shared_folder&&(o.includes("edit_contents")&&(s=i.NameSpaceAccess.ACCESS_WRITER),o.includes("change_folder_options")&&(s=i.NameSpaceAccess.ACCESS_OWNER),o.includes("view_members")||(n=!1)),new e({blockHash:r.block_hash,canViewContainingNSMembers:n,config:d.fromServerObject(r),currentFQPath:t,currentMountPoint:r.containing_mount_point,currentNSAllowsNesting:a,currentNSID:r.containing_ns_id,currentNSPath:r.containing_ns_path,currentSharedFolderPermissionRole:s,inactiveNSIDByFQPath:r.old_path_to_ns_id,isCurrentlyInRoot:r.in_root_dir,isInFolderMode:r.inside_dir,isInsideSandboxFolder:r.inside_sandbox_folder,isInsideArchivedTeamFolder:r.inside_archived_team_folder,isInsideTeamFolderRoot:r.inside_team_folder_root,isInsideDeletedFolder:r.inside_deleted_dir,isInsideDeletedNestedSharedFolder:r.inside_deleted_nested_shared_folder,isInsideDeletedSharedFolder:r.inside_deleted_shared_folder,isInsideSharedFolder:r.inside_shared_folder,isInsideTeamFolderTree:r.inside_team_folder_tree,isNonUserRelativeContext:r.is_non_user_relative_context,pathRoot:r.path_root,permanentDeletionDisabledStateByNSID:r.permanent_delete_is_disabled_by_ns_id,rootNSID:r.root_ns_id,showPinnedTeamFolder:r.show_pinned_team_folder,showSharedFolderCreateTeamPromo:r.show_shared_folder_create_team_promo,teamFolderOwnerTeamApiId:r.team_folder_owner_team_dbtid,syncSetting:r.sync_setting})},e.prototype.set=function(e,r){return s.set(this,e,r)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e.prototype.isCurrentPathWriteable=function(){var e=this,r=e.currentSharedFolderPermissionRole;return!e.isInsideSharedFolder||r===i.NameSpaceAccess.ACCESS_WRITER||r===i.NameSpaceAccess.ACCESS_OWNER},e.prototype.getNameOfTargetFolder=function(){return n.filename(this.currentFQPath)},e})();r.BrowseContext=h;var p=(function(){function e(e){this.title=e.title,this.pad_id=e.pad_id,this.url=e.url,this.title_highlights=e.title_highlights,this.highlight_spans=e.highlight_spans,this.creator_name=e.creator_name,this.last_editor_name=e.last_editor_name,this.request_id=e.request_id,this.sort_rank=e.sort_rank,this.ts=e.ts}return Object.defineProperty(e.prototype,"last_modified_date",{get:function(){if(!this.ts)return"";var e=new Date(this.ts).getTime();return l.getActingTimeWithAgoEnabled(e,!1,!0,0,!0,!0,!0)},enumerable:!0,configurable:!0}),e.fromServerObject=function(r){return new e(r)},e})();r.Paper=p;var E=(function(){function e(e){this.name=e.name,this.url=e.url,this.folder_id=e.folder_id,this.title_highlights=e.title_highlights,this.highlight_spans=e.highlight_spans,this.request_id=e.request_id,this.sort_rank=e.sort_rank}return e.fromServerObject=function(r){return new e(r)},e})();r.PaperFolder=E}),define("modules/clean/react/maestro/a11y_constants",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e[e.TITLE=0]="TITLE",e[e.SEARCH_BAR=1]="SEARCH_BAR",e[e.NOTIFICATION_BELL=2]="NOTIFICATION_BELL",e[e.CALENDAR_FLYOUT=3]="CALENDAR_FLYOUT",e[e.ACCOUNT_MENU=4]="ACCOUNT_MENU",e[e.MAIN_CONTENT=5]="MAIN_CONTENT",e[e.SIDE_BAR=6]="SIDE_BAR"})(r.LAYOUT_TAB_ORDER||(r.LAYOUT_TAB_ORDER={}))}),define("modules/clean/react/maestro/header",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/maestro/top_menu_container","modules/clean/react/maestro_nav/shared_code/dropbox_logo","modules/clean/react/maestro/a11y_constants","modules/clean/react/maestro/responsive","external/classnames","modules/clean/user_education/react/user_education_effect"],function(e,r,t,s,n,o,a,i,c,l,_){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.render=function(){return s.createElement("header",{className:"maestro-header page-header__shadow"},s.createElement(c.VerticallyFixedWrapper,{className:"page-header",responsive:this.props.responsive},s.createElement("div",{className:l("page-header__title",this.props.titleClass),tabIndex:i.LAYOUT_TAB_ORDER.TITLE},s.createElement(_.UserEducationEffect,{containerName:"PageletMaestroHeader",name:"Title",useSpan:!0},this.props.title)),s.createElement(o.TopMenuContainer,t.__assign({},this.props))))},r.defaultProps={showSearchBar:!0,isSearchBarExpanded:!1},r})(s.Component),d=function(e){var r=e.children;return s.createElement("h1",{className:"page-header__heading"},r)};r.MaestroHeaderTitle=d;var h=function(){return s.createElement("a",{href:"/",className:"page-header__logo"},s.createElement(a.DropboxLogo,{alt:"Dropbox"}))};r.MaestroHeaderLogo=h;var p=n(u,["/static/css/maestro_layout-vflwIfhrd.css"]);r.PageletMaestroHeader=p}),define("modules/clean/react/maestro/layout",["require","exports","tslib","external/react","spectrum/match","modules/clean/react/maestro/header","modules/clean/react/maestro/secondary_sidebar","modules/clean/react/maestro/a11y_constants","modules/clean/react/maestro/responsive"],function(e,r,t,s,n,o,a,i,c){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var l=(function(e){function r(r){var t=e.call(this,r)||this;t.isPageResponsive=function(){return!(!document||!document.documentElement)&&document.documentElement.classList.contains(c.RESPONSIVE_CLASS)},t.handleSetup=function(){t.setState({setupComplete:!0})},t.handleMatchMedium=function(){t.setState({isMatchedMedium:!0})},t.handleUnmatchMedium=function(){t.setState({isMatchedMedium:!1})},t.handleMatchLarge=function(){t.setState({isMatchedLarge:!0})},t.handleUnmatchLarge=function(){t.setState({isMatchedLarge:!1})};var s=t.isPageResponsive();return t.state={isResponsive:s,isMatchedMedium:!s,isMatchedLarge:!s,setupComplete:!s},t}return t.__extends(r,e),r.prototype.render=function(){var e=this.props,r=e.user,l=e.titleRegion,_=e.titleClass,u=e.embeddedAppRegion,d=e.actionSidebarRegion,h=e.searchBarProps,p=this.state,E=p.setupComplete,S=t.__rest(p,["setupComplete"]);return s.createElement("div",{className:"maestro-chrome"},S.isResponsive&&s.createElement(n.Match,{media:c.BREAKPOINT_LARGE,onSetup:this.handleSetup,onMatch:this.handleMatchLarge,onUnmatch:this.handleUnmatchLarge}),S.isResponsive&&s.createElement(n.Match,{media:c.BREAKPOINT_MEDIUM,onSetup:this.handleSetup,onMatch:this.handleMatchMedium,onUnmatch:this.handleUnmatchMedium}),E&&s.createElement(o.PageletMaestroHeader,t.__assign({user:r,title:l,titleClass:_,responsive:S},h||{})),E&&s.createElement("main",{className:"maestro-app"},s.createElement("div",{className:"maestro-app-content",tabIndex:i.LAYOUT_TAB_ORDER.MAIN_CONTENT},"function"==typeof u?u(S):u),d&&s.createElement("div",{className:"maestro-secondary-sidebar__shadow",tabIndex:i.LAYOUT_TAB_ORDER.SIDE_BAR
},s.createElement(a.MaestroSecondarySidebar,{responsive:S},"function"==typeof d?d(S):d))))},r})(s.PureComponent);r.MaestroChrome=l}),define("modules/clean/react/maestro/responsive",["require","exports","tslib","external/react","spectrum/vertically_fixed"],function(e,r,t,s,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RESPONSIVE_CLASS="maestro--responsive",r.BREAKPOINT_MEDIUM="(min-width: 736px)",r.BREAKPOINT_LARGE="(min-width: 1025px)";var o=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.render=function(){var e=this.props,r=e.responsive,o=t.__rest(e,["responsive"]),a=r&&r.isResponsive?"div":n.VerticallyFixed;return s.createElement(a,o)},r.displayName="VerticallyFixedWrapper",r})(s.Component);r.VerticallyFixedWrapper=o}),define("modules/clean/react/maestro/secondary_sidebar",["require","exports","tslib","external/react","modules/clean/react/maestro/responsive","modules/clean/react/prompt/legacy_ha_wrapper"],function(e,r,t,s,n,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.render=function(){return s.createElement(n.VerticallyFixedWrapper,{responsive:this.props.responsive,className:"maestro-secondary-sidebar"},this.props.children,s.createElement(o.LegacyHAWrapper,null))},r})(s.Component);r.MaestroSecondarySidebar=a}),define("modules/clean/react/maestro/top_menu_container",["require","exports","tslib","external/react","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/react/browse/models","modules/core/browser","modules/clean/search/search_bar/controller","modules/clean/search/search_bar/log_helper","modules/clean/search/search_helpers","modules/core/uri","modules/clean/react/css","modules/clean/web_user_action_events"],function(e,r,t,s,n,o,a,i,c,l,_,u,d,h){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var p=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.onSearch=function(e){var t=e.query,s=e.searchToken,n=e.searchSessionId,o=e.searchPath,a=e.qargs,c=r.props.user;t&&i.redirect(_.buildSearchURL({user:c,searchPath:o,normalizedQuery:t,searchSessionId:n,searchToken:s,qargs:a}).toString())},r.onSlimSearchResultOpen=function(e){var t=r.props.user;if(e instanceof a.Paper||e instanceof a.PaperFolder)i.open_tab(e.url);else{var s=e;if(s.is_dir){var n=new u.URI({path:"/"+t.role+s.fq_path});i.open_tab(n.toString())}else{var o=s.fq_path.substring(1),n=new u.URI({path:"/"+t.role}).updateQuery({preview:o});i.open_tab(n.toString())}}},r.logSearchResultOpen=function(e){var t=r.props.user;e instanceof a.File?l.logDropdownSearchAction({result:e,user:t,action_type:e.is_dir?h.WebUserActionLogEvent.FOLDER_OPEN:h.WebUserActionLogEvent.FILE_VIEW,viewport:"top-menu-dropdown-view"}):(e instanceof a.Paper||e instanceof a.PaperFolder)&&l.logDropdownSearchAction({result:e,user:t,action_type:h.WebUserActionLogEvent.PAPER_OPEN,viewport:"top-menu-dropdown-view"})},r.onResultObjectPathClick=function(e){var t=r.props.user;l.logDropdownSearchAction({result:e,user:t,action_type:h.WebUserActionLogEvent.CLICK_PATH_LINK,viewport:"dropdown-view"});var s=o.parent_dir(e.fq_path),a=n.browse_uri_for_fq_path(t,s||"").toString();i.open_tab(a)},r}return t.__extends(r,e),r.prototype.renderSearchBar=function(){return this.props.showSearchBar&&this.props.user?s.createElement(c.SearchBarController,{user:this.props.user,currentPath:this.props.currentPath,isExpanded:this.props.isSearchBarExpanded,onSearch:this.props.onSearch||this.onSearch,onCancelSearch:this.props.onCancelSearch,onSearchResultOpen:this.props.onSearchResultOpen||this.logSearchResultOpen,onSlimSearchResultOpen:this.props.onSearchResultOpen?void 0:this.onSlimSearchResultOpen,onResultObjectPathClick:this.props.onResultObjectPathClick||this.onResultObjectPathClick,searchBarExperiments:this.props.searchBarExperiments||{}}):null},r.prototype.renderRightContent=function(){return this.props.rightContent?this.props.rightContent:s.createElement("div",{className:"top-menu-container--search-bar-empty-space"})},r.prototype.render=function(){return s.createElement("div",{className:"top-menu-container "+this.props.classNames},this.renderSearchBar(),this.renderRightContent())},r.defaultProps={showSearchBar:!0,isSearchBarExpanded:!1,classNames:"",currentPath:"/"},r})(s.Component);r.TopMenuContainer=d(p,["/static/css/pagelet-vflBp79rc.css"],[c.SearchBarController])}),define("modules/clean/react/prompt/legacy_ha_wrapper",["require","exports","tslib","external/react","modules/clean/upsell/prompt_event_emitter"],function(e,r,t,s,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.emitUpdateEvent=function(){n.Emitter.emit(n.Events.REACT_HA_DID_UPDATE)},r.prototype.componentDidMount=function(){r.emitUpdateEvent()},r.prototype.componentDidUpdate=function(){r.emitUpdateEvent()},r.prototype.render=function(){return s.createElement("div",null)},r.displayName="LegacyHAWrapper",r})(s.Component);r.LegacyHAWrapper=o}),define("modules/clean/search/api_helpers",["require","exports"],function(e,r){"use strict";function t(){return(new Date).getTimezoneOffset()}Object.defineProperty(r,"__esModule",{value:!0}),r.getCurrentTimezoneOffset=t}),define("modules/clean/search/constants",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MaxResults={MAX_SEARCH_SUGGESTIONS:8,MAX_SEARCH_RESULTS:100},r.FOCUS_SEARCH_BAR_ACTION="search__FOCUS_SEARCH_BAR",r.BLUR_SEARCH_BAR_ACTION="search__BLUR_SEARCH_BAR",r.SET_SEARCH_QUERY_ACTION="search__SET_SEARCH_QUERY",r.SET_SEARCH_SUGGESTIONS_ACTION="search__SET_SEARCH_SUGGESTIONS",r.SET_SLIM_SEARCH_SUGGESTIONS_ACTION="search__SET_SLIM_SEARCH_SUGGESTIONS",r.SET_HIGHLIGHTED_ROW_ACTION="search__SET_HIGHLIGHTED_ROW",r.HIGHLIGHT_PREVIOUS_ROW_ACTION="search__HIGHLIGHT_PREVIOUS_ROW",r.HIGHLIGHT_NEXT_ROW_ACTION="search__HIGHLIGHT_NEXT_ROW",r.CLEAR_SEARCH_BAR_ACTION="search__CLEAR_SEARCH_BAR",r.SEARCH_SUCCESSFUL_ACTION="search__SEARCH_SUCCESSFUL",r.CLEAR_ALL_HISTORY_ACTION="search__CLEAR_ALL_HISTORY",r.START_SEARCH_ACTION="search__START_SEARCH",r.SET_SEARCH_RESULTS_ACTION="search__SET_SEARCH_RESULTS",r.CONTINUE_SEARCH_ACTION="search__CONTINUE_SEARCH",r.APPEND_SEARCH_RESULTS_ACTION="search__APPEND_SEARCH_RESULTS",r.SET_FULL_SEARCH_RESULTS_ACTION="search__SET_FULL_SEARCH_RESULTS_ACTION",r.CLEAR_SEARCH_ACTION="search__CLEAR_SEARCH",r.SET_SEARCH_SELECTION_ACTION="search__SET_SEARCH_SELECTION",r.CHANGE_FILES_ACTION="search__CHANGE_SEARCH_FILES",r.SET_SCOPE_CHIP_ACTION="search__SET_SCOPE_CHIP_ACTION",r.FULLTEXT_SEARCH_ENDPOINT="/ajax_fulltext_search",r.PARTIAL_SEARCH_METASERVER_ENDPOINT="/ajax_fulltext_search_partial_result",r.PARTIAL_SEARCH_FRONTEND_SERVICE_ENDPOINT="/search/full_search_result",r.SEARCH_METADATA_ENDPOINT="/search/search_metadata";(function(e){e.LOADED="LOADED",e.LOADING_FIRST_PAGE="LOADING_FIRST_PAGE",e.LOADING_ADDITIONAL_PAGE="LOADING_ADDITIONAL_PAGE"})(r.SearchLoadingState||(r.SearchLoadingState={})),r.SEARCH_RECENT_HISTORY_CAPACITY=5,r.SEARCH_RECENT_HISTORY_STORAGE_KEY="search_recent_history"}),define("modules/clean/search/logger",["require","exports","tslib","modules/clean/analytics","modules/clean/search/api_helpers","modules/clean/react/browse/logger_util"],function(e,r,t,s,n,o){"use strict";function a(e){var r=e.searchSessionId,a=e.result,i=e.user,c=e.action_type,l=e.search_type,_=e.viewport,u=void 0===_?"full-view":_,d=e.view_type,h=(e.latency,e.displayed,n.getCurrentTimezoneOffset()),p={viewport:u,action_type:c,search_type:l,search_session_id:r,view_type:d,position:a.sort_rank,request_id:a.request_id,timezone_offset:h};if(o.isFile(a)){var E=a;p=t.__assign({},p,{file_nsid:E.ns_id,file_sjid:E.sjid,match_type:E.match_type})}else if(o.isPaper(a)){var S=a;p=t.__assign({},p,{paper_pad_id:S.pad_id,position:S.sort_rank,request_id:S.request_id})}else if(o.isPaperFolder(a)){var m=a;p=t.__assign({},p,{paper_folder_id:m.folder_id,position:m.sort_rank,request_id:m.request_id})}s.SearchClientActivityLogger.log("result_action",i.id,p)}function i(e){var r=e.searchSessionId,t=e.user,o=e.history,a=n.getCurrentTimezoneOffset(),i=o.map(function(e){return e.rawQuery}).reduce(function(e,r,t){return e[t]=r,e},{}),c={search_session_id:r,recent_history_map:JSON.stringify(i),timezone_offset:a,viewport:"dropdown-view"};s.SearchClientActivityLogger.log("recent_history_displayed",t.id,c)}function c(e){var r=e.searchSessionId,t=e.user,o=n.getCurrentTimezoneOffset(),a={search_session_id:r,timezone_offset:o,viewport:"dropdown-view"};s.SearchClientActivityLogger.log("recent_history_cleared",t.id,a)}function l(e){var r=e.searchSessionId,t=e.query,o=e.user,a=e.rank,i=e.action_type,c=n.getCurrentTimezoneOffset(),l={search_session_id:r,query_string:t.rawQuery,position:a,timezone_offset:c,viewport:"dropdown-view",action_type:i};s.SearchClientActivityLogger.log("recent_query_selected",o.id,l)}function _(e){var r=e.searchSessionId,t=e.requestId,o=e.query,a=e.user,i=e.previousPosition,c=e.viewport,l=void 0===c?"dropdown-view":c,_=n.getCurrentTimezoneOffset(),u={search_session_id:r,request_id:t,query_string:o.rawQuery,position:i,timezone_offset:_,viewport:l};s.SearchClientActivityLogger.log("recent_query_stored",a.id,u)}function u(e){var r=e.searchSessionId,t=e.user,o=e.chipAdded,a=e.filePath,i=e.searchType,c=e.viewport,l=n.getCurrentTimezoneOffset(),_={search_session_id:r,timezone_offset:l,path_scoped:o,file_path:a,viewport:c,search_type:i};s.SearchClientActivityLogger.log("scope_chip_changed",t.id,_)}function d(e){var r=e.searchSessionId,t=e.user,o=n.getCurrentTimezoneOffset(),a={search_session_id:r,timezone_offset:o};s.SearchClientActivityLogger.log("search_bar_focus_lost",t.id,a)}function h(e,r){var s=e;return t.__assign({},r,{file_nsid:s.ns_id,file_sjid:s.sjid,match_type:s.match_type||void 0})}function p(e){var r=e.searchSessionId,t=e.result,o=e.user,a=e.previewRequestId,i=e.viewport,c=void 0===i?"dropdown-view":i,l=n.getCurrentTimezoneOffset(),_={search_session_id:r,preview_request_id:a,timezone_offset:l,viewport:c};s.SearchClientActivityLogger.log("preview_started",o.id,h(t,_))}function E(e){var r=e.searchSessionId,t=e.result,o=e.user,a=e.previewRequestId,i=e.viewport,c=void 0===i?"dropdown-view":i,l=e.latency,_=e.displayed,u=n.getCurrentTimezoneOffset(),d={search_session_id:r,preview_request_id:a,timezone_offset:u,viewport:c,latency:l,displayed:_?"true":"false"};s.SearchClientActivityLogger.log("preview_completed",o.id,h(t,d))}function S(e){var r=e.searchSessionId,t=e.result,o=e.user,a=e.previewRequestId,i=e.viewport,c=void 0===i?"dropdown-view":i,l=e.failureType,_=n.getCurrentTimezoneOffset(),u={search_session_id:r,preview_request_id:a,timezone_offset:_,viewport:c,failure_type:l};s.SearchClientActivityLogger.log("preview_failed",o.id,h(t,u))}Object.defineProperty(r,"__esModule",{value:!0}),r.logSearchAction=a,r.logRecentHistoryDisplayed=i,r.logRecentHistoryCleared=c,r.logRecentQuerySelected=l,r.logRecentQueryStored=_,r.logScopeChipChanged=u,r.logSearchBarFocusLost=d,r.logHoverPreviewStarted=p,r.logHoverPreviewCompleted=E,r.logHoverPreviewFailed=S}),define("modules/clean/search/models",["require","exports","external/deep-freeze","modules/clean/react/browse/models"],function(e,r,t,s){"use strict";function n(e){return new s.BrowseContext({isInFolderMode:e.inside_dir,inactiveNSIDByFQPath:e.old_path_to_ns_id,blockHash:e.block_hash})}Object.defineProperty(r,"__esModule",{value:!0});var o=(function(){function e(e){this.fq_path=e.fq_path,this.is_unmounted=e.is_unmounted,this.icon=e.icon,this.filename_highlights=e.filename_highlights,this.highlight_spans=e.highlight_spans,this.ns_id=e.ns_id,this.sjid=e.sjid,this.is_dir=e.is_dir,this.is_symlink=e.is_symlink,this.type=e.type,this.match_type=e.match_type,this._mount_access_perms=e.mount_access_perms,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.hover_preview_url=e.hover_preview_url,this.request_id=e.request_id,this.sort_rank=e.sort_rank,t(this)}return e.fromServerObject=function(r){return new e(r)},e})();r.SlimFileSearchResult=o,r.extractBrowseContext=n}),define("modules/clean/search/search_bar/api",["require","exports","tslib","modules/clean/ajax","modules/clean/filepath","modules/clean/search/constants","modules/clean/analytics","modules/clean/react/browse/models","modules/clean/search/types","modules/clean/search/models","modules/clean/search/api_helpers"],function(e,r,t,s,n,o,a,i,c,l,_){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=(function(e){function r(r){var t=this.constructor,s=this,n=t.prototype;return s=e.call(this,r)||this,s.__proto__=n,s}return t.__extends(r,e),r})(Error);r.RequestAbortedError=u;var d=(function(){function e(){this._searchApiUrl="/search/dropdown_search",this._activeRequest=null}return e.prototype.getSearchApiUrl=function(){return this._searchApiUrl},e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype._extractSlimSearchResultsList=function(e){for(var r=[],t=0,s=e;t<s.length;t++){var n=s[t];switch(n.search_result_type){case c.SearchResultTypes.FILE:r.push(l.SlimFileSearchResult.fromServerObject(n));break;case c.SearchResultTypes.PAPER:r.push(i.Paper.fromServerObject(n));break;case c.SearchResultTypes.PAPER_FOLDER:r.push(i.PaperFolder.fromServerObject(n))}}return r},e.prototype.loadSlimResults=function(e){var r=e.user,t=e.path,s=e.query,n=e.searchSessionId,o=e.experiments,a=e.webTimer,i=_.getCurrentTimezoneOffset(),c=o.expDropdownThumbnail,l=o.expPaperFolders,u=o.expShowSymlinkIcon,d={query:s,fq_path:t,timezone_offset:i,thumbnail_exp_variant:c,show_paper_folder_results:l,show_symlink_icon:u};return this._fetchSlimResults(d,r,n,a)},e.prototype.fetchAdditionalFileMetadata=function(e){var r=this,t=e.searchResults,n=e.user;return new Promise(function(e,a){var i=t.filter(function(e){return e instanceof l.SlimFileSearchResult}),c=i.map(function(e){return[e.ns_id,e.sjid]});c.length>0?s.WebRequest({url:o.SEARCH_METADATA_ENDPOINT,data:{nsid_sjid_pairs:JSON.stringify(c)},dataType:"json",subject_user:n,success:function(s,n,o){e(r._mergeFullResultsIntoSlimResults(s.search_results,t))},error:function(e,r,t){a("abort"===t?new u:new Error(t))}}):e(t)})},e.prototype._mergeFullResultsIntoSlimResults=function(e,r){for(var s=[],o=function(r){if(r instanceof l.SlimFileSearchResult){var o=e.find(function(e){return e.search_result_type===c.SearchResultTypes.FILE&&n.paths_are_equal(e.fq_path,r.fq_path)});o&&s.push(i.File.fromServerObject(t.__assign({},o,{request_id:r.request_id,sort_rank:r.sort_rank,match_type:r.match_type})))}else(r instanceof i.Paper||r instanceof i.PaperFolder)&&s.push(r)},a=0,_=r;a<_.length;a++){o(_[a])}return s},e.prototype._fetchSlimResults=function(e,r,t,n){var o=this;return new Promise(function(i,c){var _;null!=o._activeRequest&&o._activeRequest.abort();var d={path_scoped:"/"!==e.fq_path,search_type:"dropdown",query_string:e.query,search_session_id:t,timezone_offset:e.timezone_offset};a.SearchClientActivityLogger.log("query_started",r.id,d);var h=(new Date).getTime();o._activeRequest=s.WebRequest({url:o._searchApiUrl,data:e,dataType:"json",subject_user:r,success:function(s,c,_){for(var u=l.extractBrowseContext(s),p=s.search_results,E=_.getResponseHeader("x-dropbox-request-id"),S=0,m=0,f=p;m<f.length;m++){var T=f[m];T.request_id=E,T.sort_rank=S++}var R=o._extractSlimSearchResultsList(p),C=a.SearchClientActivityLogger.create_search_log_dict(d,E,h,e.query,R.length,null,t);a.SearchClientActivityLogger.log("query_completed",r.id,C),n&&n.end(E?E:void 0),i({context:u,searchResults:R,deleted:!1})},error:function(s,o,i){_=s.getResponseHeader("x-dropbox-request-id");var l=a.SearchClientActivityLogger.create_search_log_dict(d,_,h,e.query,null,o,t);a.SearchClientActivityLogger.log("query_failed",r.id,l),n&&n.abort(),c("abort"===i?new u:new Error(i))},complete:function(){this._activeRequest=null}})})},e})();r.SearchBarApiClient=d,r.searchBarApiClient=new d}),define("modules/clean/search/search_bar/chips",["require","exports","modules/clean/filepath"],function(e,r,t){"use strict";function s(e){return t.paths_are_equal(e,"/")}function n(e){return!!e&&!s(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.isScopeChipRoot=s,r.isValidPathForChip=n}),define("modules/clean/search/search_bar/controller",["require","exports","tslib","external/react","external/react-redux","modules/clean/keycode","modules/clean/react/browse/models","modules/clean/search/logger","modules/clean/search/search_bar/api","modules/clean/search/search_bar/data/action_creators","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/log_helper","modules/clean/search/search_bar/view","modules/clean/search/search_helpers","modules/clean/search/search_bar/chips","modules/clean/storage","modules/clean/viewer","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/notify","modules/clean/search/types","modules/clean/react/css","modules/clean/search/search_helpers"],function(e,r,t,s,n,o,a,i,c,l,_,u,d,h,p,E,S,m,f,T,R,C,A,g){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var O=(function(e){function r(r){var t=e.call(this,r)||this;return t._searchBarWebTimer=null,t._logHistoryItemSelected=function(e,r,s){i.logRecentQuerySelected({searchSessionId:t.props.searchSessionId,query:e,user:t.props.user,rank:r-t.props.headerItems.length,action_type:s})},t._handleHistoryItemClick=function(e,r){t._logHistoryItemSelected(e,r),t._setSearchQuery(e.rawQuery)},t._handleRecentSearchContextMenuCapture=function(e,r){t._logHistoryItemSelected(e,r,T.WebUserActionLogEvent.CONTEXT_MENU)},t._handleInputChange=function(e){t._setSearchQuery(e.currentTarget.value)},t._handleCancelSearch=function(){t._setSearchQuery("")},t._handleScopeChipChange=function(e){i.logScopeChipChanged({searchSessionId:t.props.searchSessionId,user:t.props.user,chipAdded:e,searchType:"dropdown",filePath:e?t.props.browseScope:"/",viewport:t.props.isExpanded?"full-view":void 0}),e?t.props.setScopeChip({scopeChip:t.props.browseScope}):t.props.setScopeChip({}),t._setSearchQuery(t.props.rawQuery,!0)},t._handleDeletedChipChange=function(e){t.props.setDeletedChip({deletedChip:e}),t._setSearchQuery(t.props.rawQuery,!0)},t._onBrowseScopeChange=function(e){t.props.setScopeChip({scopeChip:E.isValidPathForChip(e)?e:void 0})},t._handleInputKeydown=function(e,r){if(e.keyCode===o.KeyCode.ESC){t._handleCancelSearch();var s=t.props.onCancelSearch;return void(s&&s())}if(e.keyCode===o.KeyCode.BACKSPACE&&0===r){if(!E.isScopeChipRoot(t.props.scopeChip))return void t._handleScopeChipChange(!1);if(t.props.deletedChip)return void t._handleDeletedChipChange(!1)}e.stopPropagation(),e.keyCode===o.KeyCode.UP?(e.preventDefault(),t.props.highlightPreviousRow()):e.keyCode===o.KeyCode.DOWN&&(e.preventDefault(),t.props.highlightNextRow())},t._handleSearch=function(e){t.props.onSearch({query:e,searchToken:p.getSearchCsrfToken(),searchSessionId:t.props.searchSessionId,searchPath:t.props.scopeChip,qargs:{d:g.isInDeletedFilterRightRailExperiment(t.props.searchBarExperiments)?t.props.deletedChip?"1":"0":void 0}})},t._navToSelection=function(e,r){var s=t.props.searchSuggestions[e-r],n=t.props.slimSearchSuggestions[e-r];s?(t._handleSlimSearchResultOpen(n),t._openSearchResult(s)):t._handleSearchResultOpen(n)},t._handleInputSubmit=function(e,r){e.preventDefault();var s=t.props.headerItems;if(r<s.length)switch(s[r]){case C.SearchBarDropdownHeaderItemType.SEARCH_ALL:t._handleSearch(t.props.normalizedQuery);break;case C.SearchBarDropdownHeaderItemType.SCOPE_CHIPS:var n=!E.isValidPathForChip(t.props.scopeChip);t._handleScopeChipChange(n)}else t._navToSelection(r,s.length)},t._handleContextMenuCapture=function(e){var r=t.props,s=r.user,n=r.searchSessionId;p.fetchFullSearchResult({searchBarApiClient:c.searchBarApiClient,searchResult:e,user:s,onSuccess:function(e){t._dispatchSearchSuccessful(e.request_id||""),d.logDropdownSearchAction({result:e,user:s,action_type:e instanceof a.File?T.WebUserActionLogEvent.CONTEXT_MENU:T.WebUserActionLogEvent.PAPER_CONTEXT_MENU,viewport:"dropdown-view",searchSessionId:n})}})},t._handleSlimSearchResultOpen=function(e){var r=t.props.onSlimSearchResultOpen;r&&r(e)},t._handleSearchResultOpen=function(e){var r=t.props.user;t._handleSlimSearchResultOpen(e),p.fetchFullSearchResult({searchBarApiClient:c.searchBarApiClient,searchResult:e,user:r,onSuccess:function(e){t._openSearchResult(e)},onError:function(e){R.Notify.error(e)}})},t._handleResultObjectPathClick=function(e){t._dispatchSearchSuccessful(e.request_id||""),t.props.onResultObjectPathClick(e)},t._handleHighlightDropdownItem=function(e){t.props.setHighlightedRow({highlightedSearchRow:e})},t._handleSearchBarFocus=function(){var e=t.props.user;t.props.focusSearchBar({user:e})},t._handleSearchBarBlur=function(){t.props.blurSearchBar()},t._dispatchSearchSuccessful=function(e){var r=t.props,s=r.user,n=r.rawQuery,o=r.normalizedQuery,a=r.searchSessionId;(0,r.addQueryToHistory)({user:s,query:{rawQuery:n,normalizedQuery:o},searchSessionId:a,requestId:e})},t._logSearchBarTTI=function(){t._searchBarWebTimer&&t._searchBarWebTimer.markTimeToInteractive()},t._handleHistoryClearAllClick=function(){var e=t.props,r=e.user;(0,e.clearAllHistory)({user:r})},r.setExperiments({experiments:r.searchBarExperiments}),t.props.setScopeChip({scopeChip:r.currentPath}),t}return t.__extends(r,e),r.prototype.componentWillMount=function(){var e=m.Viewer.get_viewer().get_users().map(function(e){return e.id});S.UserLocalStorage.clearOtherUsers(e)},r.prototype.componentWillUnmount=function(){this._logFocusLost(this.props.isFocused,!1)},r.prototype.componentWillReceiveProps=function(e){this.props.currentPath!==e.currentPath&&this._onBrowseScopeChange(e.currentPath),this.props.searchBarExperiments!==e.searchBarExperiments&&this.props.setExperiments({experiments:e.searchBarExperiments})},r.prototype.componentDidUpdate=function(e){this._logFocusLost(e.isFocused,this.props.isFocused)},r.prototype._logFocusLost=function(e,r){e&&!r&&i.logSearchBarFocusLost({user:this.props.user,searchSessionId:this.props.searchSessionId})},r.prototype._setSearchQuery=function(e,r){void 0===r&&(r=!1);var t=this.props,s=t.user;(0,t.setSearchQueryAndFetchResults)({user:s,query:e,webTimer:this._startSearchBarTimer(),keepHighlightedRow:r})},r.prototype._openSearchResult=function(e){this._dispatchSearchSuccessful(e.request_id||""),this.props.onSearchResultOpen(e)},r.prototype._startSearchBarTimer=function(){return this._searchBarWebTimer?this._searchBarWebTimer.restart():(this._searchBarWebTimer=f.get_timer("search_bar"),this._searchBarWebTimer.initialize({requireTTI:!0,requireTTV:!1,url:c.searchBarApiClient.getSearchApiUrl()})),this._searchBarWebTimer},r.prototype.render=function(){var e=this.props,r=e.user,t=e.isExpanded,n=e.placeholder,o=e.isFocused,a=e.isActive,i=e.rawQuery,c=e.normalizedQuery,l=e.slimSearchSuggestions,_=e.searchBarLoading,u=e.searchSessionId,d=e.highlightedRow,E=e.searchHistory,S=e.scopeChip,m=e.deletedChip,f=e.searchPath,T=e.headerItems,R=e.searchBarExperiments,C=e.browseScope,A=this.props.deletedChipEnabled&&p.isInDeletedFilterRightRailExperiment(R);return s.createElement(h.SearchBarView,{user:r,isExpanded:t,searchBarExperiments:R,placeholder:n,isFocused:o,isActive:a,rawQuery:i,normalizedQuery:c,suggestions:l,searchBarLoading:_,searchSessionId:u,highlightedRow:d,searchHistory:E,scopeChip:S,deletedChip:m,enableDeletedChip:A,browseScope:C,searchPath:f,dropdownHeaderItems:T,onSearch:this._handleSearch,onHistoryClearAllClick:this._handleHistoryClearAllClick,onHistoryItemClick:this._handleHistoryItemClick,onInputChange:this._handleInputChange,onInputKeydown:this._handleInputKeydown,onInputSubmit:this._handleInputSubmit,onSearchResultOpen:this._handleSearchResultOpen,onContextMenuCapture:this._handleContextMenuCapture,onRecentSearchContextMenuCapture:this._handleRecentSearchContextMenuCapture,onResultObjectPathClick:this._handleResultObjectPathClick,onSearchBarFocus:this._handleSearchBarFocus,onSearchBarBlur:this._handleSearchBarBlur,onHighlightDropdownItem:this._handleHighlightDropdownItem,onSearchChipInteraction:this._handleScopeChipChange,onDeletedChipInteraction:this._handleDeletedChipChange,onDropdownTTI:this._logSearchBarTTI,onDismissUpsell:this.props.dismissUpsell,showUpsell:this.props.showUpsell})},r})(s.PureComponent);r.SearchBarControllerElement=O;var I=u.getStoreForSearchBar(),y=function(e){var r=_.isSearchBarFocused,t=_.isSearchBarActive,s=_.rawQuery,n=_.normalizedQuery,o=_.searchSuggestions,a=_.slimSearchSuggestions,i=_.isSearchBarLoading,c=_.searchSessionId,l=_.highlightedSearchRow,u=_.searchHistory,d=_.scopeChip,h=_.deletedChip,p=_.deletedChipEnabled,E=_.searchPath,S=_.headerItems,m=_.browseScope,f=_.showUpsell;return{isFocused:r(e),isActive:t(e),rawQuery:s(e),normalizedQuery:n(e),searchSuggestions:o(e),slimSearchSuggestions:a(e),searchBarLoading:i(e),searchSessionId:c(e),highlightedRow:l(e),searchHistory:u(e),scopeChip:d(e),deletedChip:h(e),deletedChipEnabled:p(e),searchPath:E(e),headerItems:S(e),browseScope:m(e),showUpsell:f(e)}},D={blurSearchBar:l.blurSearchBar,focusSearchBar:l.focusSearchBar,highlightPreviousRow:l.highlightPreviousRow,highlightNextRow:l.highlightNextRow,setHighlightedRow:l.setHighlightedRow,addQueryToHistory:l.addQueryToHistory,setSearchQueryAndFetchResults:l.setSearchQueryAndFetchResults,clearAllHistory:l.clearAllHistory,setExperiments:l.setExperiments,setScopeChip:l.setScopeChip,setDeletedChip:l.setDeletedChip,dismissUpsell:l.dismissUpsell},v=n.connect(y,D)(O),L=function(e){return s.createElement(n.Provider,{store:I},s.createElement(v,t.__assign({},e)))};r.SearchBarController=A(L,["/static/css/search/search_bar_react-vflPFfhax.css"])}),define("modules/clean/search/search_bar/data/action_creators",["require","exports","tslib","modules/clean/search/search_bar/api","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/types","modules/clean/search/search_bar/history","modules/core/exception"],function(e,r,t,s,n,o,a,i){"use strict";var c=this;Object.defineProperty(r,"__esModule",{value:!0}),r.focusSearchBar=function(e){var t=e.user;return function(e){e(r.updateHistoryInternal({searchHistory:a.getHistory(t)})),e(r.focusSearchBarActionInternal())}},r.focusSearchBarActionInternal=function(){return{type:o.ActionTypes.FOCUS}},r.blurSearchBar=function(){return{type:o.ActionTypes.BLUR}},r.clearSearchBar=function(){return{type:o.ActionTypes.CLEAR}},r.updateHistoryInternal=function(e){var r=e.searchHistory;return{type:o.ActionTypes.UPDATE_HISTORY,payload:{searchHistory:r}}},r.addQueryToHistory=function(e){var t=e.user,s=e.query,n=e.searchSessionId,o=e.requestId;return function(e,i){var c=a.addQuery(t,s,n,o);e(r.updateHistoryInternal({searchHistory:c}))}},r.clearAllHistory=function(e){var t=e.user;return function(e,s){var n=a.clearAll(t);e(r.updateHistoryInternal({searchHistory:n}))}},r.setSearchQuery=function(e){var r=e.query,t=e.searchSessionId,s=e.keepHighlightedRow,n=e.searchPath;return{type:o.ActionTypes.SET_QUERY,payload:{query:r,searchSessionId:t,keepHighlightedRow:s,searchPath:n}}},r.setSearchSuggestions=function(e){var r=e.searchSuggestions,t=e.hasMoreResults;return{type:o.ActionTypes.SET_SUGGESTIONS,payload:{searchSuggestions:r,hasMoreResults:t}}},r.setSlimSearchSuggestions=function(e){var r=e.slimSearchSuggestions,t=e.hasMoreResults;return{type:o.ActionTypes.SET_SLIM_SUGGESTIONS,payload:{slimSearchSuggestions:r,hasMoreResults:t}}},r.setHighlightedRow=function(e){var r=e.highlightedSearchRow;return{type:o.ActionTypes.SET_HIGHLIGHTED_ROW,payload:{highlightedSearchRow:r}}},r.highlightPreviousRow=function(){return{type:o.ActionTypes.HIGHLIGHT_PREVIOUS_ROW}},r.highlightNextRow=function(){return{type:o.ActionTypes.HIGHLIGHT_NEXT_ROW}},r.setBrowseScope=function(e){var r=e.browseScope;return{type:o.ActionTypes.SET_BROWSE_SCOPE,payload:{browseScope:r}}},r.setScopeChip=function(e){var r=e.scopeChip;return{type:o.ActionTypes.SET_SCOPE_CHIP,payload:{scopeChip:r}}},r.setDeletedChip=function(e){var r=e.deletedChip;return{type:o.ActionTypes.SET_DELETED_CHIP,payload:{deletedChip:r}}},r.setDeletedChipEnabled=function(e){var r=e.enabled;return{type:o.ActionTypes.SET_DELETED_CHIP_ENABLED,payload:{enabled:r}}},r.setSearchQueryAndFetchResults=function(o){var a=o.user,l=o.query,_=o.webTimer,u=o.searchSessionId,d=o.keepHighlightedRow;return function(o,h){return t.__awaiter(c,void 0,void 0,function(){var c,p,E,S,m,f,T;return t.__generator(this,function(t){switch(t.label){case 0:if(c=n.scopeChip(h()),(p=function(){return l===n.rawQuery(h())&&c===n.searchPath(h())})())return[2];if(o(r.setSearchQuery({query:l,searchPath:c,searchSessionId:u,keepHighlightedRow:d})),n.deletedChip(h()))return o(r.setSearchSuggestions({searchSuggestions:[],hasMoreResults:!1})),[2];if(!n.isSearchBarLoading(h()))return[3,5];E=n.experiments(h()),t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.searchBarApiClient.loadSlimResults({user:a,path:c,query:n.normalizedQuery(h()),searchSessionId:n.searchSessionId(h()),experiments:E,webTimer:_})];case 2:if(S=t.sent().searchResults,!p())return[2];if(E&&E.expShowDropdownStars)try{m=e("modules/clean/react/starred/browse_exports").checkForMissingStarredData,m({items:S,user:a})}catch(e){i.reportException({err:e,severity:i.SEVERITY.NONCRITICAL,tags:["search_bar"]})}return o(r.setSlimSearchSuggestions({slimSearchSuggestions:S})),[4,s.searchBarApiClient.fetchAdditionalFileMetadata({searchResults:S,user:a})];case 3:return f=t.sent(),p()?(o(r.setSearchSuggestions({searchSuggestions:f})),[3,5]):[2];case 4:if(T=t.sent(),!(T instanceof s.RequestAbortedError))throw T;return[3,5];case 5:return[2]}})})}},r.setExperiments=function(e){var r=e.experiments;return{type:o.ActionTypes.SET_EXPERIMENTS,payload:{experiments:r}}},r.dismissUpsell=function(){return{type:o.ActionTypes.DISMISS_UPSELL}}}),define("modules/clean/search/search_bar/data/reducer",["require","exports","tslib","modules/clean/search/search_bar/data/types","modules/clean/search/store_helpers","modules/clean/search/search_bar/chips"],function(e,r,t,s,n,o){"use strict";function a(e,r){switch(void 0===e&&(e=i),r.type){case s.ActionTypes.FOCUS:return c(e,r);case s.ActionTypes.BLUR:return l(e,r);case s.ActionTypes.UPDATE_HISTORY:return _(e,r);case s.ActionTypes.SET_QUERY:return u(e,r);case s.ActionTypes.SET_SUGGESTIONS:return d(e,r);case s.ActionTypes.SET_SLIM_SUGGESTIONS:return h(e,r);case s.ActionTypes.SET_HIGHLIGHTED_ROW:return p(e,r);case s.ActionTypes.HIGHLIGHT_PREVIOUS_ROW:return S(e,r);case s.ActionTypes.HIGHLIGHT_NEXT_ROW:return E(e,r);case s.ActionTypes.SET_BROWSE_SCOPE:return m(e,r);case s.ActionTypes.SET_SCOPE_CHIP:return f(e,r);case s.ActionTypes.SET_DELETED_CHIP:return T(e,r);case s.ActionTypes.SET_DELETED_CHIP_ENABLED:return R(e,r);case s.ActionTypes.CLEAR:return C(e,r);case s.ActionTypes.SET_EXPERIMENTS:return A(e,r);case s.ActionTypes.DISMISS_UPSELL:return g(e,r);default:return e}}Object.defineProperty(r,"__esModule",{value:!0});var i={isSearchBarFocused:!1,searchHistory:[],query:"",searchSessionId:n.generateRandomId(),searchPath:"",isSearchBarLoading:!1,searchSuggestions:[],hasMoreResults:!1,slimSearchSuggestions:[],highlightedSearchRow:0,browseScope:"/",canScope:!1,scopeChip:"/",deletedChip:!1,deletedChipEnabled:!1,experiments:{},upsellDismissed:!1},c=function(e,r){return t.__assign({},e,{highlightedSearchRow:0,isSearchBarFocused:!0})},l=function(e,r){return t.__assign({},e,{highlightedSearchRow:0,isSearchBarFocused:!1})},_=function(e,r){var s=r.payload.searchHistory;return t.__assign({},e,{searchHistory:s})},u=function(e,r){var s=r.payload,o=s.query,a=s.searchPath,i=s.searchSessionId,c=s.keepHighlightedRow,l=e.searchSessionId;i?l=i:n.shouldStartNewSearchSession(e.query,o)&&(l=n.generateRandomId())
;var _=c?e.highlightedSearchRow:0;return t.__assign({},e,{query:o,searchPath:a,searchSessionId:l,searchSuggestions:[],hasMoreResults:!1,isSearchBarLoading:!n.isBlank(o),slimSearchSuggestions:[],highlightedSearchRow:_})},d=function(e,r){var s=r.payload,n=s.searchSuggestions,o=s.hasMoreResults;return t.__assign({},e,{searchSuggestions:n,hasMoreResults:!!o,isSearchBarLoading:!1})},h=function(e,r){var s=r.payload,n=s.slimSearchSuggestions,o=s.hasMoreResults;return t.__assign({},e,{slimSearchSuggestions:n,hasMoreResults:!!o,isSearchBarLoading:!1})},p=function(e,r){var s=r.payload.highlightedSearchRow;return t.__assign({},e,{highlightedSearchRow:s})},E=function(e,r){var s=!n.isBlank(e.query),o=e.slimSearchSuggestions.length||e.searchSuggestions.length||!s&&e.searchHistory.length||0,a=0;a+=s?1:0,a+=e.canScope?1:0;var i=Math.min(o+a-1,e.highlightedSearchRow+1);return t.__assign({},e,{highlightedSearchRow:i})},S=function(e,r){return t.__assign({},e,{highlightedSearchRow:Math.max(0,e.highlightedSearchRow-1)})},m=function(e,r){var s=r.payload.browseScope,n=e.scopeChip,a=o.isValidPathForChip(s);return t.__assign({},e,{browseScope:s,canScope:a,scopeChip:a?n:"/"})},f=function(e,r){var s=r.payload.scopeChip;return t.__assign({},e,{scopeChip:s||"/"})},T=function(e,r){var s=r.payload.deletedChip;return t.__assign({},e,{deletedChip:s,searchSuggestions:[]})},R=function(e,r){var s=r.payload.enabled;return t.__assign({},e,{deletedChipEnabled:s,searchSuggestions:[]})},C=function(e,r){var s=e.scopeChip,n=e.searchHistory,o=e.browseScope,a=e.experiments;return t.__assign({},i,{scopeChip:s,searchHistory:n,browseScope:o,experiments:a})},A=function(e,r){var s=r.payload.experiments;return t.__assign({},e,{experiments:s})},g=function(e,r){return t.__assign({},e,{upsellDismissed:!0})};r.searchBarReducer=a}),define("modules/clean/search/search_bar/data/selectors",["require","exports","external/reselect","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/redux/types","modules/clean/search/search_bar/experiments","modules/clean/search/store_helpers","modules/clean/search/types","modules/clean/redux/selectors"],function(e,r,t,s,n,o,a,i,c,l){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var _=function(e){return l.getStateAtNamespace(e,o.SEARCH_BAR_NAMESPACE_KEY)};r.isSearchBarFocused=function(e){return _(e).isSearchBarFocused},r.searchHistory=function(e){return _(e).searchHistory},r.rawQuery=function(e){return _(e).query},r.normalizedQuery=function(e){return i.normalize(r.rawQuery(e))},r.searchSessionId=function(e){return _(e).searchSessionId},r.isSearchBarActive=function(e){return!!r.rawQuery(e)},r.searchPath=function(e){return _(e).searchPath},r.isSearchBarLoading=function(e){return _(e).isSearchBarLoading},r.searchSuggestions=function(e){return _(e).searchSuggestions},r.hasMoreResults=function(e){return _(e).hasMoreResults},r.slimSearchSuggestions=function(e){return _(e).slimSearchSuggestions},r.highlightedSearchRow=function(e){return _(e).highlightedSearchRow},r.searchResultForPath=function(e,t){return r.searchSuggestions(e).find(function(e){return e instanceof n.File&&s.paths_are_equal(e.fq_path,t)})},r.browseScope=function(e){return _(e).browseScope},r.scopeChip=function(e){return _(e).scopeChip},r.canScope=function(e){return _(e).canScope},r.deletedChip=function(e){return _(e).deletedChip},r.deletedChipEnabled=function(e){return _(e).deletedChipEnabled},r.experiments=function(e){return _(e).experiments},r.upsellDismissed=function(e){return _(e).upsellDismissed},r.showUpsell=t.createSelector(r.experiments,r.upsellDismissed,r.normalizedQuery,r.searchSuggestions,r.slimSearchSuggestions,r.isSearchBarLoading,function(e,r,t,s,n,o){return a.dropdownUpsellEnabled(e)&&!!t&&!o&&!r&&!s.length&&!n.length}),r.headerItems=t.createSelector(r.normalizedQuery,r.canScope,r.showUpsell,r.deletedChipEnabled,function(e,r,t,s){var n=""!==e,o=[];return n&&o.push(c.SearchBarDropdownHeaderItemType.SEARCH_ALL),s?o.push(c.SearchBarDropdownHeaderItemType.DELETED_FILES):r&&o.push(c.SearchBarDropdownHeaderItemType.SCOPE_CHIPS),t&&o.push(c.SearchBarDropdownHeaderItemType.SEARCH_UPSELL),o})}),define("modules/clean/search/search_bar/data/store",["require","exports","modules/clean/redux/store","modules/clean/redux/types","modules/clean/search/search_bar/data/reducer"],function(e,r,t,s,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o;r.getStoreForSearchBar=function(){return o||(o=t.getStoreAndRegisterReducers((e={},e[s.SEARCH_BAR_NAMESPACE_KEY]=n.searchBarReducer,e))),o;var e}}),define("modules/clean/search/search_bar/data/types",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e.FOCUS="SEARCH_BAR/FOCUS",e.BLUR="SEARCH_BAR/BLUR",e.CLEAR="SEARCH_BAR/CLEAR",e.UPDATE_HISTORY="SEARCH_BAR/UPDATE_HISTORY",e.SET_QUERY="SEARCH_BAR/SET_QUERY",e.SET_SUGGESTIONS="SEARCH_BAR/SET_SUGGESTIONS",e.SET_SLIM_SUGGESTIONS="SEARCH_BAR/SET_SLIM_SUGGESTIONS",e.SET_HIGHLIGHTED_ROW="SEARCH_BAR/SET_HIGHLIGHTED_ROW",e.HIGHLIGHT_PREVIOUS_ROW="SEARCH_BAR/HIGHLIGHT_PREVIOUS_ROW",e.HIGHLIGHT_NEXT_ROW="SEARCH_BAR/HIGHLIGHT_NEXT_ROW",e.SET_BROWSE_SCOPE="SEARCH_BAR/SET_BROWSE_SCOPE",e.SET_SCOPE_CHIP="SEARCH_BAR/SET_SCOPE_CHIP",e.SET_DELETED_CHIP="SEARCH_BAR/SET_DELETED_CHIP",e.SET_DELETED_CHIP_ENABLED="SEARCH_BAR/SET_DELETED_CHIP_ENABLED",e.SET_EXPERIMENTS="SEARCH_BAR/SET_EXPERIMENTS",e.DISMISS_UPSELL="SEARCH_BAR/DISMISS_UPSELL"})(r.ActionTypes||(r.ActionTypes={}))}),define("modules/clean/search/search_bar/experiments",["require","exports","modules/clean/search/types"],function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.dropdownUpsellEnabled=function(e){var r=e.expSearchDropdownUpsell;return r===t.DropdownUpsellVariants.V1||r===t.DropdownUpsellVariants.V2}}),define("modules/clean/search/search_bar/history",["require","exports","external/lodash","modules/clean/search/constants","modules/clean/storage","modules/clean/search/logger"],function(e,r,t,s,n,o){"use strict";function a(e){return n.UserLocalStorage.get(e.id,s.SEARCH_RECENT_HISTORY_STORAGE_KEY)||[]}function i(e,r,i,c){void 0===i&&(i=""),void 0===c&&(c="");var l=a(e),_=function(e,r){return e.normalizedQuery===r.normalizedQuery},u=t.findIndex(l,function(e){return _(e,r)});return o.logRecentQueryStored({searchSessionId:i,requestId:c,query:r,user:e,previousPosition:u}),l=l.filter(function(e){return!_(e,r)}),l=[r].concat(l).slice(0,s.SEARCH_RECENT_HISTORY_CAPACITY),n.UserLocalStorage.set(e.id,s.SEARCH_RECENT_HISTORY_STORAGE_KEY,l),l}function c(e,r){void 0===r&&(r=""),o.logRecentHistoryCleared({searchSessionId:r,user:e});var t=[];return n.UserLocalStorage.set(e.id,s.SEARCH_RECENT_HISTORY_STORAGE_KEY,t),t}function l(){n.UserLocalStorage.clearOtherUsers([])}function _(){n.UserLocalStorage.clearOtherUsers([])}Object.defineProperty(r,"__esModule",{value:!0}),r.getHistory=a,r.addQuery=i,r.clearAll=c,r.testMockSetup=l,r.testMockTeardown=_}),define("modules/clean/search/search_bar/log_helper",["require","exports","modules/clean/search/logger","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/selectors"],function(e,r,t,s,n){"use strict";function o(e){var r=e.result,o=e.user,a=e.action_type,i=e.viewport,c=e.view_type,l=e.searchSessionId;t.logSearchAction({searchSessionId:l||n.searchSessionId(s.getStoreForSearchBar().getState()),result:r,user:o,action_type:a,search_type:"dropdown",viewport:i,view_type:c})}Object.defineProperty(r,"__esModule",{value:!0}),r.logDropdownSearchAction=o}),define("modules/clean/search/search_bar/view",["require","exports","tslib","external/classnames","spectrum/icon_global","spectrum/icon_content","spectrum/icon_action/index","external/react","modules/clean/keycode","modules/clean/react/maestro/a11y_constants","modules/clean/search/types","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/search/search_bar/chips","modules/clean/filepath","modules/clean/em_string","modules/clean/react/title_bubble","modules/clean/search/search_helpers","modules/clean/search/search_helpers"],function(e,r,t,s,n,o,a,i,c,l,_,u,d,h,p,E,S,m,f){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var T=(function(r){function n(){var e=null!==r&&r.apply(this,arguments)||this;return e._renderDropdown=function(){},e._handleNavigation=function(){e._searchBarInput.blurSearchBarTextInput()},e._onHistoryItemClick=function(r,t){e.props.onHistoryItemClick&&e.props.onHistoryItemClick(r,t)},e._onSearchResultOpen=function(r){e.props.onSearchResultOpen(r),e._handleNavigation()},e._onResultObjectPathClick=function(r){e.props.onResultObjectPathClick(r),e._handleNavigation()},e._onSearch=function(r){var t=e.props.onSearch;t&&t(r),e._handleNavigation()},e._setSearchBarInputRef=function(r){return e._searchBarInput=r},e._setSearchBarDropdownRef=function(r){e._searchBarDropdown=r},e}return t.__extends(n,r),n.prototype.getSearchBarInput=function(){return this._searchBarInput},n.prototype.getSearchBarDropdown=function(){return this._searchBarDropdown},n.prototype._shouldRenderDropdown=function(){var e=this.props,r=e.searchHistory,t=e.normalizedQuery,s=e.dropdownHeaderItems;return!!(r&&r.length||s&&(s.indexOf(_.SearchBarDropdownHeaderItemType.SCOPE_CHIPS)!==-1||s.indexOf(_.SearchBarDropdownHeaderItemType.DELETED_FILES)!==-1)||t&&t.length)},n.prototype.componentDidMount=function(){var r=this;d.waitForTTI().then(function(){e(["modules/clean/search/search_bar/dropdown","modules/clean/react/starred/browse_exports"],function(e,t){var s=e.SearchBarDropdown;t.Star,t.HOME_RESOURCE_ID_TYPE,t.StarredSource,t.checkForMissingStarredData;r._renderDropdown=function(){var e=r.props,t=e.browseScope,n=e.children,o=e.dropdownHeaderItems,a=e.highlightedRow,c=e.isFocused,l=e.normalizedQuery,_=e.onContextMenuCapture,u=e.onDropdownTTI,d=e.onHighlightDropdownItem,h=e.onHistoryClearAllClick,p=e.onRecentSearchContextMenuCapture,E=e.onSearchChipInteraction,S=e.scopeChip,m=e.onDeletedChipInteraction,f=e.deletedChip,T=e.enableDeletedChip,R=e.searchBarExperiments,C=e.searchBarLoading,A=e.searchHistory,g=e.searchPath,O=e.searchSessionId,I=e.showLinkToResultsPage,y=e.suggestions,D=e.user;return i.createElement(s,{browseScope:t,children:n,dropdownHeaderItems:o||[],highlightedRow:a,isOpen:c,normalizedQuery:l,onContextMenuCapture:_,onDropdownTTI:u,onHighlightDropdownItem:d,onHistoryClearAllClick:h,onHistoryItemClick:r._onHistoryItemClick,onRecentSearchContextMenuCapture:p,onResultObjectPathClick:r._onResultObjectPathClick,onSearch:r._onSearch,onSearchChipInteraction:E,onDeletedChipInteraction:m,onSearchResultOpen:r._onSearchResultOpen,onDismissUpsell:r.props.onDismissUpsell,showUpsell:r.props.showUpsell,ref:r._setSearchBarDropdownRef,scopeChip:S,deletedChip:f,enableDeletedChip:T,searchBarExperiments:R,searchBarLoading:C,searchHistory:A||[],searchPath:g,searchSessionId:O,showLinkToResultsPage:I,suggestions:y,user:D})},r._shouldRenderDropdown()&&r.forceUpdate()})})},n.prototype.render=function(){var e=this.props,r=e.isActive,n=e.isExpanded,o=e.isFocused,a=e.searchBarExperiments,c={"search-bar--container":!0,"u-l-fr":!0,"sps--search-bar--container":m.isInSinglePageSearchExperiment(a),"is-expanded":n,"is-focused":o},l={"is-active":r,"is-collapsed":!(n||o),"is-expanded":n,"is-focused":o,"search-bar":!0},_=this._shouldRenderDropdown();return i.createElement("div",{className:s(c)},i.createElement("div",{className:s(l)},i.createElement(R,t.__assign({},this.props,{shouldRenderDropdown:_,ref:this._setSearchBarInputRef})),_&&this._renderDropdown()))},n.defaultProps={rawQuery:"",normalizedQuery:"",showLinkToResultsPage:!0},n})(i.Component);r.SearchBarView=T;var R=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.focusSearchBarTextInput=function(){r.props.isFocused||r._searchBarTextInput.focus()},r._onKeyDown=function(e){e.keyCode===c.KeyCode.ESC&&r.blurSearchBarTextInput(),r.props.onInputKeydown(e,r._getCursorPosition())},r._onSubmit=function(e){var t=r.props.highlightedRow,s=r.props.searchHistory||[],n=!r.props.normalizedQuery&&s.length>0,o=r.props.dropdownHeaderItems||[],a=t-o.length;if(n&&a>=0){e.preventDefault();var i=s[a];return void(r.props.onHistoryItemClick&&r.props.onHistoryItemClick(i,a))}return t<o.length&&o[t]===_.SearchBarDropdownHeaderItemType.SCOPE_CHIPS||r.blurSearchBarTextInput(),r.props.onInputSubmit(e,t)},r._handleButtonMouseDown=function(e){r.props.rawQuery&&r.props.rawQuery.length&&(r._onSubmit(e),e.preventDefault())},r._setSearchBarTextInputRef=function(e){return r._searchBarTextInput=e},r}return t.__extends(r,e),r.prototype._getCursorPosition=function(){return this._searchBarTextInput.selectionEnd},r.prototype.getSearchBarTextInput=function(){return this._searchBarTextInput},r.prototype.blurSearchBarTextInput=function(){this._searchBarTextInput.blur(),this.props.onSearchBarBlur()},r.prototype.render=function(){var e=this.props,r=e.onInputChange,s=e.onSearchBarFocus,o=e.onSearchBarBlur,a=e.placeholder,c=e.isFocused,_=e.highlightedRow,d=e.rawQuery,h=e.shouldRenderDropdown,p=h?{"aria-expanded":c,"aria-activedescendant":"search-dropdown-suggestion"+_,"aria-autocomplete":"list","aria-owns":"search-bar__suggestions",role:"combobox"}:void 0;return i.createElement("form",{className:"search-bar__input",onSubmit:this._onSubmit},i.createElement("button",{"aria-label":u._("Search"),className:"search-bar__button",type:"submit",onMouseDown:this._handleButtonMouseDown},i.createElement(n.IconGlobal,{name:"search-small"})),i.createElement(C,t.__assign({},this.props,{focusSearchInput:this.focusSearchBarTextInput})),i.createElement("input",t.__assign({"aria-label":u._("Search")},p,{className:"search-bar__text-input",maxLength:1e3,onChange:r,onFocus:s,onBlur:o,onKeyDown:this._onKeyDown,placeholder:a?a:u._("Search"),ref:this._setSearchBarTextInputRef,value:d,tabIndex:l.LAYOUT_TAB_ORDER.SEARCH_BAR})))},r})(i.Component),C=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r._onScopeChipClosed=function(){r.props.onSearchChipInteraction&&r.props.onSearchChipInteraction(!1)},r._onDeletedChipClosed=function(){r.props.onDeletedChipInteraction&&r.props.onDeletedChipInteraction(!1)},r}return t.__extends(r,e),r.prototype.render=function(){var e=this.props,r=e.scopeChip,t=e.user,s=e.isFocused,n=e.isExpanded,c=[];if(r&&h.isValidPathForChip(r)){var l=t.cdm_tmf_path&&r&&p.paths_are_equal(t.cdm_tmf_path,r),_=l?"folder_team_member_child-small":"folder-small",d=p.child_dir(r);c.push(i.createElement(A,{key:"scope",isFocused:s,isExpanded:n,icon:i.createElement(o.IconContent,{name:_,height:"18px",width:"18px"}),text:d,onClose:this._onScopeChipClosed,onClick:this.props.focusSearchInput}))}return this.props.deletedChip&&f.isInDeletedFilterRightRailExperiment(this.props.searchBarExperiments)&&c.push(i.createElement(A,{key:"deleted",isFocused:s,isExpanded:n,icon:i.createElement(a.IconAction,{name:"delete",className:"search-bar__chip-icon--dark"}),text:u._("Deleted files"),onClose:this._onDeletedChipClosed,onClick:this.props.focusSearchInput})),c.length?i.createElement("span",null,c):null},r})(i.Component),A=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r._onMouseDownOnChipItem=function(e){e.stopPropagation(),e.preventDefault()},r._onMouseDownClose=function(e){e.stopPropagation(),e.preventDefault(),r.props.onClose()},r._onMouseDownOnChipButton=function(e){e.stopPropagation(),e.preventDefault(),r.props.onClick()},r}return t.__extends(r,e),r.prototype.render=function(){var e=this.props,r=e.isFocused,t=e.isExpanded,s=e.text,n=e.icon;if(!s)return null;var o=E.Emstring.em_snippet(s,8,.6),a=i.createElement("span",{className:"search_bar__chip_text",key:"text"},o),c=o!==s;return t||r?i.createElement("span",{className:"search_bar__chip"},i.createElement("span",{className:"search_bar__chip_item",tabIndex:0,onMouseDown:this._onMouseDownOnChipItem},n,c?i.createElement(S.TitleBubble,{content:s,position:S.TitleBubble.POSITIONS.BOTTOM,key:"text"},a):a),i.createElement("button",{type:"button","aria-label":u._("Remove filter"),className:"search_bar__chip_close_button",key:"close",onMouseDown:this._onMouseDownClose})):i.createElement("span",{className:"search_bar__chip"},i.createElement("button",{type:"button","aria-label":u._("Search"),className:"search_bar__chip_button",onMouseDown:this._onMouseDownOnChipButton},n))},r})(i.PureComponent)}),define("modules/clean/search/search_helpers",["require","exports","tslib","external/sjcl","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/api","modules/clean/react/browse/models","modules/clean/search/types","modules/clean/search/models","modules/core/i18n","modules/core/uri","modules/clean/browse_uri_interface","modules/core/cookies"],function(e,r,t,s,n,o,a,i,c,l,_,u,d,h){"use strict";function p(e){var r=e.user,s=e.searchPath,n=e.normalizedQuery,o=e.searchSessionId,a=e.searchToken,i=e.qargs,c=t.__assign({path:s,query:n,search_session_id:o,search_token:a},i);return new u.URI({path:"/search/"+r.role,query:c})}function E(e,r){return e instanceof l.SlimFileSearchResult?d.browse_uri_for_fq_path(r,e.fq_path).toString():e.url}function S(e){var r=e.searchBarApiClient,t=e.searchResult,s=e.user,c=e.onSuccess,u=e.onError;if(t instanceof l.SlimFileSearchResult){var d=o.searchResultForPath(n.getStoreForSearchBar().getState(),t.fq_path);d?c(d):r.fetchAdditionalFileMetadata({searchResults:[t],user:s}).then(function(e){if(e.length>0)c(e[0]);else if(u){var r=_._("There was a problem completing this request.");u(r)}}).catch(function(e){!u||e instanceof a.RequestAbortedError||u(e.message)})}else(t instanceof i.Paper||t instanceof i.PaperFolder)&&c(t)}function m(e){return 0===e.button&&!e.altKey&&!e.ctrlKey&&!e.metaKey}function f(){var e=s.codec.utf8String.toBits(h.Cookies.read("__Host-js_csrf")),r=s.codec.utf8String.toBits("search"),t=new s.misc.hmac(e);return s.codec.base64.fromBits(t.encrypt(r))}function T(e){return e.expScopeFilterRightRail===c.ScopeFilterRightRailVariants.ON}function R(e){return!!e&&e.expDeletedFilterRightRail===c.DeletedFilterRightRailVariants.ON}function C(e,r){return T(e)||R(r)}function A(e){return e.expSinglePageSearch===c.SinglePageSearchVariants.ON}Object.defineProperty(r,"__esModule",{value:!0}),r.buildSearchURL=p,r.resultObjectToUrl=E,r.fetchFullSearchResult=S,r.shouldHandleClick=m,r.getSearchCsrfToken=f,r.isInScopeFilterRightRailExperiment=T,r.isInDeletedFilterRightRailExperiment=R,r.isInRightRailExperiment=C,r.isInSinglePageSearchExperiment=A}),define("modules/clean/search/store_helpers",["require","exports"],function(e,r){"use strict";function t(e){return e.trim().replace(/\ +/g," ")}function s(e){return!t(e)}function n(e,r){return!(s(e)||!s(r))||e.length>=3&&1===r.length}function o(){for(var e="",r=0;r<32;r++){var t=Math.floor(10*Math.random());e+=String(t)}return e}Object.defineProperty(r,"__esModule",{value:!0}),r.normalize=t,r.isBlank=s,r.shouldStartNewSearchSession=n,r.generateRandomId=o}),define("modules/clean/search/types",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SearchResultTypes={FILE:"FILE",PAPER:"PAPER",PAPER_FOLDER:"PAPER_FOLDER"};(function(e){e.METASERVER="METASERVER",e.FRONTEND_SERVICE="FRONTEND_SERVICE",e.CONTROL="CONTROL",e.OFF="OFF"})(r.FetchPartialResultVariants||(r.FetchPartialResultVariants={}));(function(e){e.RENDER="RENDER",e.CALCULATE_ONLY="CALCULATE_ONLY",e.OFF="OFF",e.CONTROL="CONTROL"})(r.DropdownThumbnailVariants||(r.DropdownThumbnailVariants={}));(function(e){e.OFF="OFF",e.CONTROL="CONTROL",e.V1="V1",e.V2="V2"})(r.DropdownUpsellVariants||(r.DropdownUpsellVariants={}));(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL"})(r.DeletedFilterRightRailVariants||(r.DeletedFilterRightRailVariants={}));(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL",e.HOLDOUT="HOLDOUT"})(r.SinglePageSearchVariants||(r.SinglePageSearchVariants={}));(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL"})(r.ScopeFilterRightRailVariants||(r.ScopeFilterRightRailVariants={}));(function(e){e.SEARCH_ALL="SEARCH_ALL",e.SCOPE_CHIPS="SCOPE_CHIPS",e.DELETED_FILES="DELETED_FILES",e.SEARCH_UPSELL="SEARCH_UPSELL"})(r.SearchBarDropdownHeaderItemType||(r.SearchBarDropdownHeaderItemType={}))}),define("modules/clean/sharing/access_level",["require","exports","external/lodash"],function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e[e.ACCESS_NO_ACCESS=0]="ACCESS_NO_ACCESS",e[e.ACCESS_READER_NO_COMMENT=-10]="ACCESS_READER_NO_COMMENT",e[e.ACCESS_READER=1]="ACCESS_READER",e[e.ACCESS_WRITER=2]="ACCESS_WRITER",e[e.ACCESS_OWNER=3]="ACCESS_OWNER"})(r.NameSpaceAccess||(r.NameSpaceAccess={})),r.ACCESS_LEVEL={OWNER:"owner",WRITER:"writer",READER:"reader",READER_NO_COMMENT:"reader_no_comment"},r.ACCESS_VALUES=t.values(r.ACCESS_LEVEL);var s={reader_no_comment:-10,reader:1,writer:2,owner:3};r.isLowerAccess=function(e,t){var n=Object.keys(s);return e!==t&&n.indexOf(e)!==-1&&n.indexOf(t)!==-1&&r.getMaxAccess([e,t])===e},r.getMaxAccess=function(e){if(0===e.length)throw Error("Argument accessLevels are not valid.");for(var r=e[0],t=s[r],n=0;n<e.length;n++){var o=e[n],a=s[o];a>t&&(t=a,r=o)}return r}}),define("modules/clean/web_user_action_events",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});(function(e){e.ADD_COMMENT="add_comment",e.ARCHIVE="archive",e.ATTACHMENT_ADD_SUCCESS="attachment_add_success",e.ATTACHMENT_CLICKED="attachment_clicked",e.ATTACHMENT_REMOVED="attachment_removed",e.CALENDAR_TAB_CLICKED="calendar_tab_clicked",e.CALENDAR_SUGGESTIONS_REMOVED="calendar_suggestions_removed",e.CLICK_ADD_ATTACHMENT="click_add_attachment",e.CLICK_CONVERT_INDIVIDUAL_ACCOUNT="click_convert_individual_account",e.CLICK_LEARN_MORE_ACCOUNT_CONVERSION="click_learn_more_account_conversion",e.CLICK_PATH_LINK="click_path_link",e.CLICK_REVIEW_SUMMARY_DELETE_USER="click_review_summary_delete_user",e.CONTEXT_MENU="context_menu",e.COPY="copy",e.CREATE_FOLDER="create_folder",e.DISBAND_TEAM_KEEP="disband_team_keep",e.DISBAND_TEAM_LEARN_MORE="disband_team_learn_more",e.DISBAND_TEAM_VIEW="disband_team_view",e.DELETE="delete",e.DOWNLOAD="download",e.EVENTS="events",e.FILE_VIEW="file_view",e.FOLDER_OPEN="folder_open",e.LEAVE_TEAM_CANCEL="leave_team_cancel",e.LEAVE_TEAM_LEARN_MORE="leave_team_learn_more",e.LEAVE_TEAM_VIEW="leave_team_view",e.LINK_GOOGLE_CAL_CLICKED="link_google_cal_clicked",e.LINK_GOOGLE_CAL_SUCCESS="link_google_cal_success",e.MOVE="move",e.MOVE_SUGGESTION_MODAL_FOLDER_CLICK="move_suggestion_modal_folder_click",e.MOVE_SUGGESTION_MODAL_SUGGESTION_CLICK="move_suggestion_modal_suggestion_click",e.OPEN_ADD_TO_COLLECTION_MODAL="open_add_to_collection_modal",e.OPEN_CALENDAR_FLYOUT="open_calendar_flyout",e.OPEN_COPY_MODAL="open_copy_modal",e.OPEN_DELETE_USER_MODAL="open_delete_user_modal",e.OPEN_MOVE_MODAL="open_move_modal",e.OPEN_MOVE_SUGGESTION_MODAL="open_move_suggestion_modal",e.OPEN_ROW="open_row",e.PAPER_CONTEXT_MENU="paper_context_menu",e.PAPER_OPEN="paper_open",e.PERMANENT_DELETE="permanent_delete",e.RENAME="rename",e.RESTORE="restore",e.SELECT_ROW="select_row",e.SHARE="share",e.SHOW_IN_FOLDER="show_in_folder",e.SORT_RECORDS="sort_records",e.STAR="star",e.REMOVE_STAR="remove_star",e.SWITCH_ACCOUNT="switch_account",e.SWITCH_VIEW_TYPE="switch_view_type",e.TOGGLE_DELETED_FILES="toggle_deleted_files",e.UNMOUNTED_VIEW="unmounted_view",e.VERSIONS="versions",e.VIEW_SHARE_MODEL="view_share_model",e.OPEN_DESKTOP="open_via_unity",e.CONF_BY_REMOVE_MEMBER="conf_by_remove_member",e.CONF_BY_DOWNGRADE_MEMBER="conf_by_downgrade_member",e.CONF_BY_MANAGE_ACCESS="conf_by_manage_access",e.CONF_BY_UNDO_AFTER_RESTORE_ACCESS="conf_by_undo_after_restore_access",e.CONF_BY_CREATE_CONFIDENTIAL_FOLDER="conf_by_create_confidential_folder",e.ADD_MORE_FILES_CLICK="add_more_files_click",e.CLOSE_MODAL_CLICK="close_modal_click",e.DISMISS_INLINE_STATUS="dismiss_inline_status",e.UPLOAD_BUTTON_CLICK="upload_button_click",e.VIEW_DETAILS_CLICK="view_details_click",e.UPLOAD_CLICK="upload_click",e.UPLOAD_FILES_CLICK="upload_files_click",e.UPLOAD_FOLDER_CLICK="upload_folder_click"})(r.WebUserActionLogEvent||(r.WebUserActionLogEvent={}));(function(e){e.SHARED_FOLDER="shared folder",e.FILE_FOLDER="file folder",e.EVERYONE_GROUP_VIEW_ACCESS="everyone group view access",e.SPECIFIC_PEOPLE="specific people",e.BROWSE="browse",e.CONTENT_MANAGER="content manager"})(r.WebUserActionLogExtraValue||(r.WebUserActionLogExtraValue={}))}),define("modules/clean/web_user_action_logger",["require","exports","modules/clean/ajax"],function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_ERRORS=3;var s=(function(){function e(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}return e.prototype.log=function(e,s,n){var o=this;return this.shouldReport&&(this.errorCount<r.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise(function(a,i){t.SilentBackgroundRequest({url:"/log/web_user_action",data:{_subject_uid:e,event_type:s,extra_params:JSON.stringify(n)},error:function(e){429===e.status?o.errorCount=r.MAX_ERRORS:o.errorCount++,o.lastError=Date.now(),i(e)},success:function(e){try{var r=JSON.parse(e);r&&!r.continue_sending&&(o.shouldReport=!1),o.errorCount=0,a(e)}catch(e){throw o.errorCount++,o.lastError=Date.now(),i(e),e}}})}):Promise.resolve({})},e})();r.WebUserActionLogClass=s,r.WebUserActionLog=new s});
//# sourceMappingURL=pkg-embedded_app.min.js-vflOl2cnP.map