define(["require","exports","tslib","external/react","modules/clean/react/css","spectrum_comments/comment_stream","modules/clean/react/comments2/helper","modules/clean/react/comments2/store/selectors","modules/clean/react/file_sidebar/file_sidebar_connect","modules/clean/react/comments2/store/actions","modules/clean/react/file_viewer/coach_mark","modules/clean/react/file_viewer/more_dropdown/more_option_registry","modules/clean/react/file_action_button","modules/clean/react/file_viewer/more_dropdown/models","modules/clean/previews/constants","modules/clean/video_annotations_prototype/video_annotation_prototype_helper","spectrum_comments/comment/video_comment","spectrum_comments/comment_editor/comment_editor","spectrum_comments/comment_editor/video_comment_editor","modules/clean/video_annotations_prototype/constants","modules/clean/video_annotations_prototype/video_preview_event_emitter","modules/core/i18n"],function(e,t,o,n,r,i,a,m,s,c,d,p,l,u,_,h,v,C,f,T,y,g){"use strict";function w(e){return{mentions:m.getMentionsData(e),playerCurrentTime:m.getPlayerCurrentTime(e),onboardingResult:m.getOnboardingResult(e),showResolved:m.getShowResolved(e),threads:m.getThreads(e)}}Object.defineProperty(t,"__esModule",{value:!0});var b=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.toggleShowResolved=function(){(0,t.props.dispatch)(c.toggleShowResolved())},t.createCoachmark=function(){return n.createElement(d.CoachMark,{title:g._("Target your feedback"),arrowPosition:"top",showClose:!0,onCloseButtonClick:t.onCoachmarkClose},g._("Adding time codes to comments keeps feedback simple, organized, and all in one place"))},t.onCoachmarkClose=function(){var e=t.props,o=e.dispatch,n=e.viewer;o(c.markHasOnboarded(n.id,{".tag":"initial_video_land"}))},t}return o.__extends(t,e),t.prototype.updateCommentsMoreOptionGroup=function(){var e=this.props.showResolved?l.FileActionButtonType.HIDE_RESOLVED_COMMENTS:l.FileActionButtonType.SHOW_RESOLVED_COMMENTS,t=new u.MoreOptionGroup({fileActionButtonGroup:l.FileActionButtonGroup.COMMENTS,options:[new u.MoreOption({className:"comments-options-item__show-resolved",fileActionButtonType:e,component:function(e){return n.createElement("span",null,e.buttonText)},handler:this.toggleShowResolved})]});void 0===this.moreOptionGroup?p.moreOptionRegistry.addOption(t):p.moreOptionRegistry.replaceOption(this.moreOptionGroup,t),this.moreOptionGroup=t},t.prototype.componentWillMount=function(){var e=this.props,t=e.viewer,o=e.dispatch;t&&o&&o(c.initializeMentionsContacts(t))},t.prototype.componentDidMount=function(){this.updateCommentsMoreOptionGroup()},t.prototype.componentDidUpdate=function(){this.updateCommentsMoreOptionGroup()},Object.defineProperty(t.prototype,"actionsAdapter",{get:function(){var e=this.props,t=e.dispatch,n=e.mentions,r=e.stream,i=e.viewer;return{onThreadActivated:function(e){if(t(c.activateThread(e)),e.annotation){var o=h.VideoAnnotationPrototypeHelper.unitConvertDomainObjectTimeToSeconds(e.annotation.time);y.videoPreviewEventEmitter.emit(T.EventTypes.SEEK_POSITION_AND_PAUSE,o)}},onThreadCreated:function(e,n){var m=a.Comments2Helper.commentContentToUserSubmittedComment(e);n&&(m.annotation_data=o.__assign({".tag":"video"},n)),t(c.addComment(i,r,m))},onThreadRepliedTo:function(e,o){var n=a.Comments2Helper.commentContentToUserSubmittedComment(o);t(c.addComment(i,r,n,e))},onThreadMarkedAsRead:function(e){t(c.markThreadRead(i,r,e))},onThreadMarkedAsUnread:function(e){t(c.markThreadUnread(i,r,e))},onThreadResolved:function(e){t(c.markThreadResolved(i,r,e))},onThreadUnresolved:function(e){t(c.markThreadUnresolved(i,r,e))},onCommentEdited:function(e,o){var n=a.Comments2Helper.commentContentToUserSubmittedComment(o);t(c.editComment(i,r,e,n))},onCommentDeleted:function(e){t(c.deleteComment(i,r,e))},onMentionsQueryUpdated:function(e){var o=function(o){t(c.mentionsMatchesUpdate(e,o))};n.contactsManager.search(e,o,o)}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commentComponent",{get:function(){return this.props.previewType===_.PreviewType.Video?v.VideoComment:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editorComponent",{get:function(){var e=this,t=this.props,r=t.playerCurrentTime,i=t.previewType,a=t.onboardingResult;if(i===_.PreviewType.Video&&void 0!==r){var m=!!a&&!a.initial_video_land;return function(t){return n.createElement(f.VideoCommentEditor,o.__assign({},t,{currentTime:r,showCoachmark:m,createCoachmark:e.createCoachmark,coachmarkContainerClassName:"c-coach-mark__container"}))}}return function(e){return n.createElement(C.CommentEditor,o.__assign({},e))}},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.showResolved,o=e.stream,r=e.viewer,a=e.mentions,m=this.props.threads.filter(function(e){return t||!e.resolved});return n.createElement("div",null,n.createElement(i.CommentStream,{id:o.id,actionsAdapter:this.actionsAdapter,commentComponent:this.commentComponent,editorComponent:this.editorComponent,enabled:!0,mentionsMatches:a.matches,settings:{canAnnotate:!0,canComment:!0,canRead:!0},userPermissions:{canAnnotate:!0,canComment:!0,canRead:!0},threads:m,user:{id:r.account_id,email:r.email,name:{display:r.display_name,initials:r.fname[0]+r.lname[0]}}}))},t})(n.Component);t.UnconnectedCommentsPane=b;var O=r(s.fileSidebarConnect(w)(b),["/static/js/spectrum_comments/index.web-vfl5m3I1m.css"]);t.CommentsPane=O});
//# sourceMappingURL=comments_pane.min.js-vflsHUuA5.map